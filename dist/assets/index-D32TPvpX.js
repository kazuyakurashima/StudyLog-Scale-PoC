(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();var Ot=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ky(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var s=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(s,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}),s}var $m={exports:{}},Pl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy=Symbol.for("react.transitional.element"),My=Symbol.for("react.fragment");function Um(t,e,s){var n=null;if(s!==void 0&&(n=""+s),e.key!==void 0&&(n=""+e.key),"key"in e){s={};for(var a in e)a!=="key"&&(s[a]=e[a])}else s=e;return e=s.ref,{$$typeof:Dy,type:t,key:n,ref:e!==void 0?e:null,props:s}}Pl.Fragment=My;Pl.jsx=Um;Pl.jsxs=Um;$m.exports=Pl;var o=$m.exports,qm={exports:{}},J={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bu=Symbol.for("react.transitional.element"),$y=Symbol.for("react.portal"),Uy=Symbol.for("react.fragment"),qy=Symbol.for("react.strict_mode"),zy=Symbol.for("react.profiler"),Ly=Symbol.for("react.consumer"),By=Symbol.for("react.context"),Hy=Symbol.for("react.forward_ref"),Gy=Symbol.for("react.suspense"),Py=Symbol.for("react.memo"),zm=Symbol.for("react.lazy"),pf=Symbol.iterator;function Xy(t){return t===null||typeof t!="object"?null:(t=pf&&t[pf]||t["@@iterator"],typeof t=="function"?t:null)}var Lm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bm=Object.assign,Hm={};function Sa(t,e,s){this.props=t,this.context=e,this.refs=Hm,this.updater=s||Lm}Sa.prototype.isReactComponent={};Sa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Sa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Gm(){}Gm.prototype=Sa.prototype;function Hu(t,e,s){this.props=t,this.context=e,this.refs=Hm,this.updater=s||Lm}var Gu=Hu.prototype=new Gm;Gu.constructor=Hu;Bm(Gu,Sa.prototype);Gu.isPureReactComponent=!0;var bf=Array.isArray,me={H:null,A:null,T:null,S:null,V:null},Pm=Object.prototype.hasOwnProperty;function Pu(t,e,s,n,a,r){return s=r.ref,{$$typeof:Bu,type:t,key:e,ref:s!==void 0?s:null,props:r}}function Yy(t,e){return Pu(t.type,e,void 0,void 0,void 0,t.props)}function Xu(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bu}function Iy(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return e[s]})}var yf=/\/+/g;function No(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Iy(""+t.key):e.toString(36)}function vf(){}function Vy(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(vf,vf):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function $n(t,e,s,n,a){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"bigint":case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Bu:case $y:i=!0;break;case zm:return i=t._init,$n(i(t._payload),e,s,n,a)}}if(i)return a=a(t),i=n===""?"."+No(t,0):n,bf(a)?(s="",i!=null&&(s=i.replace(yf,"$&/")+"/"),$n(a,e,s,"",function(u){return u})):a!=null&&(Xu(a)&&(a=Yy(a,s+(a.key==null||t&&t.key===a.key?"":(""+a.key).replace(yf,"$&/")+"/")+i)),e.push(a)),1;i=0;var l=n===""?".":n+":";if(bf(t))for(var c=0;c<t.length;c++)n=t[c],r=l+No(n,c),i+=$n(n,e,s,r,a);else if(c=Xy(t),typeof c=="function")for(t=c.call(t),c=0;!(n=t.next()).done;)n=n.value,r=l+No(n,c++),i+=$n(n,e,s,r,a);else if(r==="object"){if(typeof t.then=="function")return $n(Vy(t),e,s,n,a);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return i}function ui(t,e,s){if(t==null)return t;var n=[],a=0;return $n(t,n,"","",function(r){return e.call(s,r,a++)}),n}function Qy(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var _f=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function Jy(){}J.Children={map:ui,forEach:function(t,e,s){ui(t,function(){e.apply(this,arguments)},s)},count:function(t){var e=0;return ui(t,function(){e++}),e},toArray:function(t){return ui(t,function(e){return e})||[]},only:function(t){if(!Xu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};J.Component=Sa;J.Fragment=Uy;J.Profiler=zy;J.PureComponent=Hu;J.StrictMode=qy;J.Suspense=Gy;J.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=me;J.__COMPILER_RUNTIME={__proto__:null,c:function(t){return me.H.useMemoCache(t)}};J.cache=function(t){return function(){return t.apply(null,arguments)}};J.cloneElement=function(t,e,s){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var n=Bm({},t.props),a=t.key,r=void 0;if(e!=null)for(i in e.ref!==void 0&&(r=void 0),e.key!==void 0&&(a=""+e.key),e)!Pm.call(e,i)||i==="key"||i==="__self"||i==="__source"||i==="ref"&&e.ref===void 0||(n[i]=e[i]);var i=arguments.length-2;if(i===1)n.children=s;else if(1<i){for(var l=Array(i),c=0;c<i;c++)l[c]=arguments[c+2];n.children=l}return Pu(t.type,a,void 0,void 0,r,n)};J.createContext=function(t){return t={$$typeof:By,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:Ly,_context:t},t};J.createElement=function(t,e,s){var n,a={},r=null;if(e!=null)for(n in e.key!==void 0&&(r=""+e.key),e)Pm.call(e,n)&&n!=="key"&&n!=="__self"&&n!=="__source"&&(a[n]=e[n]);var i=arguments.length-2;if(i===1)a.children=s;else if(1<i){for(var l=Array(i),c=0;c<i;c++)l[c]=arguments[c+2];a.children=l}if(t&&t.defaultProps)for(n in i=t.defaultProps,i)a[n]===void 0&&(a[n]=i[n]);return Pu(t,r,void 0,void 0,null,a)};J.createRef=function(){return{current:null}};J.forwardRef=function(t){return{$$typeof:Hy,render:t}};J.isValidElement=Xu;J.lazy=function(t){return{$$typeof:zm,_payload:{_status:-1,_result:t},_init:Qy}};J.memo=function(t,e){return{$$typeof:Py,type:t,compare:e===void 0?null:e}};J.startTransition=function(t){var e=me.T,s={};me.T=s;try{var n=t(),a=me.S;a!==null&&a(s,n),typeof n=="object"&&n!==null&&typeof n.then=="function"&&n.then(Jy,_f)}catch(r){_f(r)}finally{me.T=e}};J.unstable_useCacheRefresh=function(){return me.H.useCacheRefresh()};J.use=function(t){return me.H.use(t)};J.useActionState=function(t,e,s){return me.H.useActionState(t,e,s)};J.useCallback=function(t,e){return me.H.useCallback(t,e)};J.useContext=function(t){return me.H.useContext(t)};J.useDebugValue=function(){};J.useDeferredValue=function(t,e){return me.H.useDeferredValue(t,e)};J.useEffect=function(t,e,s){var n=me.H;if(typeof s=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return n.useEffect(t,e)};J.useId=function(){return me.H.useId()};J.useImperativeHandle=function(t,e,s){return me.H.useImperativeHandle(t,e,s)};J.useInsertionEffect=function(t,e){return me.H.useInsertionEffect(t,e)};J.useLayoutEffect=function(t,e){return me.H.useLayoutEffect(t,e)};J.useMemo=function(t,e){return me.H.useMemo(t,e)};J.useOptimistic=function(t,e){return me.H.useOptimistic(t,e)};J.useReducer=function(t,e,s){return me.H.useReducer(t,e,s)};J.useRef=function(t){return me.H.useRef(t)};J.useState=function(t){return me.H.useState(t)};J.useSyncExternalStore=function(t,e,s){return me.H.useSyncExternalStore(t,e,s)};J.useTransition=function(){return me.H.useTransition()};J.version="19.1.1";qm.exports=J;var U=qm.exports;const Ky=Mm(U);var Xm={exports:{}},Xl={},Ym={exports:{}},Im={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(_,$){var B=_.length;_.push($);e:for(;0<B;){var L=B-1>>>1,D=_[L];if(0<a(D,$))_[L]=$,_[B]=D,B=L;else break e}}function s(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var $=_[0],B=_.pop();if(B!==$){_[0]=B;e:for(var L=0,D=_.length,X=D>>>1;L<X;){var de=2*(L+1)-1,it=_[de],vt=de+1,_t=_[vt];if(0>a(it,B))vt<D&&0>a(_t,it)?(_[L]=_t,_[vt]=B,L=vt):(_[L]=it,_[de]=B,L=de);else if(vt<D&&0>a(_t,B))_[L]=_t,_[vt]=B,L=vt;else break e}}return $}function a(_,$){var B=_.sortIndex-$.sortIndex;return B!==0?B:_.id-$.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,x=!1,w=!1,N=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;function b(_){for(var $=s(u);$!==null;){if($.callback===null)n(u);else if($.startTime<=_)n(u),$.sortIndex=$.expirationTime,e(c,$);else break;$=s(u)}}function A(_){if(w=!1,b(_),!x)if(s(c)!==null)x=!0,O||(O=!0,M());else{var $=s(u);$!==null&&G(A,$.startTime-_)}}var O=!1,T=-1,v=5,C=-1;function j(){return N?!0:!(t.unstable_now()-C<v)}function R(){if(N=!1,O){var _=t.unstable_now();C=_;var $=!0;try{e:{x=!1,w&&(w=!1,g(T),T=-1),m=!0;var B=h;try{t:{for(b(_),f=s(c);f!==null&&!(f.expirationTime>_&&j());){var L=f.callback;if(typeof L=="function"){f.callback=null,h=f.priorityLevel;var D=L(f.expirationTime<=_);if(_=t.unstable_now(),typeof D=="function"){f.callback=D,b(_),$=!0;break t}f===s(c)&&n(c),b(_)}else n(c);f=s(c)}if(f!==null)$=!0;else{var X=s(u);X!==null&&G(A,X.startTime-_),$=!1}}break e}finally{f=null,h=B,m=!1}$=void 0}}finally{$?M():O=!1}}}var M;if(typeof p=="function")M=function(){p(R)};else if(typeof MessageChannel<"u"){var S=new MessageChannel,q=S.port2;S.port1.onmessage=R,M=function(){q.postMessage(null)}}else M=function(){y(R,0)};function G(_,$){T=y(function(){_(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(_){_.callback=null},t.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<_?Math.floor(1e3/_):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(_){switch(h){case 1:case 2:case 3:var $=3;break;default:$=h}var B=h;h=$;try{return _()}finally{h=B}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(_,$){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var B=h;h=_;try{return $()}finally{h=B}},t.unstable_scheduleCallback=function(_,$,B){var L=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?L+B:L):B=L,_){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=B+D,_={id:d++,callback:$,priorityLevel:_,startTime:B,expirationTime:D,sortIndex:-1},B>L?(_.sortIndex=B,e(u,_),s(c)===null&&_===s(u)&&(w?(g(T),T=-1):w=!0,G(A,B-L))):(_.sortIndex=D,e(c,_),x||m||(x=!0,O||(O=!0,M()))),_},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(_){var $=h;return function(){var B=h;h=$;try{return _.apply(this,arguments)}finally{h=B}}}})(Im);Ym.exports=Im;var Zy=Ym.exports,Vm={exports:{}},Ze={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fy=U;function Qm(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function bs(){}var Ke={d:{f:bs,r:function(){throw Error(Qm(522))},D:bs,C:bs,L:bs,m:bs,X:bs,S:bs,M:bs},p:0,findDOMNode:null},Wy=Symbol.for("react.portal");function ev(t,e,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wy,key:n==null?null:""+n,children:t,containerInfo:e,implementation:s}}var rr=Fy.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Yl(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}Ze.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ke;Ze.createPortal=function(t,e){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(Qm(299));return ev(t,e,null,s)};Ze.flushSync=function(t){var e=rr.T,s=Ke.p;try{if(rr.T=null,Ke.p=2,t)return t()}finally{rr.T=e,Ke.p=s,Ke.d.f()}};Ze.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Ke.d.C(t,e))};Ze.prefetchDNS=function(t){typeof t=="string"&&Ke.d.D(t)};Ze.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var s=e.as,n=Yl(s,e.crossOrigin),a=typeof e.integrity=="string"?e.integrity:void 0,r=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;s==="style"?Ke.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:n,integrity:a,fetchPriority:r}):s==="script"&&Ke.d.X(t,{crossOrigin:n,integrity:a,fetchPriority:r,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};Ze.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var s=Yl(e.as,e.crossOrigin);Ke.d.M(t,{crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Ke.d.M(t)};Ze.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var s=e.as,n=Yl(s,e.crossOrigin);Ke.d.L(t,s,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};Ze.preloadModule=function(t,e){if(typeof t=="string")if(e){var s=Yl(e.as,e.crossOrigin);Ke.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:s,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Ke.d.m(t)};Ze.requestFormReset=function(t){Ke.d.r(t)};Ze.unstable_batchedUpdates=function(t,e){return t(e)};Ze.useFormState=function(t,e,s){return rr.H.useFormState(t,e,s)};Ze.useFormStatus=function(){return rr.H.useHostTransitionStatus()};Ze.version="19.1.1";function Jm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jm)}catch(t){console.error(t)}}Jm(),Vm.exports=Ze;var tv=Vm.exports;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ce=Zy,Km=U,sv=tv;function k(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)e+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Zm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hr(t){var e=t,s=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(s=e.return),t=e.return;while(t)}return e.tag===3?s:null}function Fm(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xf(t){if(Hr(t)!==t)throw Error(k(188))}function nv(t){var e=t.alternate;if(!e){if(e=Hr(t),e===null)throw Error(k(188));return e!==t?null:t}for(var s=t,n=e;;){var a=s.return;if(a===null)break;var r=a.alternate;if(r===null){if(n=a.return,n!==null){s=n;continue}break}if(a.child===r.child){for(r=a.child;r;){if(r===s)return xf(a),t;if(r===n)return xf(a),e;r=r.sibling}throw Error(k(188))}if(s.return!==n.return)s=a,n=r;else{for(var i=!1,l=a.child;l;){if(l===s){i=!0,s=a,n=r;break}if(l===n){i=!0,n=a,s=r;break}l=l.sibling}if(!i){for(l=r.child;l;){if(l===s){i=!0,s=r,n=a;break}if(l===n){i=!0,n=r,s=a;break}l=l.sibling}if(!i)throw Error(k(189))}}if(s.alternate!==n)throw Error(k(190))}if(s.tag!==3)throw Error(k(188));return s.stateNode.current===s?t:e}function Wm(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=Wm(t),e!==null)return e;t=t.sibling}return null}var fe=Object.assign,av=Symbol.for("react.element"),di=Symbol.for("react.transitional.element"),Ya=Symbol.for("react.portal"),Xn=Symbol.for("react.fragment"),eg=Symbol.for("react.strict_mode"),wc=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),tg=Symbol.for("react.consumer"),as=Symbol.for("react.context"),Yu=Symbol.for("react.forward_ref"),Sc=Symbol.for("react.suspense"),jc=Symbol.for("react.suspense_list"),Iu=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),Nc=Symbol.for("react.activity"),iv=Symbol.for("react.memo_cache_sentinel"),wf=Symbol.iterator;function $a(t){return t===null||typeof t!="object"?null:(t=wf&&t[wf]||t["@@iterator"],typeof t=="function"?t:null)}var lv=Symbol.for("react.client.reference");function Ec(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===lv?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xn:return"Fragment";case wc:return"Profiler";case eg:return"StrictMode";case Sc:return"Suspense";case jc:return"SuspenseList";case Nc:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case Ya:return"Portal";case as:return(t.displayName||"Context")+".Provider";case tg:return(t._context.displayName||"Context")+".Consumer";case Yu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Iu:return e=t.displayName||null,e!==null?e:Ec(t.type)||"Memo";case js:e=t._payload,t=t._init;try{return Ec(t(e))}catch{}}return null}var Ia=Array.isArray,I=Km.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=sv.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,on={pending:!1,data:null,method:null,action:null},Ac=[],Yn=-1;function Vt(t){return{current:t}}function qe(t){0>Yn||(t.current=Ac[Yn],Ac[Yn]=null,Yn--)}function ge(t,e){Yn++,Ac[Yn]=t.current,t.current=e}var Xt=Vt(null),Nr=Vt(null),$s=Vt(null),nl=Vt(null);function al(t,e){switch(ge($s,e),ge(Nr,t),ge(Xt,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?Ah(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=Ah(e),t=yp(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}qe(Xt),ge(Xt,t)}function da(){qe(Xt),qe(Nr),qe($s)}function Tc(t){t.memoizedState!==null&&ge(nl,t);var e=Xt.current,s=yp(e,t.type);e!==s&&(ge(Nr,t),ge(Xt,s))}function rl(t){Nr.current===t&&(qe(Xt),qe(Nr)),nl.current===t&&(qe(nl),$r._currentValue=on)}var Oc=Object.prototype.hasOwnProperty,Vu=Ce.unstable_scheduleCallback,Eo=Ce.unstable_cancelCallback,ov=Ce.unstable_shouldYield,cv=Ce.unstable_requestPaint,Yt=Ce.unstable_now,uv=Ce.unstable_getCurrentPriorityLevel,sg=Ce.unstable_ImmediatePriority,ng=Ce.unstable_UserBlockingPriority,il=Ce.unstable_NormalPriority,dv=Ce.unstable_LowPriority,ag=Ce.unstable_IdlePriority,fv=Ce.log,hv=Ce.unstable_setDisableYieldValue,Gr=null,mt=null;function Cs(t){if(typeof fv=="function"&&hv(t),mt&&typeof mt.setStrictMode=="function")try{mt.setStrictMode(Gr,t)}catch{}}var gt=Math.clz32?Math.clz32:pv,mv=Math.log,gv=Math.LN2;function pv(t){return t>>>=0,t===0?32:31-(mv(t)/gv|0)|0}var fi=256,hi=4194304;function Fs(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Il(t,e,s){var n=t.pendingLanes;if(n===0)return 0;var a=0,r=t.suspendedLanes,i=t.pingedLanes;t=t.warmLanes;var l=n&134217727;return l!==0?(n=l&~r,n!==0?a=Fs(n):(i&=l,i!==0?a=Fs(i):s||(s=l&~t,s!==0&&(a=Fs(s))))):(l=n&~r,l!==0?a=Fs(l):i!==0?a=Fs(i):s||(s=n&~t,s!==0&&(a=Fs(s)))),a===0?0:e!==0&&e!==a&&!(e&r)&&(r=a&-a,s=e&-e,r>=s||r===32&&(s&4194048)!==0)?e:a}function Pr(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function bv(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rg(){var t=fi;return fi<<=1,!(fi&4194048)&&(fi=256),t}function ig(){var t=hi;return hi<<=1,!(hi&62914560)&&(hi=4194304),t}function Ao(t){for(var e=[],s=0;31>s;s++)e.push(t);return e}function Xr(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function yv(t,e,s,n,a,r){var i=t.pendingLanes;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=s,t.entangledLanes&=s,t.errorRecoveryDisabledLanes&=s,t.shellSuspendCounter=0;var l=t.entanglements,c=t.expirationTimes,u=t.hiddenUpdates;for(s=i&~s;0<s;){var d=31-gt(s),f=1<<d;l[d]=0,c[d]=-1;var h=u[d];if(h!==null)for(u[d]=null,d=0;d<h.length;d++){var m=h[d];m!==null&&(m.lane&=-536870913)}s&=~f}n!==0&&lg(t,n,0),r!==0&&a===0&&t.tag!==0&&(t.suspendedLanes|=r&~(i&~e))}function lg(t,e,s){t.pendingLanes|=e,t.suspendedLanes&=~e;var n=31-gt(e);t.entangledLanes|=e,t.entanglements[n]=t.entanglements[n]|1073741824|s&4194090}function og(t,e){var s=t.entangledLanes|=e;for(t=t.entanglements;s;){var n=31-gt(s),a=1<<n;a&e|t[n]&e&&(t[n]|=e),s&=~a}}function Qu(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Ju(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function cg(){var t=ne.p;return t!==0?t:(t=window.event,t===void 0?32:Tp(t.type))}function vv(t,e){var s=ne.p;try{return ne.p=t,e()}finally{ne.p=s}}var Is=Math.random().toString(36).slice(2),Ie="__reactFiber$"+Is,at="__reactProps$"+Is,ja="__reactContainer$"+Is,Rc="__reactEvents$"+Is,_v="__reactListeners$"+Is,xv="__reactHandles$"+Is,Sf="__reactResources$"+Is,Yr="__reactMarker$"+Is;function Ku(t){delete t[Ie],delete t[at],delete t[Rc],delete t[_v],delete t[xv]}function In(t){var e=t[Ie];if(e)return e;for(var s=t.parentNode;s;){if(e=s[ja]||s[Ie]){if(s=e.alternate,e.child!==null||s!==null&&s.child!==null)for(t=Rh(t);t!==null;){if(s=t[Ie])return s;t=Rh(t)}return e}t=s,s=t.parentNode}return null}function Na(t){if(t=t[Ie]||t[ja]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function Va(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(k(33))}function na(t){var e=t[Sf];return e||(e=t[Sf]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function $e(t){t[Yr]=!0}var ug=new Set,dg={};function _n(t,e){fa(t,e),fa(t+"Capture",e)}function fa(t,e){for(dg[t]=e,t=0;t<e.length;t++)ug.add(e[t])}var wv=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jf={},Nf={};function Sv(t){return Oc.call(Nf,t)?!0:Oc.call(jf,t)?!1:wv.test(t)?Nf[t]=!0:(jf[t]=!0,!1)}function $i(t,e,s){if(Sv(e))if(s===null)t.removeAttribute(e);else{switch(typeof s){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var n=e.toLowerCase().slice(0,5);if(n!=="data-"&&n!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+s)}}function mi(t,e,s){if(s===null)t.removeAttribute(e);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+s)}}function Jt(t,e,s,n){if(n===null)t.removeAttribute(s);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttributeNS(e,s,""+n)}}var To,Ef;function Un(t){if(To===void 0)try{throw Error()}catch(s){var e=s.stack.trim().match(/\n( *(at )?)/);To=e&&e[1]||"",Ef=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+To+t+Ef}var Oo=!1;function Ro(t,e){if(!t||Oo)return"";Oo=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(e){var f=function(){throw Error()};if(Object.defineProperty(f.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(f,[])}catch(m){var h=m}Reflect.construct(t,[],f)}else{try{f.call()}catch(m){h=m}t.call(f.prototype)}}else{try{throw Error()}catch(m){h=m}(f=t())&&typeof f.catch=="function"&&f.catch(function(){})}}catch(m){if(m&&h&&typeof m.stack=="string")return[m.stack,h.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=n.DetermineComponentFrameRoot(),i=r[0],l=r[1];if(i&&l){var c=i.split(`
`),u=l.split(`
`);for(a=n=0;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;for(;a<u.length&&!u[a].includes("DetermineComponentFrameRoot");)a++;if(n===c.length||a===u.length)for(n=c.length-1,a=u.length-1;1<=n&&0<=a&&c[n]!==u[a];)a--;for(;1<=n&&0<=a;n--,a--)if(c[n]!==u[a]){if(n!==1||a!==1)do if(n--,a--,0>a||c[n]!==u[a]){var d=`
`+c[n].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=n&&0<=a);break}}}finally{Oo=!1,Error.prepareStackTrace=s}return(s=t?t.displayName||t.name:"")?Un(s):""}function jv(t){switch(t.tag){case 26:case 27:case 5:return Un(t.type);case 16:return Un("Lazy");case 13:return Un("Suspense");case 19:return Un("SuspenseList");case 0:case 15:return Ro(t.type,!1);case 11:return Ro(t.type.render,!1);case 1:return Ro(t.type,!0);case 31:return Un("Activity");default:return""}}function Af(t){try{var e="";do e+=jv(t),t=t.return;while(t);return e}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}function wt(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fg(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Nv(t){var e=fg(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,r=s.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,r.call(this,i)}}),Object.defineProperty(t,e,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ll(t){t._valueTracker||(t._valueTracker=Nv(t))}function hg(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var s=e.getValue(),n="";return t&&(n=fg(t)?t.checked?"true":"false":t.value),t=n,t!==s?(e.setValue(t),!0):!1}function ol(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ev=/[\n"\\]/g;function Nt(t){return t.replace(Ev,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Cc(t,e,s,n,a,r,i,l){t.name="",i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"?t.type=i:t.removeAttribute("type"),e!=null?i==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+wt(e)):t.value!==""+wt(e)&&(t.value=""+wt(e)):i!=="submit"&&i!=="reset"||t.removeAttribute("value"),e!=null?kc(t,i,wt(e)):s!=null?kc(t,i,wt(s)):n!=null&&t.removeAttribute("value"),a==null&&r!=null&&(t.defaultChecked=!!r),a!=null&&(t.checked=a&&typeof a!="function"&&typeof a!="symbol"),l!=null&&typeof l!="function"&&typeof l!="symbol"&&typeof l!="boolean"?t.name=""+wt(l):t.removeAttribute("name")}function mg(t,e,s,n,a,r,i,l){if(r!=null&&typeof r!="function"&&typeof r!="symbol"&&typeof r!="boolean"&&(t.type=r),e!=null||s!=null){if(!(r!=="submit"&&r!=="reset"||e!=null))return;s=s!=null?""+wt(s):"",e=e!=null?""+wt(e):s,l||e===t.value||(t.value=e),t.defaultValue=e}n=n??a,n=typeof n!="function"&&typeof n!="symbol"&&!!n,t.checked=l?t.checked:!!n,t.defaultChecked=!!n,i!=null&&typeof i!="function"&&typeof i!="symbol"&&typeof i!="boolean"&&(t.name=i)}function kc(t,e,s){e==="number"&&ol(t.ownerDocument)===t||t.defaultValue===""+s||(t.defaultValue=""+s)}function aa(t,e,s,n){if(t=t.options,e){e={};for(var a=0;a<s.length;a++)e["$"+s[a]]=!0;for(s=0;s<t.length;s++)a=e.hasOwnProperty("$"+t[s].value),t[s].selected!==a&&(t[s].selected=a),a&&n&&(t[s].defaultSelected=!0)}else{for(s=""+wt(s),e=null,a=0;a<t.length;a++){if(t[a].value===s){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function gg(t,e,s){if(e!=null&&(e=""+wt(e),e!==t.value&&(t.value=e),s==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=s!=null?""+wt(s):""}function pg(t,e,s,n){if(e==null){if(n!=null){if(s!=null)throw Error(k(92));if(Ia(n)){if(1<n.length)throw Error(k(93));n=n[0]}s=n}s==null&&(s=""),e=s}s=wt(e),t.defaultValue=s,n=t.textContent,n===s&&n!==""&&n!==null&&(t.value=n)}function ha(t,e){if(e){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=e;return}}t.textContent=e}var Av=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tf(t,e,s){var n=e.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?n?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":n?t.setProperty(e,s):typeof s!="number"||s===0||Av.has(e)?e==="float"?t.cssFloat=s:t[e]=(""+s).trim():t[e]=s+"px"}function bg(t,e,s){if(e!=null&&typeof e!="object")throw Error(k(62));if(t=t.style,s!=null){for(var n in s)!s.hasOwnProperty(n)||e!=null&&e.hasOwnProperty(n)||(n.indexOf("--")===0?t.setProperty(n,""):n==="float"?t.cssFloat="":t[n]="");for(var a in e)n=e[a],e.hasOwnProperty(a)&&s[a]!==n&&Tf(t,a,n)}else for(var r in e)e.hasOwnProperty(r)&&Tf(t,r,e[r])}function Zu(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ov=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ui(t){return Ov.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Dc=null;function Fu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vn=null,ra=null;function Of(t){var e=Na(t);if(e&&(t=e.stateNode)){var s=t[at]||null;e:switch(t=e.stateNode,e.type){case"input":if(Cc(t,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),e=s.name,s.type==="radio"&&e!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+Nt(""+e)+'"][type="radio"]'),e=0;e<s.length;e++){var n=s[e];if(n!==t&&n.form===t.form){var a=n[at]||null;if(!a)throw Error(k(90));Cc(n,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(e=0;e<s.length;e++)n=s[e],n.form===t.form&&hg(n)}break e;case"textarea":gg(t,s.value,s.defaultValue);break e;case"select":e=s.value,e!=null&&aa(t,!!s.multiple,e,!1)}}}var Co=!1;function yg(t,e,s){if(Co)return t(e,s);Co=!0;try{var n=t(e);return n}finally{if(Co=!1,(Vn!==null||ra!==null)&&(so(),Vn&&(e=Vn,t=ra,ra=Vn=null,Of(e),t)))for(e=0;e<t.length;e++)Of(t[e])}}function Er(t,e){var s=t.stateNode;if(s===null)return null;var n=s[at]||null;if(n===null)return null;s=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(k(231,e,typeof s));return s}var ds=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mc=!1;if(ds)try{var Ua={};Object.defineProperty(Ua,"passive",{get:function(){Mc=!0}}),window.addEventListener("test",Ua,Ua),window.removeEventListener("test",Ua,Ua)}catch{Mc=!1}var ks=null,Wu=null,qi=null;function vg(){if(qi)return qi;var t,e=Wu,s=e.length,n,a="value"in ks?ks.value:ks.textContent,r=a.length;for(t=0;t<s&&e[t]===a[t];t++);var i=s-t;for(n=1;n<=i&&e[s-n]===a[r-n];n++);return qi=a.slice(t,1<n?1-n:void 0)}function zi(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function gi(){return!0}function Rf(){return!1}function rt(t){function e(s,n,a,r,i){this._reactName=s,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(s=t[l],this[l]=s?s(r):r[l]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?gi:Rf,this.isPropagationStopped=Rf,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=gi)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=gi)},persist:function(){},isPersistent:gi}),e}var xn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vl=rt(xn),Ir=fe({},xn,{view:0,detail:0}),Rv=rt(Ir),ko,Do,qa,Ql=fe({},Ir,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ed,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==qa&&(qa&&t.type==="mousemove"?(ko=t.screenX-qa.screenX,Do=t.screenY-qa.screenY):Do=ko=0,qa=t),ko)},movementY:function(t){return"movementY"in t?t.movementY:Do}}),Cf=rt(Ql),Cv=fe({},Ql,{dataTransfer:0}),kv=rt(Cv),Dv=fe({},Ir,{relatedTarget:0}),Mo=rt(Dv),Mv=fe({},xn,{animationName:0,elapsedTime:0,pseudoElement:0}),$v=rt(Mv),Uv=fe({},xn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qv=rt(Uv),zv=fe({},xn,{data:0}),kf=rt(zv),Lv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Hv[t])?!!e[t]:!1}function ed(){return Gv}var Pv=fe({},Ir,{key:function(t){if(t.key){var e=Lv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Bv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ed,charCode:function(t){return t.type==="keypress"?zi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Xv=rt(Pv),Yv=fe({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Df=rt(Yv),Iv=fe({},Ir,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ed}),Vv=rt(Iv),Qv=fe({},xn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jv=rt(Qv),Kv=fe({},Ql,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Zv=rt(Kv),Fv=fe({},xn,{newState:0,oldState:0}),Wv=rt(Fv),e_=[9,13,27,32],td=ds&&"CompositionEvent"in window,ir=null;ds&&"documentMode"in document&&(ir=document.documentMode);var t_=ds&&"TextEvent"in window&&!ir,_g=ds&&(!td||ir&&8<ir&&11>=ir),Mf=" ",$f=!1;function xg(t,e){switch(t){case"keyup":return e_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wg(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qn=!1;function s_(t,e){switch(t){case"compositionend":return wg(e);case"keypress":return e.which!==32?null:($f=!0,Mf);case"textInput":return t=e.data,t===Mf&&$f?null:t;default:return null}}function n_(t,e){if(Qn)return t==="compositionend"||!td&&xg(t,e)?(t=vg(),qi=Wu=ks=null,Qn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return _g&&e.locale!=="ko"?null:e.data;default:return null}}var a_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!a_[t.type]:e==="textarea"}function Sg(t,e,s,n){Vn?ra?ra.push(n):ra=[n]:Vn=n,e=El(e,"onChange"),0<e.length&&(s=new Vl("onChange","change",null,s,n),t.push({event:s,listeners:e}))}var lr=null,Ar=null;function r_(t){gp(t,0)}function Jl(t){var e=Va(t);if(hg(e))return t}function qf(t,e){if(t==="change")return e}var jg=!1;if(ds){var $o;if(ds){var Uo="oninput"in document;if(!Uo){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),Uo=typeof zf.oninput=="function"}$o=Uo}else $o=!1;jg=$o&&(!document.documentMode||9<document.documentMode)}function Lf(){lr&&(lr.detachEvent("onpropertychange",Ng),Ar=lr=null)}function Ng(t){if(t.propertyName==="value"&&Jl(Ar)){var e=[];Sg(e,Ar,t,Fu(t)),yg(r_,e)}}function i_(t,e,s){t==="focusin"?(Lf(),lr=e,Ar=s,lr.attachEvent("onpropertychange",Ng)):t==="focusout"&&Lf()}function l_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Jl(Ar)}function o_(t,e){if(t==="click")return Jl(e)}function c_(t,e){if(t==="input"||t==="change")return Jl(e)}function u_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yt=typeof Object.is=="function"?Object.is:u_;function Tr(t,e){if(yt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var s=Object.keys(t),n=Object.keys(e);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var a=s[n];if(!Oc.call(e,a)||!yt(t[a],e[a]))return!1}return!0}function Bf(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Hf(t,e){var s=Bf(t);t=0;for(var n;s;){if(s.nodeType===3){if(n=t+s.textContent.length,t<=e&&n>=e)return{node:s,offset:e-t};t=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Bf(s)}}function Eg(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Eg(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ag(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=ol(t.document);e instanceof t.HTMLIFrameElement;){try{var s=typeof e.contentWindow.location.href=="string"}catch{s=!1}if(s)t=e.contentWindow;else break;e=ol(t.document)}return e}function sd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var d_=ds&&"documentMode"in document&&11>=document.documentMode,Jn=null,$c=null,or=null,Uc=!1;function Gf(t,e,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Uc||Jn==null||Jn!==ol(n)||(n=Jn,"selectionStart"in n&&sd(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),or&&Tr(or,n)||(or=n,n=El($c,"onSelect"),0<n.length&&(e=new Vl("onSelect","select",null,e,s),t.push({event:e,listeners:n}),e.target=Jn)))}function Js(t,e){var s={};return s[t.toLowerCase()]=e.toLowerCase(),s["Webkit"+t]="webkit"+e,s["Moz"+t]="moz"+e,s}var Kn={animationend:Js("Animation","AnimationEnd"),animationiteration:Js("Animation","AnimationIteration"),animationstart:Js("Animation","AnimationStart"),transitionrun:Js("Transition","TransitionRun"),transitionstart:Js("Transition","TransitionStart"),transitioncancel:Js("Transition","TransitionCancel"),transitionend:Js("Transition","TransitionEnd")},qo={},Tg={};ds&&(Tg=document.createElement("div").style,"AnimationEvent"in window||(delete Kn.animationend.animation,delete Kn.animationiteration.animation,delete Kn.animationstart.animation),"TransitionEvent"in window||delete Kn.transitionend.transition);function wn(t){if(qo[t])return qo[t];if(!Kn[t])return t;var e=Kn[t],s;for(s in e)if(e.hasOwnProperty(s)&&s in Tg)return qo[t]=e[s];return t}var Og=wn("animationend"),Rg=wn("animationiteration"),Cg=wn("animationstart"),f_=wn("transitionrun"),h_=wn("transitionstart"),m_=wn("transitioncancel"),kg=wn("transitionend"),Dg=new Map,qc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qc.push("scrollEnd");function qt(t,e){Dg.set(t,e),_n(e,[t])}var Pf=new WeakMap;function Et(t,e){if(typeof t=="object"&&t!==null){var s=Pf.get(t);return s!==void 0?s:(e={value:t,source:e,stack:Af(e)},Pf.set(t,e),e)}return{value:t,source:e,stack:Af(e)}}var xt=[],Zn=0,nd=0;function Kl(){for(var t=Zn,e=nd=Zn=0;e<t;){var s=xt[e];xt[e++]=null;var n=xt[e];xt[e++]=null;var a=xt[e];xt[e++]=null;var r=xt[e];if(xt[e++]=null,n!==null&&a!==null){var i=n.pending;i===null?a.next=a:(a.next=i.next,i.next=a),n.pending=a}r!==0&&Mg(s,a,r)}}function Zl(t,e,s,n){xt[Zn++]=t,xt[Zn++]=e,xt[Zn++]=s,xt[Zn++]=n,nd|=n,t.lanes|=n,t=t.alternate,t!==null&&(t.lanes|=n)}function ad(t,e,s,n){return Zl(t,e,s,n),cl(t)}function Ea(t,e){return Zl(t,null,null,e),cl(t)}function Mg(t,e,s){t.lanes|=s;var n=t.alternate;n!==null&&(n.lanes|=s);for(var a=!1,r=t.return;r!==null;)r.childLanes|=s,n=r.alternate,n!==null&&(n.childLanes|=s),r.tag===22&&(t=r.stateNode,t===null||t._visibility&1||(a=!0)),t=r,r=r.return;return t.tag===3?(r=t.stateNode,a&&e!==null&&(a=31-gt(s),t=r.hiddenUpdates,n=t[a],n===null?t[a]=[e]:n.push(e),e.lane=s|536870912),r):null}function cl(t){if(50<yr)throw yr=0,au=null,Error(k(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var Fn={};function g_(t,e,s,n){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ht(t,e,s,n){return new g_(t,e,s,n)}function rd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cs(t,e){var s=t.alternate;return s===null?(s=ht(t.tag,e,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=e,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&65011712,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,e=t.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s.refCleanup=t.refCleanup,s}function $g(t,e){t.flags&=65011714;var s=t.alternate;return s===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,t.type=s.type,e=s.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Li(t,e,s,n,a,r){var i=0;if(n=t,typeof t=="function")rd(t)&&(i=1);else if(typeof t=="string")i=bx(t,s,Xt.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Nc:return t=ht(31,s,e,a),t.elementType=Nc,t.lanes=r,t;case Xn:return cn(s.children,a,r,e);case eg:i=8,a|=24;break;case wc:return t=ht(12,s,e,a|2),t.elementType=wc,t.lanes=r,t;case Sc:return t=ht(13,s,e,a),t.elementType=Sc,t.lanes=r,t;case jc:return t=ht(19,s,e,a),t.elementType=jc,t.lanes=r,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case rv:case as:i=10;break e;case tg:i=9;break e;case Yu:i=11;break e;case Iu:i=14;break e;case js:i=16,n=null;break e}i=29,s=Error(k(130,t===null?"null":typeof t,"")),n=null}return e=ht(i,s,e,a),e.elementType=t,e.type=n,e.lanes=r,e}function cn(t,e,s,n){return t=ht(7,t,n,e),t.lanes=s,t}function zo(t,e,s){return t=ht(6,t,null,e),t.lanes=s,t}function Lo(t,e,s){return e=ht(4,t.children!==null?t.children:[],t.key,e),e.lanes=s,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var Wn=[],ea=0,ul=null,dl=0,St=[],jt=0,un=null,rs=1,is="";function Ws(t,e){Wn[ea++]=dl,Wn[ea++]=ul,ul=t,dl=e}function Ug(t,e,s){St[jt++]=rs,St[jt++]=is,St[jt++]=un,un=t;var n=rs;t=is;var a=32-gt(n)-1;n&=~(1<<a),s+=1;var r=32-gt(e)+a;if(30<r){var i=a-a%5;r=(n&(1<<i)-1).toString(32),n>>=i,a-=i,rs=1<<32-gt(e)+a|s<<a|n,is=r+t}else rs=1<<r|s<<a|n,is=t}function id(t){t.return!==null&&(Ws(t,1),Ug(t,1,0))}function ld(t){for(;t===ul;)ul=Wn[--ea],Wn[ea]=null,dl=Wn[--ea],Wn[ea]=null;for(;t===un;)un=St[--jt],St[jt]=null,is=St[--jt],St[jt]=null,rs=St[--jt],St[jt]=null}var Je=null,be=null,se=!1,dn=null,Ht=!1,zc=Error(k(519));function gn(t){var e=Error(k(418,""));throw Or(Et(e,t)),zc}function Xf(t){var e=t.stateNode,s=t.type,n=t.memoizedProps;switch(e[Ie]=t,e[at]=n,s){case"dialog":F("cancel",e),F("close",e);break;case"iframe":case"object":case"embed":F("load",e);break;case"video":case"audio":for(s=0;s<kr.length;s++)F(kr[s],e);break;case"source":F("error",e);break;case"img":case"image":case"link":F("error",e),F("load",e);break;case"details":F("toggle",e);break;case"input":F("invalid",e),mg(e,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),ll(e);break;case"select":F("invalid",e);break;case"textarea":F("invalid",e),pg(e,n.value,n.defaultValue,n.children),ll(e)}s=n.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||e.textContent===""+s||n.suppressHydrationWarning===!0||bp(e.textContent,s)?(n.popover!=null&&(F("beforetoggle",e),F("toggle",e)),n.onScroll!=null&&F("scroll",e),n.onScrollEnd!=null&&F("scrollend",e),n.onClick!=null&&(e.onclick=ro),e=!0):e=!1,e||gn(t)}function Yf(t){for(Je=t.return;Je;)switch(Je.tag){case 5:case 13:Ht=!1;return;case 27:case 3:Ht=!0;return;default:Je=Je.return}}function za(t){if(t!==Je)return!1;if(!se)return Yf(t),se=!0,!1;var e=t.tag,s;if((s=e!==3&&e!==27)&&((s=e===5)&&(s=t.type,s=!(s!=="form"&&s!=="button")||uu(t.type,t.memoizedProps)),s=!s),s&&be&&gn(t),Yf(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(k(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(s=t.data,s==="/$"){if(e===0){be=Ut(t.nextSibling);break e}e--}else s!=="$"&&s!=="$!"&&s!=="$?"||e++;t=t.nextSibling}be=null}}else e===27?(e=be,Vs(t.type)?(t=hu,hu=null,be=t):be=e):be=Je?Ut(t.stateNode.nextSibling):null;return!0}function Vr(){be=Je=null,se=!1}function If(){var t=dn;return t!==null&&(tt===null?tt=t:tt.push.apply(tt,t),dn=null),t}function Or(t){dn===null?dn=[t]:dn.push(t)}var Lc=Vt(null),Sn=null,ls=null;function Es(t,e,s){ge(Lc,e._currentValue),e._currentValue=s}function us(t){t._currentValue=Lc.current,qe(Lc)}function Bc(t,e,s){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===s)break;t=t.return}}function Hc(t,e,s,n){var a=t.child;for(a!==null&&(a.return=t);a!==null;){var r=a.dependencies;if(r!==null){var i=a.child;r=r.firstContext;e:for(;r!==null;){var l=r;r=a;for(var c=0;c<e.length;c++)if(l.context===e[c]){r.lanes|=s,l=r.alternate,l!==null&&(l.lanes|=s),Bc(r.return,s,t),n||(i=null);break e}r=l.next}}else if(a.tag===18){if(i=a.return,i===null)throw Error(k(341));i.lanes|=s,r=i.alternate,r!==null&&(r.lanes|=s),Bc(i,s,t),i=null}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}}function Qr(t,e,s,n){t=null;for(var a=e,r=!1;a!==null;){if(!r){if(a.flags&524288)r=!0;else if(a.flags&262144)break}if(a.tag===10){var i=a.alternate;if(i===null)throw Error(k(387));if(i=i.memoizedProps,i!==null){var l=a.type;yt(a.pendingProps.value,i.value)||(t!==null?t.push(l):t=[l])}}else if(a===nl.current){if(i=a.alternate,i===null)throw Error(k(387));i.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(t!==null?t.push($r):t=[$r])}a=a.return}t!==null&&Hc(e,t,s,n),e.flags|=262144}function fl(t){for(t=t.firstContext;t!==null;){if(!yt(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function pn(t){Sn=t,ls=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Ve(t){return qg(Sn,t)}function pi(t,e){return Sn===null&&pn(t),qg(t,e)}function qg(t,e){var s=e._currentValue;if(e={context:e,memoizedValue:s,next:null},ls===null){if(t===null)throw Error(k(308));ls=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else ls=ls.next=e;return s}var p_=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(s,n){t.push(n)}};this.abort=function(){e.aborted=!0,t.forEach(function(s){return s()})}},b_=Ce.unstable_scheduleCallback,y_=Ce.unstable_NormalPriority,Oe={$$typeof:as,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function od(){return{controller:new p_,data:new Map,refCount:0}}function Jr(t){t.refCount--,t.refCount===0&&b_(y_,function(){t.controller.abort()})}var cr=null,Gc=0,ma=0,ia=null;function v_(t,e){if(cr===null){var s=cr=[];Gc=0,ma=Cd(),ia={status:"pending",value:void 0,then:function(n){s.push(n)}}}return Gc++,e.then(Vf,Vf),e}function Vf(){if(--Gc===0&&cr!==null){ia!==null&&(ia.status="fulfilled");var t=cr;cr=null,ma=0,ia=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function __(t,e){var s=[],n={status:"pending",value:null,reason:null,then:function(a){s.push(a)}};return t.then(function(){n.status="fulfilled",n.value=e;for(var a=0;a<s.length;a++)(0,s[a])(e)},function(a){for(n.status="rejected",n.reason=a,a=0;a<s.length;a++)(0,s[a])(void 0)}),n}var Qf=I.S;I.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&v_(t,e),Qf!==null&&Qf(t,e)};var fn=Vt(null);function cd(){var t=fn.current;return t!==null?t:ue.pooledCache}function Bi(t,e){e===null?ge(fn,fn.current):ge(fn,e.pool)}function zg(){var t=cd();return t===null?null:{parent:Oe._currentValue,pool:t}}var Kr=Error(k(460)),Lg=Error(k(474)),Fl=Error(k(542)),Pc={then:function(){}};function Jf(t){return t=t.status,t==="fulfilled"||t==="rejected"}function bi(){}function Bg(t,e,s){switch(s=t[s],s===void 0?t.push(e):s!==e&&(e.then(bi,bi),e=s),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Zf(t),t;default:if(typeof e.status=="string")e.then(bi,bi);else{if(t=ue,t!==null&&100<t.shellSuspendCounter)throw Error(k(482));t=e,t.status="pending",t.then(function(n){if(e.status==="pending"){var a=e;a.status="fulfilled",a.value=n}},function(n){if(e.status==="pending"){var a=e;a.status="rejected",a.reason=n}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,Zf(t),t}throw ur=e,Kr}}var ur=null;function Kf(){if(ur===null)throw Error(k(459));var t=ur;return ur=null,t}function Zf(t){if(t===Kr||t===Fl)throw Error(k(483))}var Ns=!1;function ud(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xc(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Us(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function qs(t,e,s){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,re&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,e=cl(t),Mg(t,null,s),e}return Zl(t,n,e,s),cl(t)}function dr(t,e,s){if(e=e.updateQueue,e!==null&&(e=e.shared,(s&4194048)!==0)){var n=e.lanes;n&=t.pendingLanes,s|=n,e.lanes=s,og(t,s)}}function Bo(t,e){var s=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var a=null,r=null;if(s=s.firstBaseUpdate,s!==null){do{var i={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};r===null?a=r=i:r=r.next=i,s=s.next}while(s!==null);r===null?a=r=e:r=r.next=e}else a=r=e;s={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:n.shared,callbacks:n.callbacks},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=e:t.next=e,s.lastBaseUpdate=e}var Yc=!1;function fr(){if(Yc){var t=ia;if(t!==null)throw t}}function hr(t,e,s,n){Yc=!1;var a=t.updateQueue;Ns=!1;var r=a.firstBaseUpdate,i=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?r=u:i.next=u,i=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(r!==null){var f=a.baseState;i=0,d=u=c=null,l=r;do{var h=l.lane&-536870913,m=h!==l.lane;if(m?(te&h)===h:(n&h)===h){h!==0&&h===ma&&(Yc=!0),d!==null&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var x=t,w=l;h=e;var N=s;switch(w.tag){case 1:if(x=w.payload,typeof x=="function"){f=x.call(N,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,h=typeof x=="function"?x.call(N,f,h):x,h==null)break e;f=fe({},f,h);break e;case 2:Ns=!0}}h=l.callback,h!==null&&(t.flags|=64,m&&(t.flags|=8192),m=a.callbacks,m===null?a.callbacks=[h]:m.push(h))}else m={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,r===null&&(a.shared.lanes=0),Ys|=i,t.lanes=i,t.memoizedState=f}}function Hg(t,e){if(typeof t!="function")throw Error(k(191,t));t.call(e)}function Gg(t,e){var s=t.callbacks;if(s!==null)for(t.callbacks=null,t=0;t<s.length;t++)Hg(s[t],e)}var ga=Vt(null),hl=Vt(0);function Ff(t,e){t=ms,ge(hl,t),ge(ga,e),ms=t|e.baseLanes}function Ic(){ge(hl,ms),ge(ga,ga.current)}function dd(){ms=hl.current,qe(ga),qe(hl)}var Ps=0,K=null,le=null,Se=null,ml=!1,la=!1,bn=!1,gl=0,Rr=0,oa=null,x_=0;function _e(){throw Error(k(321))}function fd(t,e){if(e===null)return!1;for(var s=0;s<e.length&&s<t.length;s++)if(!yt(t[s],e[s]))return!1;return!0}function hd(t,e,s,n,a,r){return Ps=r,K=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,I.H=t===null||t.memoizedState===null?v0:_0,bn=!1,r=s(n,a),bn=!1,la&&(r=Xg(e,s,n,a)),Pg(t),r}function Pg(t){I.H=pl;var e=le!==null&&le.next!==null;if(Ps=0,Se=le=K=null,ml=!1,Rr=0,oa=null,e)throw Error(k(300));t===null||Ue||(t=t.dependencies,t!==null&&fl(t)&&(Ue=!0))}function Xg(t,e,s,n){K=t;var a=0;do{if(la&&(oa=null),Rr=0,la=!1,25<=a)throw Error(k(301));if(a+=1,Se=le=null,t.updateQueue!=null){var r=t.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,r.memoCache!=null&&(r.memoCache.index=0)}I.H=T_,r=e(s,n)}while(la);return r}function w_(){var t=I.H,e=t.useState()[0];return e=typeof e.then=="function"?Zr(e):e,t=t.useState()[0],(le!==null?le.memoizedState:null)!==t&&(K.flags|=1024),e}function md(){var t=gl!==0;return gl=0,t}function gd(t,e,s){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s}function pd(t){if(ml){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}ml=!1}Ps=0,Se=le=K=null,la=!1,Rr=gl=0,oa=null}function We(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Se===null?K.memoizedState=Se=t:Se=Se.next=t,Se}function Ne(){if(le===null){var t=K.alternate;t=t!==null?t.memoizedState:null}else t=le.next;var e=Se===null?K.memoizedState:Se.next;if(e!==null)Se=e,le=t;else{if(t===null)throw K.alternate===null?Error(k(467)):Error(k(310));le=t,t={memoizedState:le.memoizedState,baseState:le.baseState,baseQueue:le.baseQueue,queue:le.queue,next:null},Se===null?K.memoizedState=Se=t:Se=Se.next=t}return Se}function bd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zr(t){var e=Rr;return Rr+=1,oa===null&&(oa=[]),t=Bg(oa,t,e),e=K,(Se===null?e.memoizedState:Se.next)===null&&(e=e.alternate,I.H=e===null||e.memoizedState===null?v0:_0),t}function Wl(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Zr(t);if(t.$$typeof===as)return Ve(t)}throw Error(k(438,String(t)))}function yd(t){var e=null,s=K.updateQueue;if(s!==null&&(e=s.memoCache),e==null){var n=K.alternate;n!==null&&(n=n.updateQueue,n!==null&&(n=n.memoCache,n!=null&&(e={data:n.data.map(function(a){return a.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),s===null&&(s=bd(),K.updateQueue=s),s.memoCache=e,s=e.data[e.index],s===void 0)for(s=e.data[e.index]=Array(t),n=0;n<t;n++)s[n]=iv;return e.index++,s}function fs(t,e){return typeof e=="function"?e(t):e}function Hi(t){var e=Ne();return vd(e,le,t)}function vd(t,e,s){var n=t.queue;if(n===null)throw Error(k(311));n.lastRenderedReducer=s;var a=t.baseQueue,r=n.pending;if(r!==null){if(a!==null){var i=a.next;a.next=r.next,r.next=i}e.baseQueue=a=r,n.pending=null}if(r=t.baseState,a===null)t.memoizedState=r;else{e=a.next;var l=i=null,c=null,u=e,d=!1;do{var f=u.lane&-536870913;if(f!==u.lane?(te&f)===f:(Ps&f)===f){var h=u.revertLane;if(h===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===ma&&(d=!0);else if((Ps&h)===h){u=u.next,h===ma&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=f,i=r):c=c.next=f,K.lanes|=h,Ys|=h;f=u.action,bn&&s(r,f),r=u.hasEagerState?u.eagerState:s(r,f)}else h={lane:f,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},c===null?(l=c=h,i=r):c=c.next=h,K.lanes|=f,Ys|=f;u=u.next}while(u!==null&&u!==e);if(c===null?i=r:c.next=l,!yt(r,t.memoizedState)&&(Ue=!0,d&&(s=ia,s!==null)))throw s;t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}return a===null&&(n.lanes=0),[t.memoizedState,n.dispatch]}function Ho(t){var e=Ne(),s=e.queue;if(s===null)throw Error(k(311));s.lastRenderedReducer=t;var n=s.dispatch,a=s.pending,r=e.memoizedState;if(a!==null){s.pending=null;var i=a=a.next;do r=t(r,i.action),i=i.next;while(i!==a);yt(r,e.memoizedState)||(Ue=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),s.lastRenderedState=r}return[r,n]}function Yg(t,e,s){var n=K,a=Ne(),r=se;if(r){if(s===void 0)throw Error(k(407));s=s()}else s=e();var i=!yt((le||a).memoizedState,s);i&&(a.memoizedState=s,Ue=!0),a=a.queue;var l=Qg.bind(null,n,a,t);if(Fr(2048,8,l,[t]),a.getSnapshot!==e||i||Se!==null&&Se.memoizedState.tag&1){if(n.flags|=2048,pa(9,eo(),Vg.bind(null,n,a,s,e),null),ue===null)throw Error(k(349));r||Ps&124||Ig(n,e,s)}return s}function Ig(t,e,s){t.flags|=16384,t={getSnapshot:e,value:s},e=K.updateQueue,e===null?(e=bd(),K.updateQueue=e,e.stores=[t]):(s=e.stores,s===null?e.stores=[t]:s.push(t))}function Vg(t,e,s,n){e.value=s,e.getSnapshot=n,Jg(e)&&Kg(t)}function Qg(t,e,s){return s(function(){Jg(e)&&Kg(t)})}function Jg(t){var e=t.getSnapshot;t=t.value;try{var s=e();return!yt(t,s)}catch{return!0}}function Kg(t){var e=Ea(t,2);e!==null&&bt(e,t,2)}function Vc(t){var e=We();if(typeof t=="function"){var s=t;if(t=s(),bn){Cs(!0);try{s()}finally{Cs(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:t},e}function Zg(t,e,s,n){return t.baseState=s,vd(t,le,typeof n=="function"?n:fs)}function S_(t,e,s,n,a){if(to(t))throw Error(k(485));if(t=e.action,t!==null){var r={payload:a,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(i){r.listeners.push(i)}};I.T!==null?s(!0):r.isTransition=!1,n(r),s=e.pending,s===null?(r.next=e.pending=r,Fg(e,r)):(r.next=s.next,e.pending=s.next=r)}}function Fg(t,e){var s=e.action,n=e.payload,a=t.state;if(e.isTransition){var r=I.T,i={};I.T=i;try{var l=s(a,n),c=I.S;c!==null&&c(i,l),Wf(t,e,l)}catch(u){Qc(t,e,u)}finally{I.T=r}}else try{r=s(a,n),Wf(t,e,r)}catch(u){Qc(t,e,u)}}function Wf(t,e,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(n){eh(t,e,n)},function(n){return Qc(t,e,n)}):eh(t,e,s)}function eh(t,e,s){e.status="fulfilled",e.value=s,Wg(e),t.state=s,e=t.pending,e!==null&&(s=e.next,s===e?t.pending=null:(s=s.next,e.next=s,Fg(t,s)))}function Qc(t,e,s){var n=t.pending;if(t.pending=null,n!==null){n=n.next;do e.status="rejected",e.reason=s,Wg(e),e=e.next;while(e!==n)}t.action=null}function Wg(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function e0(t,e){return e}function th(t,e){if(se){var s=ue.formState;if(s!==null){e:{var n=K;if(se){if(be){t:{for(var a=be,r=Ht;a.nodeType!==8;){if(!r){a=null;break t}if(a=Ut(a.nextSibling),a===null){a=null;break t}}r=a.data,a=r==="F!"||r==="F"?a:null}if(a){be=Ut(a.nextSibling),n=a.data==="F!";break e}}gn(n)}n=!1}n&&(e=s[0])}}return s=We(),s.memoizedState=s.baseState=e,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e0,lastRenderedState:e},s.queue=n,s=p0.bind(null,K,n),n.dispatch=s,n=Vc(!1),r=Sd.bind(null,K,!1,n.queue),n=We(),a={state:e,dispatch:null,action:t,pending:null},n.queue=a,s=S_.bind(null,K,a,r,s),a.dispatch=s,n.memoizedState=t,[e,s,!1]}function sh(t){var e=Ne();return t0(e,le,t)}function t0(t,e,s){if(e=vd(t,e,e0)[0],t=Hi(fs)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var n=Zr(e)}catch(i){throw i===Kr?Fl:i}else n=e;e=Ne();var a=e.queue,r=a.dispatch;return s!==e.memoizedState&&(K.flags|=2048,pa(9,eo(),j_.bind(null,a,s),null)),[n,r,t]}function j_(t,e){t.action=e}function nh(t){var e=Ne(),s=le;if(s!==null)return t0(e,s,t);Ne(),e=e.memoizedState,s=Ne();var n=s.queue.dispatch;return s.memoizedState=t,[e,n,!1]}function pa(t,e,s,n){return t={tag:t,create:s,deps:n,inst:e,next:null},e=K.updateQueue,e===null&&(e=bd(),K.updateQueue=e),s=e.lastEffect,s===null?e.lastEffect=t.next=t:(n=s.next,s.next=t,t.next=n,e.lastEffect=t),t}function eo(){return{destroy:void 0,resource:void 0}}function s0(){return Ne().memoizedState}function Gi(t,e,s,n){var a=We();n=n===void 0?null:n,K.flags|=t,a.memoizedState=pa(1|e,eo(),s,n)}function Fr(t,e,s,n){var a=Ne();n=n===void 0?null:n;var r=a.memoizedState.inst;le!==null&&n!==null&&fd(n,le.memoizedState.deps)?a.memoizedState=pa(e,r,s,n):(K.flags|=t,a.memoizedState=pa(1|e,r,s,n))}function ah(t,e){Gi(8390656,8,t,e)}function n0(t,e){Fr(2048,8,t,e)}function a0(t,e){return Fr(4,2,t,e)}function r0(t,e){return Fr(4,4,t,e)}function i0(t,e){if(typeof e=="function"){t=t();var s=e(t);return function(){typeof s=="function"?s():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function l0(t,e,s){s=s!=null?s.concat([t]):null,Fr(4,4,i0.bind(null,e,t),s)}function _d(){}function o0(t,e){var s=Ne();e=e===void 0?null:e;var n=s.memoizedState;return e!==null&&fd(e,n[1])?n[0]:(s.memoizedState=[t,e],t)}function c0(t,e){var s=Ne();e=e===void 0?null:e;var n=s.memoizedState;if(e!==null&&fd(e,n[1]))return n[0];if(n=t(),bn){Cs(!0);try{t()}finally{Cs(!1)}}return s.memoizedState=[n,e],n}function xd(t,e,s){return s===void 0||Ps&1073741824?t.memoizedState=e:(t.memoizedState=s,t=W0(),K.lanes|=t,Ys|=t,s)}function u0(t,e,s,n){return yt(s,e)?s:ga.current!==null?(t=xd(t,s,n),yt(t,e)||(Ue=!0),t):Ps&42?(t=W0(),K.lanes|=t,Ys|=t,e):(Ue=!0,t.memoizedState=s)}function d0(t,e,s,n,a){var r=ne.p;ne.p=r!==0&&8>r?r:8;var i=I.T,l={};I.T=l,Sd(t,!1,e,s);try{var c=a(),u=I.S;if(u!==null&&u(l,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=__(c,n);mr(t,e,d,pt(t))}else mr(t,e,n,pt(t))}catch(f){mr(t,e,{then:function(){},status:"rejected",reason:f},pt())}finally{ne.p=r,I.T=i}}function N_(){}function Jc(t,e,s,n){if(t.tag!==5)throw Error(k(476));var a=f0(t).queue;d0(t,a,e,on,s===null?N_:function(){return h0(t),s(n)})}function f0(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:on,baseState:on,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:on},next:null};var s={};return e.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:s},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function h0(t){var e=f0(t).next.queue;mr(t,e,{},pt())}function wd(){return Ve($r)}function m0(){return Ne().memoizedState}function g0(){return Ne().memoizedState}function E_(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var s=pt();t=Us(s);var n=qs(e,t,s);n!==null&&(bt(n,e,s),dr(n,e,s)),e={cache:od()},t.payload=e;return}e=e.return}}function A_(t,e,s){var n=pt();s={lane:n,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null},to(t)?b0(e,s):(s=ad(t,e,s,n),s!==null&&(bt(s,t,n),y0(s,e,n)))}function p0(t,e,s){var n=pt();mr(t,e,s,n)}function mr(t,e,s,n){var a={lane:n,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null};if(to(t))b0(e,a);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var i=e.lastRenderedState,l=r(i,s);if(a.hasEagerState=!0,a.eagerState=l,yt(l,i))return Zl(t,e,a,0),ue===null&&Kl(),!1}catch{}finally{}if(s=ad(t,e,a,n),s!==null)return bt(s,t,n),y0(s,e,n),!0}return!1}function Sd(t,e,s,n){if(n={lane:2,revertLane:Cd(),action:n,hasEagerState:!1,eagerState:null,next:null},to(t)){if(e)throw Error(k(479))}else e=ad(t,s,n,2),e!==null&&bt(e,t,2)}function to(t){var e=t.alternate;return t===K||e!==null&&e===K}function b0(t,e){la=ml=!0;var s=t.pending;s===null?e.next=e:(e.next=s.next,s.next=e),t.pending=e}function y0(t,e,s){if(s&4194048){var n=e.lanes;n&=t.pendingLanes,s|=n,e.lanes=s,og(t,s)}}var pl={readContext:Ve,use:Wl,useCallback:_e,useContext:_e,useEffect:_e,useImperativeHandle:_e,useLayoutEffect:_e,useInsertionEffect:_e,useMemo:_e,useReducer:_e,useRef:_e,useState:_e,useDebugValue:_e,useDeferredValue:_e,useTransition:_e,useSyncExternalStore:_e,useId:_e,useHostTransitionStatus:_e,useFormState:_e,useActionState:_e,useOptimistic:_e,useMemoCache:_e,useCacheRefresh:_e},v0={readContext:Ve,use:Wl,useCallback:function(t,e){return We().memoizedState=[t,e===void 0?null:e],t},useContext:Ve,useEffect:ah,useImperativeHandle:function(t,e,s){s=s!=null?s.concat([t]):null,Gi(4194308,4,i0.bind(null,e,t),s)},useLayoutEffect:function(t,e){return Gi(4194308,4,t,e)},useInsertionEffect:function(t,e){Gi(4,2,t,e)},useMemo:function(t,e){var s=We();e=e===void 0?null:e;var n=t();if(bn){Cs(!0);try{t()}finally{Cs(!1)}}return s.memoizedState=[n,e],n},useReducer:function(t,e,s){var n=We();if(s!==void 0){var a=s(e);if(bn){Cs(!0);try{s(e)}finally{Cs(!1)}}}else a=e;return n.memoizedState=n.baseState=a,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:a},n.queue=t,t=t.dispatch=A_.bind(null,K,t),[n.memoizedState,t]},useRef:function(t){var e=We();return t={current:t},e.memoizedState=t},useState:function(t){t=Vc(t);var e=t.queue,s=p0.bind(null,K,e);return e.dispatch=s,[t.memoizedState,s]},useDebugValue:_d,useDeferredValue:function(t,e){var s=We();return xd(s,t,e)},useTransition:function(){var t=Vc(!1);return t=d0.bind(null,K,t.queue,!0,!1),We().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,s){var n=K,a=We();if(se){if(s===void 0)throw Error(k(407));s=s()}else{if(s=e(),ue===null)throw Error(k(349));te&124||Ig(n,e,s)}a.memoizedState=s;var r={value:s,getSnapshot:e};return a.queue=r,ah(Qg.bind(null,n,r,t),[t]),n.flags|=2048,pa(9,eo(),Vg.bind(null,n,r,s,e),null),s},useId:function(){var t=We(),e=ue.identifierPrefix;if(se){var s=is,n=rs;s=(n&~(1<<32-gt(n)-1)).toString(32)+s,e="«"+e+"R"+s,s=gl++,0<s&&(e+="H"+s.toString(32)),e+="»"}else s=x_++,e="«"+e+"r"+s.toString(32)+"»";return t.memoizedState=e},useHostTransitionStatus:wd,useFormState:th,useActionState:th,useOptimistic:function(t){var e=We();e.memoizedState=e.baseState=t;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=s,e=Sd.bind(null,K,!0,s),s.dispatch=e,[t,e]},useMemoCache:yd,useCacheRefresh:function(){return We().memoizedState=E_.bind(null,K)}},_0={readContext:Ve,use:Wl,useCallback:o0,useContext:Ve,useEffect:n0,useImperativeHandle:l0,useInsertionEffect:a0,useLayoutEffect:r0,useMemo:c0,useReducer:Hi,useRef:s0,useState:function(){return Hi(fs)},useDebugValue:_d,useDeferredValue:function(t,e){var s=Ne();return u0(s,le.memoizedState,t,e)},useTransition:function(){var t=Hi(fs)[0],e=Ne().memoizedState;return[typeof t=="boolean"?t:Zr(t),e]},useSyncExternalStore:Yg,useId:m0,useHostTransitionStatus:wd,useFormState:sh,useActionState:sh,useOptimistic:function(t,e){var s=Ne();return Zg(s,le,t,e)},useMemoCache:yd,useCacheRefresh:g0},T_={readContext:Ve,use:Wl,useCallback:o0,useContext:Ve,useEffect:n0,useImperativeHandle:l0,useInsertionEffect:a0,useLayoutEffect:r0,useMemo:c0,useReducer:Ho,useRef:s0,useState:function(){return Ho(fs)},useDebugValue:_d,useDeferredValue:function(t,e){var s=Ne();return le===null?xd(s,t,e):u0(s,le.memoizedState,t,e)},useTransition:function(){var t=Ho(fs)[0],e=Ne().memoizedState;return[typeof t=="boolean"?t:Zr(t),e]},useSyncExternalStore:Yg,useId:m0,useHostTransitionStatus:wd,useFormState:nh,useActionState:nh,useOptimistic:function(t,e){var s=Ne();return le!==null?Zg(s,le,t,e):(s.baseState=t,[t,s.queue.dispatch])},useMemoCache:yd,useCacheRefresh:g0},ca=null,Cr=0;function yi(t){var e=Cr;return Cr+=1,ca===null&&(ca=[]),Bg(ca,t,e)}function La(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function vi(t,e){throw e.$$typeof===av?Error(k(525)):(t=Object.prototype.toString.call(e),Error(k(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function rh(t){var e=t._init;return e(t._payload)}function x0(t){function e(y,g){if(t){var p=y.deletions;p===null?(y.deletions=[g],y.flags|=16):p.push(g)}}function s(y,g){if(!t)return null;for(;g!==null;)e(y,g),g=g.sibling;return null}function n(y){for(var g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function a(y,g){return y=cs(y,g),y.index=0,y.sibling=null,y}function r(y,g,p){return y.index=p,t?(p=y.alternate,p!==null?(p=p.index,p<g?(y.flags|=67108866,g):p):(y.flags|=67108866,g)):(y.flags|=1048576,g)}function i(y){return t&&y.alternate===null&&(y.flags|=67108866),y}function l(y,g,p,b){return g===null||g.tag!==6?(g=zo(p,y.mode,b),g.return=y,g):(g=a(g,p),g.return=y,g)}function c(y,g,p,b){var A=p.type;return A===Xn?d(y,g,p.props.children,b,p.key):g!==null&&(g.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===js&&rh(A)===g.type)?(g=a(g,p.props),La(g,p),g.return=y,g):(g=Li(p.type,p.key,p.props,null,y.mode,b),La(g,p),g.return=y,g)}function u(y,g,p,b){return g===null||g.tag!==4||g.stateNode.containerInfo!==p.containerInfo||g.stateNode.implementation!==p.implementation?(g=Lo(p,y.mode,b),g.return=y,g):(g=a(g,p.children||[]),g.return=y,g)}function d(y,g,p,b,A){return g===null||g.tag!==7?(g=cn(p,y.mode,b,A),g.return=y,g):(g=a(g,p),g.return=y,g)}function f(y,g,p){if(typeof g=="string"&&g!==""||typeof g=="number"||typeof g=="bigint")return g=zo(""+g,y.mode,p),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case di:return p=Li(g.type,g.key,g.props,null,y.mode,p),La(p,g),p.return=y,p;case Ya:return g=Lo(g,y.mode,p),g.return=y,g;case js:var b=g._init;return g=b(g._payload),f(y,g,p)}if(Ia(g)||$a(g))return g=cn(g,y.mode,p,null),g.return=y,g;if(typeof g.then=="function")return f(y,yi(g),p);if(g.$$typeof===as)return f(y,pi(y,g),p);vi(y,g)}return null}function h(y,g,p,b){var A=g!==null?g.key:null;if(typeof p=="string"&&p!==""||typeof p=="number"||typeof p=="bigint")return A!==null?null:l(y,g,""+p,b);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case di:return p.key===A?c(y,g,p,b):null;case Ya:return p.key===A?u(y,g,p,b):null;case js:return A=p._init,p=A(p._payload),h(y,g,p,b)}if(Ia(p)||$a(p))return A!==null?null:d(y,g,p,b,null);if(typeof p.then=="function")return h(y,g,yi(p),b);if(p.$$typeof===as)return h(y,g,pi(y,p),b);vi(y,p)}return null}function m(y,g,p,b,A){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return y=y.get(p)||null,l(g,y,""+b,A);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case di:return y=y.get(b.key===null?p:b.key)||null,c(g,y,b,A);case Ya:return y=y.get(b.key===null?p:b.key)||null,u(g,y,b,A);case js:var O=b._init;return b=O(b._payload),m(y,g,p,b,A)}if(Ia(b)||$a(b))return y=y.get(p)||null,d(g,y,b,A,null);if(typeof b.then=="function")return m(y,g,p,yi(b),A);if(b.$$typeof===as)return m(y,g,p,pi(g,b),A);vi(g,b)}return null}function x(y,g,p,b){for(var A=null,O=null,T=g,v=g=0,C=null;T!==null&&v<p.length;v++){T.index>v?(C=T,T=null):C=T.sibling;var j=h(y,T,p[v],b);if(j===null){T===null&&(T=C);break}t&&T&&j.alternate===null&&e(y,T),g=r(j,g,v),O===null?A=j:O.sibling=j,O=j,T=C}if(v===p.length)return s(y,T),se&&Ws(y,v),A;if(T===null){for(;v<p.length;v++)T=f(y,p[v],b),T!==null&&(g=r(T,g,v),O===null?A=T:O.sibling=T,O=T);return se&&Ws(y,v),A}for(T=n(T);v<p.length;v++)C=m(T,y,v,p[v],b),C!==null&&(t&&C.alternate!==null&&T.delete(C.key===null?v:C.key),g=r(C,g,v),O===null?A=C:O.sibling=C,O=C);return t&&T.forEach(function(R){return e(y,R)}),se&&Ws(y,v),A}function w(y,g,p,b){if(p==null)throw Error(k(151));for(var A=null,O=null,T=g,v=g=0,C=null,j=p.next();T!==null&&!j.done;v++,j=p.next()){T.index>v?(C=T,T=null):C=T.sibling;var R=h(y,T,j.value,b);if(R===null){T===null&&(T=C);break}t&&T&&R.alternate===null&&e(y,T),g=r(R,g,v),O===null?A=R:O.sibling=R,O=R,T=C}if(j.done)return s(y,T),se&&Ws(y,v),A;if(T===null){for(;!j.done;v++,j=p.next())j=f(y,j.value,b),j!==null&&(g=r(j,g,v),O===null?A=j:O.sibling=j,O=j);return se&&Ws(y,v),A}for(T=n(T);!j.done;v++,j=p.next())j=m(T,y,v,j.value,b),j!==null&&(t&&j.alternate!==null&&T.delete(j.key===null?v:j.key),g=r(j,g,v),O===null?A=j:O.sibling=j,O=j);return t&&T.forEach(function(M){return e(y,M)}),se&&Ws(y,v),A}function N(y,g,p,b){if(typeof p=="object"&&p!==null&&p.type===Xn&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case di:e:{for(var A=p.key;g!==null;){if(g.key===A){if(A=p.type,A===Xn){if(g.tag===7){s(y,g.sibling),b=a(g,p.props.children),b.return=y,y=b;break e}}else if(g.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===js&&rh(A)===g.type){s(y,g.sibling),b=a(g,p.props),La(b,p),b.return=y,y=b;break e}s(y,g);break}else e(y,g);g=g.sibling}p.type===Xn?(b=cn(p.props.children,y.mode,b,p.key),b.return=y,y=b):(b=Li(p.type,p.key,p.props,null,y.mode,b),La(b,p),b.return=y,y=b)}return i(y);case Ya:e:{for(A=p.key;g!==null;){if(g.key===A)if(g.tag===4&&g.stateNode.containerInfo===p.containerInfo&&g.stateNode.implementation===p.implementation){s(y,g.sibling),b=a(g,p.children||[]),b.return=y,y=b;break e}else{s(y,g);break}else e(y,g);g=g.sibling}b=Lo(p,y.mode,b),b.return=y,y=b}return i(y);case js:return A=p._init,p=A(p._payload),N(y,g,p,b)}if(Ia(p))return x(y,g,p,b);if($a(p)){if(A=$a(p),typeof A!="function")throw Error(k(150));return p=A.call(p),w(y,g,p,b)}if(typeof p.then=="function")return N(y,g,yi(p),b);if(p.$$typeof===as)return N(y,g,pi(y,p),b);vi(y,p)}return typeof p=="string"&&p!==""||typeof p=="number"||typeof p=="bigint"?(p=""+p,g!==null&&g.tag===6?(s(y,g.sibling),b=a(g,p),b.return=y,y=b):(s(y,g),b=zo(p,y.mode,b),b.return=y,y=b),i(y)):s(y,g)}return function(y,g,p,b){try{Cr=0;var A=N(y,g,p,b);return ca=null,A}catch(T){if(T===Kr||T===Fl)throw T;var O=ht(29,T,null,y.mode);return O.lanes=b,O.return=y,O}finally{}}}var ba=x0(!0),w0=x0(!1),Rt=Vt(null),It=null;function As(t){var e=t.alternate;ge(Re,Re.current&1),ge(Rt,t),It===null&&(e===null||ga.current!==null||e.memoizedState!==null)&&(It=t)}function S0(t){if(t.tag===22){if(ge(Re,Re.current),ge(Rt,t),It===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(It=t)}}else Ts()}function Ts(){ge(Re,Re.current),ge(Rt,Rt.current)}function os(t){qe(Rt),It===t&&(It=null),qe(Re)}var Re=Vt(0);function bl(t){for(var e=t;e!==null;){if(e.tag===13){var s=e.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||fu(s)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function Go(t,e,s,n){e=t.memoizedState,s=s(n,e),s=s==null?e:fe({},e,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Kc={enqueueSetState:function(t,e,s){t=t._reactInternals;var n=pt(),a=Us(n);a.payload=e,s!=null&&(a.callback=s),e=qs(t,a,n),e!==null&&(bt(e,t,n),dr(e,t,n))},enqueueReplaceState:function(t,e,s){t=t._reactInternals;var n=pt(),a=Us(n);a.tag=1,a.payload=e,s!=null&&(a.callback=s),e=qs(t,a,n),e!==null&&(bt(e,t,n),dr(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var s=pt(),n=Us(s);n.tag=2,e!=null&&(n.callback=e),e=qs(t,n,s),e!==null&&(bt(e,t,s),dr(e,t,s))}};function ih(t,e,s,n,a,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,r,i):e.prototype&&e.prototype.isPureReactComponent?!Tr(s,n)||!Tr(a,r):!0}function lh(t,e,s,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(s,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(s,n),e.state!==t&&Kc.enqueueReplaceState(e,e.state,null)}function yn(t,e){var s=e;if("ref"in e){s={};for(var n in e)n!=="ref"&&(s[n]=e[n])}if(t=t.defaultProps){s===e&&(s=fe({},s));for(var a in t)s[a]===void 0&&(s[a]=t[a])}return s}var yl=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)};function j0(t){yl(t)}function N0(t){console.error(t)}function E0(t){yl(t)}function vl(t,e){try{var s=t.onUncaughtError;s(e.value,{componentStack:e.stack})}catch(n){setTimeout(function(){throw n})}}function oh(t,e,s){try{var n=t.onCaughtError;n(s.value,{componentStack:s.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function Zc(t,e,s){return s=Us(s),s.tag=3,s.payload={element:null},s.callback=function(){vl(t,e)},s}function A0(t){return t=Us(t),t.tag=3,t}function T0(t,e,s,n){var a=s.type.getDerivedStateFromError;if(typeof a=="function"){var r=n.value;t.payload=function(){return a(r)},t.callback=function(){oh(e,s,n)}}var i=s.stateNode;i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){oh(e,s,n),typeof a!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var l=n.stack;this.componentDidCatch(n.value,{componentStack:l!==null?l:""})})}function O_(t,e,s,n,a){if(s.flags|=32768,n!==null&&typeof n=="object"&&typeof n.then=="function"){if(e=s.alternate,e!==null&&Qr(e,s,a,!0),s=Rt.current,s!==null){switch(s.tag){case 13:return It===null?ru():s.alternate===null&&ye===0&&(ye=3),s.flags&=-257,s.flags|=65536,s.lanes=a,n===Pc?s.flags|=16384:(e=s.updateQueue,e===null?s.updateQueue=new Set([n]):e.add(n),Wo(t,n,a)),!1;case 22:return s.flags|=65536,n===Pc?s.flags|=16384:(e=s.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([n])},s.updateQueue=e):(s=e.retryQueue,s===null?e.retryQueue=new Set([n]):s.add(n)),Wo(t,n,a)),!1}throw Error(k(435,s.tag))}return Wo(t,n,a),ru(),!1}if(se)return e=Rt.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=a,n!==zc&&(t=Error(k(422),{cause:n}),Or(Et(t,s)))):(n!==zc&&(e=Error(k(423),{cause:n}),Or(Et(e,s))),t=t.current.alternate,t.flags|=65536,a&=-a,t.lanes|=a,n=Et(n,s),a=Zc(t.stateNode,n,a),Bo(t,a),ye!==4&&(ye=2)),!1;var r=Error(k(520),{cause:n});if(r=Et(r,s),br===null?br=[r]:br.push(r),ye!==4&&(ye=2),e===null)return!0;n=Et(n,s),s=e;do{switch(s.tag){case 3:return s.flags|=65536,t=a&-a,s.lanes|=t,t=Zc(s.stateNode,n,t),Bo(s,t),!1;case 1:if(e=s.type,r=s.stateNode,(s.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||r!==null&&typeof r.componentDidCatch=="function"&&(zs===null||!zs.has(r))))return s.flags|=65536,a&=-a,s.lanes|=a,a=A0(a),T0(a,t,s,n),Bo(s,a),!1}s=s.return}while(s!==null);return!1}var O0=Error(k(461)),Ue=!1;function Be(t,e,s,n){e.child=t===null?w0(e,null,s,n):ba(e,t.child,s,n)}function ch(t,e,s,n,a){s=s.render;var r=e.ref;if("ref"in n){var i={};for(var l in n)l!=="ref"&&(i[l]=n[l])}else i=n;return pn(e),n=hd(t,e,s,i,r,a),l=md(),t!==null&&!Ue?(gd(t,e,a),hs(t,e,a)):(se&&l&&id(e),e.flags|=1,Be(t,e,n,a),e.child)}function uh(t,e,s,n,a){if(t===null){var r=s.type;return typeof r=="function"&&!rd(r)&&r.defaultProps===void 0&&s.compare===null?(e.tag=15,e.type=r,R0(t,e,r,n,a)):(t=Li(s.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!jd(t,a)){var i=r.memoizedProps;if(s=s.compare,s=s!==null?s:Tr,s(i,n)&&t.ref===e.ref)return hs(t,e,a)}return e.flags|=1,t=cs(r,n),t.ref=e.ref,t.return=e,e.child=t}function R0(t,e,s,n,a){if(t!==null){var r=t.memoizedProps;if(Tr(r,n)&&t.ref===e.ref)if(Ue=!1,e.pendingProps=n=r,jd(t,a))t.flags&131072&&(Ue=!0);else return e.lanes=t.lanes,hs(t,e,a)}return Fc(t,e,s,n,a)}function C0(t,e,s){var n=e.pendingProps,a=n.children,r=t!==null?t.memoizedState:null;if(n.mode==="hidden"){if(e.flags&128){if(n=r!==null?r.baseLanes|s:s,t!==null){for(a=e.child=t.child,r=0;a!==null;)r=r|a.lanes|a.childLanes,a=a.sibling;e.childLanes=r&~n}else e.childLanes=0,e.child=null;return dh(t,e,n,s)}if(s&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&Bi(e,r!==null?r.cachePool:null),r!==null?Ff(e,r):Ic(),S0(e);else return e.lanes=e.childLanes=536870912,dh(t,e,r!==null?r.baseLanes|s:s,s)}else r!==null?(Bi(e,r.cachePool),Ff(e,r),Ts(),e.memoizedState=null):(t!==null&&Bi(e,null),Ic(),Ts());return Be(t,e,a,s),e.child}function dh(t,e,s,n){var a=cd();return a=a===null?null:{parent:Oe._currentValue,pool:a},e.memoizedState={baseLanes:s,cachePool:a},t!==null&&Bi(e,null),Ic(),S0(e),t!==null&&Qr(t,e,n,!0),null}function Pi(t,e){var s=e.ref;if(s===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(k(284));(t===null||t.ref!==s)&&(e.flags|=4194816)}}function Fc(t,e,s,n,a){return pn(e),s=hd(t,e,s,n,void 0,a),n=md(),t!==null&&!Ue?(gd(t,e,a),hs(t,e,a)):(se&&n&&id(e),e.flags|=1,Be(t,e,s,a),e.child)}function fh(t,e,s,n,a,r){return pn(e),e.updateQueue=null,s=Xg(e,n,s,a),Pg(t),n=md(),t!==null&&!Ue?(gd(t,e,r),hs(t,e,r)):(se&&n&&id(e),e.flags|=1,Be(t,e,s,r),e.child)}function hh(t,e,s,n,a){if(pn(e),e.stateNode===null){var r=Fn,i=s.contextType;typeof i=="object"&&i!==null&&(r=Ve(i)),r=new s(n,r),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=Kc,e.stateNode=r,r._reactInternals=e,r=e.stateNode,r.props=n,r.state=e.memoizedState,r.refs={},ud(e),i=s.contextType,r.context=typeof i=="object"&&i!==null?Ve(i):Fn,r.state=e.memoizedState,i=s.getDerivedStateFromProps,typeof i=="function"&&(Go(e,s,i,n),r.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(i=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),i!==r.state&&Kc.enqueueReplaceState(r,r.state,null),hr(e,n,r,a),fr(),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308),n=!0}else if(t===null){r=e.stateNode;var l=e.memoizedProps,c=yn(s,l);r.props=c;var u=r.context,d=s.contextType;i=Fn,typeof d=="object"&&d!==null&&(i=Ve(d));var f=s.getDerivedStateFromProps;d=typeof f=="function"||typeof r.getSnapshotBeforeUpdate=="function",l=e.pendingProps!==l,d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l||u!==i)&&lh(e,r,n,i),Ns=!1;var h=e.memoizedState;r.state=h,hr(e,n,r,a),fr(),u=e.memoizedState,l||h!==u||Ns?(typeof f=="function"&&(Go(e,s,f,n),u=e.memoizedState),(c=Ns||ih(e,s,c,n,h,u,i))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),r.props=n,r.state=u,r.context=i,n=c):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{r=e.stateNode,Xc(t,e),i=e.memoizedProps,d=yn(s,i),r.props=d,f=e.pendingProps,h=r.context,u=s.contextType,c=Fn,typeof u=="object"&&u!==null&&(c=Ve(u)),l=s.getDerivedStateFromProps,(u=typeof l=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(i!==f||h!==c)&&lh(e,r,n,c),Ns=!1,h=e.memoizedState,r.state=h,hr(e,n,r,a),fr();var m=e.memoizedState;i!==f||h!==m||Ns||t!==null&&t.dependencies!==null&&fl(t.dependencies)?(typeof l=="function"&&(Go(e,s,l,n),m=e.memoizedState),(d=Ns||ih(e,s,d,n,h,m,c)||t!==null&&t.dependencies!==null&&fl(t.dependencies))?(u||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(n,m,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(n,m,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||i===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),r.props=n,r.state=m,r.context=c,n=d):(typeof r.componentDidUpdate!="function"||i===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||i===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return r=n,Pi(t,e),n=(e.flags&128)!==0,r||n?(r=e.stateNode,s=n&&typeof s.getDerivedStateFromError!="function"?null:r.render(),e.flags|=1,t!==null&&n?(e.child=ba(e,t.child,null,a),e.child=ba(e,null,s,a)):Be(t,e,s,a),e.memoizedState=r.state,t=e.child):t=hs(t,e,a),t}function mh(t,e,s,n){return Vr(),e.flags|=256,Be(t,e,s,n),e.child}var Po={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xo(t){return{baseLanes:t,cachePool:zg()}}function Yo(t,e,s){return t=t!==null?t.childLanes&~s:0,e&&(t|=At),t}function k0(t,e,s){var n=e.pendingProps,a=!1,r=(e.flags&128)!==0,i;if((i=r)||(i=t!==null&&t.memoizedState===null?!1:(Re.current&2)!==0),i&&(a=!0,e.flags&=-129),i=(e.flags&32)!==0,e.flags&=-33,t===null){if(se){if(a?As(e):Ts(),se){var l=be,c;if(c=l){e:{for(c=l,l=Ht;c.nodeType!==8;){if(!l){l=null;break e}if(c=Ut(c.nextSibling),c===null){l=null;break e}}l=c}l!==null?(e.memoizedState={dehydrated:l,treeContext:un!==null?{id:rs,overflow:is}:null,retryLane:536870912,hydrationErrors:null},c=ht(18,null,null,0),c.stateNode=l,c.return=e,e.child=c,Je=e,be=null,c=!0):c=!1}c||gn(e)}if(l=e.memoizedState,l!==null&&(l=l.dehydrated,l!==null))return fu(l)?e.lanes=32:e.lanes=536870912,null;os(e)}return l=n.children,n=n.fallback,a?(Ts(),a=e.mode,l=_l({mode:"hidden",children:l},a),n=cn(n,a,s,null),l.return=e,n.return=e,l.sibling=n,e.child=l,a=e.child,a.memoizedState=Xo(s),a.childLanes=Yo(t,i,s),e.memoizedState=Po,n):(As(e),Wc(e,l))}if(c=t.memoizedState,c!==null&&(l=c.dehydrated,l!==null)){if(r)e.flags&256?(As(e),e.flags&=-257,e=Io(t,e,s)):e.memoizedState!==null?(Ts(),e.child=t.child,e.flags|=128,e=null):(Ts(),a=n.fallback,l=e.mode,n=_l({mode:"visible",children:n.children},l),a=cn(a,l,s,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,ba(e,t.child,null,s),n=e.child,n.memoizedState=Xo(s),n.childLanes=Yo(t,i,s),e.memoizedState=Po,e=a);else if(As(e),fu(l)){if(i=l.nextSibling&&l.nextSibling.dataset,i)var u=i.dgst;i=u,n=Error(k(419)),n.stack="",n.digest=i,Or({value:n,source:null,stack:null}),e=Io(t,e,s)}else if(Ue||Qr(t,e,s,!1),i=(s&t.childLanes)!==0,Ue||i){if(i=ue,i!==null&&(n=s&-s,n=n&42?1:Qu(n),n=n&(i.suspendedLanes|s)?0:n,n!==0&&n!==c.retryLane))throw c.retryLane=n,Ea(t,n),bt(i,t,n),O0;l.data==="$?"||ru(),e=Io(t,e,s)}else l.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,be=Ut(l.nextSibling),Je=e,se=!0,dn=null,Ht=!1,t!==null&&(St[jt++]=rs,St[jt++]=is,St[jt++]=un,rs=t.id,is=t.overflow,un=e),e=Wc(e,n.children),e.flags|=4096);return e}return a?(Ts(),a=n.fallback,l=e.mode,c=t.child,u=c.sibling,n=cs(c,{mode:"hidden",children:n.children}),n.subtreeFlags=c.subtreeFlags&65011712,u!==null?a=cs(u,a):(a=cn(a,l,s,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,l=t.child.memoizedState,l===null?l=Xo(s):(c=l.cachePool,c!==null?(u=Oe._currentValue,c=c.parent!==u?{parent:u,pool:u}:c):c=zg(),l={baseLanes:l.baseLanes|s,cachePool:c}),a.memoizedState=l,a.childLanes=Yo(t,i,s),e.memoizedState=Po,n):(As(e),s=t.child,t=s.sibling,s=cs(s,{mode:"visible",children:n.children}),s.return=e,s.sibling=null,t!==null&&(i=e.deletions,i===null?(e.deletions=[t],e.flags|=16):i.push(t)),e.child=s,e.memoizedState=null,s)}function Wc(t,e){return e=_l({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function _l(t,e){return t=ht(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function Io(t,e,s){return ba(e,t.child,null,s),t=Wc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function gh(t,e,s){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Bc(t.return,e,s)}function Vo(t,e,s,n,a){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:a}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=s,r.tailMode=a)}function D0(t,e,s){var n=e.pendingProps,a=n.revealOrder,r=n.tail;if(Be(t,e,n.children,s),n=Re.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&gh(t,s,e);else if(t.tag===19)gh(t,s,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}switch(ge(Re,n),a){case"forwards":for(s=e.child,a=null;s!==null;)t=s.alternate,t!==null&&bl(t)===null&&(a=s),s=s.sibling;s=a,s===null?(a=e.child,e.child=null):(a=s.sibling,s.sibling=null),Vo(e,!1,a,s,r);break;case"backwards":for(s=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&bl(t)===null){e.child=a;break}t=a.sibling,a.sibling=s,s=a,a=t}Vo(e,!0,s,null,r);break;case"together":Vo(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function hs(t,e,s){if(t!==null&&(e.dependencies=t.dependencies),Ys|=e.lanes,!(s&e.childLanes))if(t!==null){if(Qr(t,e,s,!1),(s&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(k(153));if(e.child!==null){for(t=e.child,s=cs(t,t.pendingProps),e.child=s,s.return=e;t.sibling!==null;)t=t.sibling,s=s.sibling=cs(t,t.pendingProps),s.return=e;s.sibling=null}return e.child}function jd(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&fl(t)))}function R_(t,e,s){switch(e.tag){case 3:al(e,e.stateNode.containerInfo),Es(e,Oe,t.memoizedState.cache),Vr();break;case 27:case 5:Tc(e);break;case 4:al(e,e.stateNode.containerInfo);break;case 10:Es(e,e.type,e.memoizedProps.value);break;case 13:var n=e.memoizedState;if(n!==null)return n.dehydrated!==null?(As(e),e.flags|=128,null):s&e.child.childLanes?k0(t,e,s):(As(e),t=hs(t,e,s),t!==null?t.sibling:null);As(e);break;case 19:var a=(t.flags&128)!==0;if(n=(s&e.childLanes)!==0,n||(Qr(t,e,s,!1),n=(s&e.childLanes)!==0),a){if(n)return D0(t,e,s);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ge(Re,Re.current),n)break;return null;case 22:case 23:return e.lanes=0,C0(t,e,s);case 24:Es(e,Oe,t.memoizedState.cache)}return hs(t,e,s)}function M0(t,e,s){if(t!==null)if(t.memoizedProps!==e.pendingProps)Ue=!0;else{if(!jd(t,s)&&!(e.flags&128))return Ue=!1,R_(t,e,s);Ue=!!(t.flags&131072)}else Ue=!1,se&&e.flags&1048576&&Ug(e,dl,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var n=e.elementType,a=n._init;if(n=a(n._payload),e.type=n,typeof n=="function")rd(n)?(t=yn(n,t),e.tag=1,e=hh(null,e,n,t,s)):(e.tag=0,e=Fc(null,e,n,t,s));else{if(n!=null){if(a=n.$$typeof,a===Yu){e.tag=11,e=ch(null,e,n,t,s);break e}else if(a===Iu){e.tag=14,e=uh(null,e,n,t,s);break e}}throw e=Ec(n)||n,Error(k(306,e,""))}}return e;case 0:return Fc(t,e,e.type,e.pendingProps,s);case 1:return n=e.type,a=yn(n,e.pendingProps),hh(t,e,n,a,s);case 3:e:{if(al(e,e.stateNode.containerInfo),t===null)throw Error(k(387));n=e.pendingProps;var r=e.memoizedState;a=r.element,Xc(t,e),hr(e,n,null,s);var i=e.memoizedState;if(n=i.cache,Es(e,Oe,n),n!==r.cache&&Hc(e,[Oe],s,!0),fr(),n=i.element,r.isDehydrated)if(r={element:n,isDehydrated:!1,cache:i.cache},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){e=mh(t,e,n,s);break e}else if(n!==a){a=Et(Error(k(424)),e),Or(a),e=mh(t,e,n,s);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(be=Ut(t.firstChild),Je=e,se=!0,dn=null,Ht=!0,s=w0(e,null,n,s),e.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if(Vr(),n===a){e=hs(t,e,s);break e}Be(t,e,n,s)}e=e.child}return e;case 26:return Pi(t,e),t===null?(s=kh(e.type,null,e.pendingProps,null))?e.memoizedState=s:se||(s=e.type,t=e.pendingProps,n=Al($s.current).createElement(s),n[Ie]=e,n[at]=t,Pe(n,s,t),$e(n),e.stateNode=n):e.memoizedState=kh(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return Tc(e),t===null&&se&&(n=e.stateNode=_p(e.type,e.pendingProps,$s.current),Je=e,Ht=!0,a=be,Vs(e.type)?(hu=a,be=Ut(n.firstChild)):be=a),Be(t,e,e.pendingProps.children,s),Pi(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&se&&((a=n=be)&&(n=ax(n,e.type,e.pendingProps,Ht),n!==null?(e.stateNode=n,Je=e,be=Ut(n.firstChild),Ht=!1,a=!0):a=!1),a||gn(e)),Tc(e),a=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,n=r.children,uu(a,r)?n=null:i!==null&&uu(a,i)&&(e.flags|=32),e.memoizedState!==null&&(a=hd(t,e,w_,null,null,s),$r._currentValue=a),Pi(t,e),Be(t,e,n,s),e.child;case 6:return t===null&&se&&((t=s=be)&&(s=rx(s,e.pendingProps,Ht),s!==null?(e.stateNode=s,Je=e,be=null,t=!0):t=!1),t||gn(e)),null;case 13:return k0(t,e,s);case 4:return al(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=ba(e,null,n,s):Be(t,e,n,s),e.child;case 11:return ch(t,e,e.type,e.pendingProps,s);case 7:return Be(t,e,e.pendingProps,s),e.child;case 8:return Be(t,e,e.pendingProps.children,s),e.child;case 12:return Be(t,e,e.pendingProps.children,s),e.child;case 10:return n=e.pendingProps,Es(e,e.type,n.value),Be(t,e,n.children,s),e.child;case 9:return a=e.type._context,n=e.pendingProps.children,pn(e),a=Ve(a),n=n(a),e.flags|=1,Be(t,e,n,s),e.child;case 14:return uh(t,e,e.type,e.pendingProps,s);case 15:return R0(t,e,e.type,e.pendingProps,s);case 19:return D0(t,e,s);case 31:return n=e.pendingProps,s=e.mode,n={mode:n.mode,children:n.children},t===null?(s=_l(n,s),s.ref=e.ref,e.child=s,s.return=e,e=s):(s=cs(t.child,n),s.ref=e.ref,e.child=s,s.return=e,e=s),e;case 22:return C0(t,e,s);case 24:return pn(e),n=Ve(Oe),t===null?(a=cd(),a===null&&(a=ue,r=od(),a.pooledCache=r,r.refCount++,r!==null&&(a.pooledCacheLanes|=s),a=r),e.memoizedState={parent:n,cache:a},ud(e),Es(e,Oe,a)):(t.lanes&s&&(Xc(t,e),hr(e,null,null,s),fr()),a=t.memoizedState,r=e.memoizedState,a.parent!==n?(a={parent:n,cache:n},e.memoizedState=a,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=a),Es(e,Oe,n)):(n=r.cache,Es(e,Oe,n),n!==a.cache&&Hc(e,[Oe],s,!0))),Be(t,e,e.pendingProps.children,s),e.child;case 29:throw e.pendingProps}throw Error(k(156,e.tag))}function Kt(t){t.flags|=4}function ph(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!Sp(e)){if(e=Rt.current,e!==null&&((te&4194048)===te?It!==null:(te&62914560)!==te&&!(te&536870912)||e!==It))throw ur=Pc,Lg;t.flags|=8192}}function _i(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?ig():536870912,t.lanes|=e,ya|=e)}function Ba(t,e){if(!se)switch(t.tailMode){case"hidden":e=t.tail;for(var s=null;e!==null;)e.alternate!==null&&(s=e),e=e.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function pe(t){var e=t.alternate!==null&&t.alternate.child===t.child,s=0,n=0;if(e)for(var a=t.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags&65011712,n|=a.flags&65011712,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)s|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=s,e}function C_(t,e,s){var n=e.pendingProps;switch(ld(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pe(e),null;case 1:return pe(e),null;case 3:return s=e.stateNode,n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),us(Oe),da(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(za(e)?Kt(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,If())),pe(e),null;case 26:return s=e.memoizedState,t===null?(Kt(e),s!==null?(pe(e),ph(e,s)):(pe(e),e.flags&=-16777217)):s?s!==t.memoizedState?(Kt(e),pe(e),ph(e,s)):(pe(e),e.flags&=-16777217):(t.memoizedProps!==n&&Kt(e),pe(e),e.flags&=-16777217),null;case 27:rl(e),s=$s.current;var a=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==n&&Kt(e);else{if(!n){if(e.stateNode===null)throw Error(k(166));return pe(e),null}t=Xt.current,za(e)?Xf(e):(t=_p(a,n,s),e.stateNode=t,Kt(e))}return pe(e),null;case 5:if(rl(e),s=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==n&&Kt(e);else{if(!n){if(e.stateNode===null)throw Error(k(166));return pe(e),null}if(t=Xt.current,za(e))Xf(e);else{switch(a=Al($s.current),t){case 1:t=a.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:t=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":t=a.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":t=a.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof n.is=="string"?a.createElement("select",{is:n.is}):a.createElement("select"),n.multiple?t.multiple=!0:n.size&&(t.size=n.size);break;default:t=typeof n.is=="string"?a.createElement(s,{is:n.is}):a.createElement(s)}}t[Ie]=e,t[at]=n;e:for(a=e.child;a!==null;){if(a.tag===5||a.tag===6)t.appendChild(a.stateNode);else if(a.tag!==4&&a.tag!==27&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;a.sibling===null;){if(a.return===null||a.return===e)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}e.stateNode=t;e:switch(Pe(t,s,n),s){case"button":case"input":case"select":case"textarea":t=!!n.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&Kt(e)}}return pe(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==n&&Kt(e);else{if(typeof n!="string"&&e.stateNode===null)throw Error(k(166));if(t=$s.current,za(e)){if(t=e.stateNode,s=e.memoizedProps,n=null,a=Je,a!==null)switch(a.tag){case 27:case 5:n=a.memoizedProps}t[Ie]=e,t=!!(t.nodeValue===s||n!==null&&n.suppressHydrationWarning===!0||bp(t.nodeValue,s)),t||gn(e)}else t=Al(t).createTextNode(n),t[Ie]=e,e.stateNode=t}return pe(e),null;case 13:if(n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(a=za(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(k(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(k(317));a[Ie]=e}else Vr(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pe(e),a=!1}else a=If(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=a),a=!0;if(!a)return e.flags&256?(os(e),e):(os(e),null)}if(os(e),e.flags&128)return e.lanes=s,e;if(s=n!==null,t=t!==null&&t.memoizedState!==null,s){n=e.child,a=null,n.alternate!==null&&n.alternate.memoizedState!==null&&n.alternate.memoizedState.cachePool!==null&&(a=n.alternate.memoizedState.cachePool.pool);var r=null;n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),r!==a&&(n.flags|=2048)}return s!==t&&s&&(e.child.flags|=8192),_i(e,e.updateQueue),pe(e),null;case 4:return da(),t===null&&kd(e.stateNode.containerInfo),pe(e),null;case 10:return us(e.type),pe(e),null;case 19:if(qe(Re),a=e.memoizedState,a===null)return pe(e),null;if(n=(e.flags&128)!==0,r=a.rendering,r===null)if(n)Ba(a,!1);else{if(ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=bl(t),r!==null){for(e.flags|=128,Ba(a,!1),t=r.updateQueue,e.updateQueue=t,_i(e,t),e.subtreeFlags=0,t=s,s=e.child;s!==null;)$g(s,t),s=s.sibling;return ge(Re,Re.current&1|2),e.child}t=t.sibling}a.tail!==null&&Yt()>wl&&(e.flags|=128,n=!0,Ba(a,!1),e.lanes=4194304)}else{if(!n)if(t=bl(r),t!==null){if(e.flags|=128,n=!0,t=t.updateQueue,e.updateQueue=t,_i(e,t),Ba(a,!0),a.tail===null&&a.tailMode==="hidden"&&!r.alternate&&!se)return pe(e),null}else 2*Yt()-a.renderingStartTime>wl&&s!==536870912&&(e.flags|=128,n=!0,Ba(a,!1),e.lanes=4194304);a.isBackwards?(r.sibling=e.child,e.child=r):(t=a.last,t!==null?t.sibling=r:e.child=r,a.last=r)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Yt(),e.sibling=null,t=Re.current,ge(Re,n?t&1|2:t&1),e):(pe(e),null);case 22:case 23:return os(e),dd(),n=e.memoizedState!==null,t!==null?t.memoizedState!==null!==n&&(e.flags|=8192):n&&(e.flags|=8192),n?s&536870912&&!(e.flags&128)&&(pe(e),e.subtreeFlags&6&&(e.flags|=8192)):pe(e),s=e.updateQueue,s!==null&&_i(e,s.retryQueue),s=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),n=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),n!==s&&(e.flags|=2048),t!==null&&qe(fn),null;case 24:return s=null,t!==null&&(s=t.memoizedState.cache),e.memoizedState.cache!==s&&(e.flags|=2048),us(Oe),pe(e),null;case 25:return null;case 30:return null}throw Error(k(156,e.tag))}function k_(t,e){switch(ld(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return us(Oe),da(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return rl(e),null;case 13:if(os(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(k(340));Vr()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return qe(Re),null;case 4:return da(),null;case 10:return us(e.type),null;case 22:case 23:return os(e),dd(),t!==null&&qe(fn),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return us(Oe),null;case 25:return null;default:return null}}function $0(t,e){switch(ld(e),e.tag){case 3:us(Oe),da();break;case 26:case 27:case 5:rl(e);break;case 4:da();break;case 13:os(e);break;case 19:qe(Re);break;case 10:us(e.type);break;case 22:case 23:os(e),dd(),t!==null&&qe(fn);break;case 24:us(Oe)}}function Wr(t,e){try{var s=e.updateQueue,n=s!==null?s.lastEffect:null;if(n!==null){var a=n.next;s=a;do{if((s.tag&t)===t){n=void 0;var r=s.create,i=s.inst;n=r(),i.destroy=n}s=s.next}while(s!==a)}}catch(l){oe(e,e.return,l)}}function Xs(t,e,s){try{var n=e.updateQueue,a=n!==null?n.lastEffect:null;if(a!==null){var r=a.next;n=r;do{if((n.tag&t)===t){var i=n.inst,l=i.destroy;if(l!==void 0){i.destroy=void 0,a=e;var c=s,u=l;try{u()}catch(d){oe(a,c,d)}}}n=n.next}while(n!==r)}}catch(d){oe(e,e.return,d)}}function U0(t){var e=t.updateQueue;if(e!==null){var s=t.stateNode;try{Gg(e,s)}catch(n){oe(t,t.return,n)}}}function q0(t,e,s){s.props=yn(t.type,t.memoizedProps),s.state=t.memoizedState;try{s.componentWillUnmount()}catch(n){oe(t,e,n)}}function gr(t,e){try{var s=t.ref;if(s!==null){switch(t.tag){case 26:case 27:case 5:var n=t.stateNode;break;case 30:n=t.stateNode;break;default:n=t.stateNode}typeof s=="function"?t.refCleanup=s(n):s.current=n}}catch(a){oe(t,e,a)}}function Gt(t,e){var s=t.ref,n=t.refCleanup;if(s!==null)if(typeof n=="function")try{n()}catch(a){oe(t,e,a)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(a){oe(t,e,a)}else s.current=null}function z0(t){var e=t.type,s=t.memoizedProps,n=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":s.autoFocus&&n.focus();break e;case"img":s.src?n.src=s.src:s.srcSet&&(n.srcset=s.srcSet)}}catch(a){oe(t,t.return,a)}}function Qo(t,e,s){try{var n=t.stateNode;W_(n,t.type,s,e),n[at]=e}catch(a){oe(t,t.return,a)}}function L0(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Vs(t.type)||t.tag===4}function Jo(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||L0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Vs(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function eu(t,e,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(t,e):(e=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,e.appendChild(t),s=s._reactRootContainer,s!=null||e.onclick!==null||(e.onclick=ro));else if(n!==4&&(n===27&&Vs(t.type)&&(s=t.stateNode,e=null),t=t.child,t!==null))for(eu(t,e,s),t=t.sibling;t!==null;)eu(t,e,s),t=t.sibling}function xl(t,e,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?s.insertBefore(t,e):s.appendChild(t);else if(n!==4&&(n===27&&Vs(t.type)&&(s=t.stateNode),t=t.child,t!==null))for(xl(t,e,s),t=t.sibling;t!==null;)xl(t,e,s),t=t.sibling}function B0(t){var e=t.stateNode,s=t.memoizedProps;try{for(var n=t.type,a=e.attributes;a.length;)e.removeAttributeNode(a[0]);Pe(e,n,s),e[Ie]=t,e[at]=s}catch(r){oe(t,t.return,r)}}var ns=!1,xe=!1,Ko=!1,bh=typeof WeakSet=="function"?WeakSet:Set,Me=null;function D_(t,e){if(t=t.containerInfo,ou=Cl,t=Ag(t),sd(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var a=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{s.nodeType,r.nodeType}catch{s=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=t,h=null;t:for(;;){for(var m;f!==s||a!==0&&f.nodeType!==3||(l=i+a),f!==r||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===s&&++u===a&&(l=i),h===r&&++d===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}s=l===-1||c===-1?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(cu={focusedElem:t,selectionRange:s},Cl=!1,Me=e;Me!==null;)if(e=Me,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,Me=t;else for(;Me!==null;){switch(e=Me,r=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&r!==null){t=void 0,s=e,a=r.memoizedProps,r=r.memoizedState,n=s.stateNode;try{var x=yn(s.type,a,s.elementType===s.type);t=n.getSnapshotBeforeUpdate(x,r),n.__reactInternalSnapshotBeforeUpdate=t}catch(w){oe(s,s.return,w)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,s=t.nodeType,s===9)du(t);else if(s===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":du(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(k(163))}if(t=e.sibling,t!==null){t.return=e.return,Me=t;break}Me=e.return}}function H0(t,e,s){var n=s.flags;switch(s.tag){case 0:case 11:case 15:ys(t,s),n&4&&Wr(5,s);break;case 1:if(ys(t,s),n&4)if(t=s.stateNode,e===null)try{t.componentDidMount()}catch(i){oe(s,s.return,i)}else{var a=yn(s.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(a,e,t.__reactInternalSnapshotBeforeUpdate)}catch(i){oe(s,s.return,i)}}n&64&&U0(s),n&512&&gr(s,s.return);break;case 3:if(ys(t,s),n&64&&(t=s.updateQueue,t!==null)){if(e=null,s.child!==null)switch(s.child.tag){case 27:case 5:e=s.child.stateNode;break;case 1:e=s.child.stateNode}try{Gg(t,e)}catch(i){oe(s,s.return,i)}}break;case 27:e===null&&n&4&&B0(s);case 26:case 5:ys(t,s),e===null&&n&4&&z0(s),n&512&&gr(s,s.return);break;case 12:ys(t,s);break;case 13:ys(t,s),n&4&&X0(t,s),n&64&&(t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(s=G_.bind(null,s),ix(t,s))));break;case 22:if(n=s.memoizedState!==null||ns,!n){e=e!==null&&e.memoizedState!==null||xe,a=ns;var r=xe;ns=n,(xe=e)&&!r?ws(t,s,(s.subtreeFlags&8772)!==0):ys(t,s),ns=a,xe=r}break;case 30:break;default:ys(t,s)}}function G0(t){var e=t.alternate;e!==null&&(t.alternate=null,G0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&Ku(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var he=null,et=!1;function Zt(t,e,s){for(s=s.child;s!==null;)P0(t,e,s),s=s.sibling}function P0(t,e,s){if(mt&&typeof mt.onCommitFiberUnmount=="function")try{mt.onCommitFiberUnmount(Gr,s)}catch{}switch(s.tag){case 26:xe||Gt(s,e),Zt(t,e,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:xe||Gt(s,e);var n=he,a=et;Vs(s.type)&&(he=s.stateNode,et=!1),Zt(t,e,s),vr(s.stateNode),he=n,et=a;break;case 5:xe||Gt(s,e);case 6:if(n=he,a=et,he=null,Zt(t,e,s),he=n,et=a,he!==null)if(et)try{(he.nodeType===9?he.body:he.nodeName==="HTML"?he.ownerDocument.body:he).removeChild(s.stateNode)}catch(r){oe(s,e,r)}else try{he.removeChild(s.stateNode)}catch(r){oe(s,e,r)}break;case 18:he!==null&&(et?(t=he,Oh(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,s.stateNode),zr(t)):Oh(he,s.stateNode));break;case 4:n=he,a=et,he=s.stateNode.containerInfo,et=!0,Zt(t,e,s),he=n,et=a;break;case 0:case 11:case 14:case 15:xe||Xs(2,s,e),xe||Xs(4,s,e),Zt(t,e,s);break;case 1:xe||(Gt(s,e),n=s.stateNode,typeof n.componentWillUnmount=="function"&&q0(s,e,n)),Zt(t,e,s);break;case 21:Zt(t,e,s);break;case 22:xe=(n=xe)||s.memoizedState!==null,Zt(t,e,s),xe=n;break;default:Zt(t,e,s)}}function X0(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{zr(t)}catch(s){oe(e,e.return,s)}}function M_(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new bh),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new bh),e;default:throw Error(k(435,t.tag))}}function Zo(t,e){var s=M_(t);e.forEach(function(n){var a=P_.bind(null,t,n);s.has(n)||(s.add(n),n.then(a,a))})}function lt(t,e){var s=e.deletions;if(s!==null)for(var n=0;n<s.length;n++){var a=s[n],r=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 27:if(Vs(l.type)){he=l.stateNode,et=!1;break e}break;case 5:he=l.stateNode,et=!1;break e;case 3:case 4:he=l.stateNode.containerInfo,et=!0;break e}l=l.return}if(he===null)throw Error(k(160));P0(r,i,a),he=null,et=!1,r=a.alternate,r!==null&&(r.return=null),a.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)Y0(e,t),e=e.sibling}var Mt=null;function Y0(t,e){var s=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:lt(e,t),ot(t),n&4&&(Xs(3,t,t.return),Wr(3,t),Xs(5,t,t.return));break;case 1:lt(e,t),ot(t),n&512&&(xe||s===null||Gt(s,s.return)),n&64&&ns&&(t=t.updateQueue,t!==null&&(n=t.callbacks,n!==null&&(s=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=s===null?n:s.concat(n))));break;case 26:var a=Mt;if(lt(e,t),ot(t),n&512&&(xe||s===null||Gt(s,s.return)),n&4){var r=s!==null?s.memoizedState:null;if(n=t.memoizedState,s===null)if(n===null)if(t.stateNode===null){e:{n=t.type,s=t.memoizedProps,a=a.ownerDocument||a;t:switch(n){case"title":r=a.getElementsByTagName("title")[0],(!r||r[Yr]||r[Ie]||r.namespaceURI==="http://www.w3.org/2000/svg"||r.hasAttribute("itemprop"))&&(r=a.createElement(n),a.head.insertBefore(r,a.querySelector("head > title"))),Pe(r,n,s),r[Ie]=t,$e(r),n=r;break e;case"link":var i=Mh("link","href",a).get(n+(s.href||""));if(i){for(var l=0;l<i.length;l++)if(r=i[l],r.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&r.getAttribute("rel")===(s.rel==null?null:s.rel)&&r.getAttribute("title")===(s.title==null?null:s.title)&&r.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){i.splice(l,1);break t}}r=a.createElement(n),Pe(r,n,s),a.head.appendChild(r);break;case"meta":if(i=Mh("meta","content",a).get(n+(s.content||""))){for(l=0;l<i.length;l++)if(r=i[l],r.getAttribute("content")===(s.content==null?null:""+s.content)&&r.getAttribute("name")===(s.name==null?null:s.name)&&r.getAttribute("property")===(s.property==null?null:s.property)&&r.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&r.getAttribute("charset")===(s.charSet==null?null:s.charSet)){i.splice(l,1);break t}}r=a.createElement(n),Pe(r,n,s),a.head.appendChild(r);break;default:throw Error(k(468,n))}r[Ie]=t,$e(r),n=r}t.stateNode=n}else $h(a,t.type,t.stateNode);else t.stateNode=Dh(a,n,t.memoizedProps);else r!==n?(r===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):r.count--,n===null?$h(a,t.type,t.stateNode):Dh(a,n,t.memoizedProps)):n===null&&t.stateNode!==null&&Qo(t,t.memoizedProps,s.memoizedProps)}break;case 27:lt(e,t),ot(t),n&512&&(xe||s===null||Gt(s,s.return)),s!==null&&n&4&&Qo(t,t.memoizedProps,s.memoizedProps);break;case 5:if(lt(e,t),ot(t),n&512&&(xe||s===null||Gt(s,s.return)),t.flags&32){a=t.stateNode;try{ha(a,"")}catch(m){oe(t,t.return,m)}}n&4&&t.stateNode!=null&&(a=t.memoizedProps,Qo(t,a,s!==null?s.memoizedProps:a)),n&1024&&(Ko=!0);break;case 6:if(lt(e,t),ot(t),n&4){if(t.stateNode===null)throw Error(k(162));n=t.memoizedProps,s=t.stateNode;try{s.nodeValue=n}catch(m){oe(t,t.return,m)}}break;case 3:if(Ii=null,a=Mt,Mt=Tl(e.containerInfo),lt(e,t),Mt=a,ot(t),n&4&&s!==null&&s.memoizedState.isDehydrated)try{zr(e.containerInfo)}catch(m){oe(t,t.return,m)}Ko&&(Ko=!1,I0(t));break;case 4:n=Mt,Mt=Tl(t.stateNode.containerInfo),lt(e,t),ot(t),Mt=n;break;case 12:lt(e,t),ot(t);break;case 13:lt(e,t),ot(t),t.child.flags&8192&&t.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(Od=Yt()),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,Zo(t,n)));break;case 22:a=t.memoizedState!==null;var c=s!==null&&s.memoizedState!==null,u=ns,d=xe;if(ns=u||a,xe=d||c,lt(e,t),xe=d,ns=u,ot(t),n&8192)e:for(e=t.stateNode,e._visibility=a?e._visibility&-2:e._visibility|1,a&&(s===null||c||ns||xe||en(t)),s=null,e=t;;){if(e.tag===5||e.tag===26){if(s===null){c=s=e;try{if(r=c.stateNode,a)i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none";else{l=c.stateNode;var f=c.memoizedProps.style,h=f!=null&&f.hasOwnProperty("display")?f.display:null;l.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}}catch(m){oe(c,c.return,m)}}}else if(e.tag===6){if(s===null){c=e;try{c.stateNode.nodeValue=a?"":c.memoizedProps}catch(m){oe(c,c.return,m)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;s===e&&(s=null),e=e.return}s===e&&(s=null),e.sibling.return=e.return,e=e.sibling}n&4&&(n=t.updateQueue,n!==null&&(s=n.retryQueue,s!==null&&(n.retryQueue=null,Zo(t,s))));break;case 19:lt(e,t),ot(t),n&4&&(n=t.updateQueue,n!==null&&(t.updateQueue=null,Zo(t,n)));break;case 30:break;case 21:break;default:lt(e,t),ot(t)}}function ot(t){var e=t.flags;if(e&2){try{for(var s,n=t.return;n!==null;){if(L0(n)){s=n;break}n=n.return}if(s==null)throw Error(k(160));switch(s.tag){case 27:var a=s.stateNode,r=Jo(t);xl(t,r,a);break;case 5:var i=s.stateNode;s.flags&32&&(ha(i,""),s.flags&=-33);var l=Jo(t);xl(t,l,i);break;case 3:case 4:var c=s.stateNode.containerInfo,u=Jo(t);eu(t,u,c);break;default:throw Error(k(161))}}catch(d){oe(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function I0(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;I0(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function ys(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)H0(t,e.alternate,e),e=e.sibling}function en(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Xs(4,e,e.return),en(e);break;case 1:Gt(e,e.return);var s=e.stateNode;typeof s.componentWillUnmount=="function"&&q0(e,e.return,s),en(e);break;case 27:vr(e.stateNode);case 26:case 5:Gt(e,e.return),en(e);break;case 22:e.memoizedState===null&&en(e);break;case 30:en(e);break;default:en(e)}t=t.sibling}}function ws(t,e,s){for(s=s&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var n=e.alternate,a=t,r=e,i=r.flags;switch(r.tag){case 0:case 11:case 15:ws(a,r,s),Wr(4,r);break;case 1:if(ws(a,r,s),n=r,a=n.stateNode,typeof a.componentDidMount=="function")try{a.componentDidMount()}catch(u){oe(n,n.return,u)}if(n=r,a=n.updateQueue,a!==null){var l=n.stateNode;try{var c=a.shared.hiddenCallbacks;if(c!==null)for(a.shared.hiddenCallbacks=null,a=0;a<c.length;a++)Hg(c[a],l)}catch(u){oe(n,n.return,u)}}s&&i&64&&U0(r),gr(r,r.return);break;case 27:B0(r);case 26:case 5:ws(a,r,s),s&&n===null&&i&4&&z0(r),gr(r,r.return);break;case 12:ws(a,r,s);break;case 13:ws(a,r,s),s&&i&4&&X0(a,r);break;case 22:r.memoizedState===null&&ws(a,r,s),gr(r,r.return);break;case 30:break;default:ws(a,r,s)}e=e.sibling}}function Nd(t,e){var s=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==s&&(t!=null&&t.refCount++,s!=null&&Jr(s))}function Ed(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Jr(t))}function zt(t,e,s,n){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)V0(t,e,s,n),e=e.sibling}function V0(t,e,s,n){var a=e.flags;switch(e.tag){case 0:case 11:case 15:zt(t,e,s,n),a&2048&&Wr(9,e);break;case 1:zt(t,e,s,n);break;case 3:zt(t,e,s,n),a&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&Jr(t)));break;case 12:if(a&2048){zt(t,e,s,n),t=e.stateNode;try{var r=e.memoizedProps,i=r.id,l=r.onPostCommit;typeof l=="function"&&l(i,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){oe(e,e.return,c)}}else zt(t,e,s,n);break;case 13:zt(t,e,s,n);break;case 23:break;case 22:r=e.stateNode,i=e.alternate,e.memoizedState!==null?r._visibility&2?zt(t,e,s,n):pr(t,e):r._visibility&2?zt(t,e,s,n):(r._visibility|=2,qn(t,e,s,n,(e.subtreeFlags&10256)!==0)),a&2048&&Nd(i,e);break;case 24:zt(t,e,s,n),a&2048&&Ed(e.alternate,e);break;default:zt(t,e,s,n)}}function qn(t,e,s,n,a){for(a=a&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var r=t,i=e,l=s,c=n,u=i.flags;switch(i.tag){case 0:case 11:case 15:qn(r,i,l,c,a),Wr(8,i);break;case 23:break;case 22:var d=i.stateNode;i.memoizedState!==null?d._visibility&2?qn(r,i,l,c,a):pr(r,i):(d._visibility|=2,qn(r,i,l,c,a)),a&&u&2048&&Nd(i.alternate,i);break;case 24:qn(r,i,l,c,a),a&&u&2048&&Ed(i.alternate,i);break;default:qn(r,i,l,c,a)}e=e.sibling}}function pr(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var s=t,n=e,a=n.flags;switch(n.tag){case 22:pr(s,n),a&2048&&Nd(n.alternate,n);break;case 24:pr(s,n),a&2048&&Ed(n.alternate,n);break;default:pr(s,n)}e=e.sibling}}var Qa=8192;function Nn(t){if(t.subtreeFlags&Qa)for(t=t.child;t!==null;)Q0(t),t=t.sibling}function Q0(t){switch(t.tag){case 26:Nn(t),t.flags&Qa&&t.memoizedState!==null&&vx(Mt,t.memoizedState,t.memoizedProps);break;case 5:Nn(t);break;case 3:case 4:var e=Mt;Mt=Tl(t.stateNode.containerInfo),Nn(t),Mt=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=Qa,Qa=16777216,Nn(t),Qa=e):Nn(t));break;default:Nn(t)}}function J0(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function Ha(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var s=0;s<e.length;s++){var n=e[s];Me=n,Z0(n,t)}J0(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)K0(t),t=t.sibling}function K0(t){switch(t.tag){case 0:case 11:case 15:Ha(t),t.flags&2048&&Xs(9,t,t.return);break;case 3:Ha(t);break;case 12:Ha(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,Xi(t)):Ha(t);break;default:Ha(t)}}function Xi(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var s=0;s<e.length;s++){var n=e[s];Me=n,Z0(n,t)}J0(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:Xs(8,e,e.return),Xi(e);break;case 22:s=e.stateNode,s._visibility&2&&(s._visibility&=-3,Xi(e));break;default:Xi(e)}t=t.sibling}}function Z0(t,e){for(;Me!==null;){var s=Me;switch(s.tag){case 0:case 11:case 15:Xs(8,s,e);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var n=s.memoizedState.cachePool.pool;n!=null&&n.refCount++}break;case 24:Jr(s.memoizedState.cache)}if(n=s.child,n!==null)n.return=s,Me=n;else e:for(s=t;Me!==null;){n=Me;var a=n.sibling,r=n.return;if(G0(n),n===s){Me=null;break e}if(a!==null){a.return=r,Me=a;break e}Me=r}}}var $_={getCacheForType:function(t){var e=Ve(Oe),s=e.data.get(t);return s===void 0&&(s=t(),e.data.set(t,s)),s}},U_=typeof WeakMap=="function"?WeakMap:Map,re=0,ue=null,W=null,te=0,ae=0,ft=null,Ds=!1,Aa=!1,Ad=!1,ms=0,ye=0,Ys=0,hn=0,Td=0,At=0,ya=0,br=null,tt=null,tu=!1,Od=0,wl=1/0,Sl=null,zs=null,Ge=0,Ls=null,va=null,ua=0,su=0,nu=null,F0=null,yr=0,au=null;function pt(){if(re&2&&te!==0)return te&-te;if(I.T!==null){var t=ma;return t!==0?t:Cd()}return cg()}function W0(){At===0&&(At=!(te&536870912)||se?rg():536870912);var t=Rt.current;return t!==null&&(t.flags|=32),At}function bt(t,e,s){(t===ue&&(ae===2||ae===9)||t.cancelPendingCommit!==null)&&(_a(t,0),Ms(t,te,At,!1)),Xr(t,s),(!(re&2)||t!==ue)&&(t===ue&&(!(re&2)&&(hn|=s),ye===4&&Ms(t,te,At,!1)),Qt(t))}function ep(t,e,s){if(re&6)throw Error(k(327));var n=!s&&(e&124)===0&&(e&t.expiredLanes)===0||Pr(t,e),a=n?L_(t,e):Fo(t,e,!0),r=n;do{if(a===0){Aa&&!n&&Ms(t,e,0,!1);break}else{if(s=t.current.alternate,r&&!q_(s)){a=Fo(t,e,!1),r=!1;continue}if(a===2){if(r=e,t.errorRecoveryDisabledLanes&r)var i=0;else i=t.pendingLanes&-536870913,i=i!==0?i:i&536870912?536870912:0;if(i!==0){e=i;e:{var l=t;a=br;var c=l.current.memoizedState.isDehydrated;if(c&&(_a(l,i).flags|=256),i=Fo(l,i,!1),i!==2){if(Ad&&!c){l.errorRecoveryDisabledLanes|=r,hn|=r,a=4;break e}r=tt,tt=a,r!==null&&(tt===null?tt=r:tt.push.apply(tt,r))}a=i}if(r=!1,a!==2)continue}}if(a===1){_a(t,0),Ms(t,e,0,!0);break}e:{switch(n=t,r=a,r){case 0:case 1:throw Error(k(345));case 4:if((e&4194048)!==e)break;case 6:Ms(n,e,At,!Ds);break e;case 2:tt=null;break;case 3:case 5:break;default:throw Error(k(329))}if((e&62914560)===e&&(a=Od+300-Yt(),10<a)){if(Ms(n,e,At,!Ds),Il(n,0,!0)!==0)break e;n.timeoutHandle=vp(yh.bind(null,n,s,tt,Sl,tu,e,At,hn,ya,Ds,r,2,-0,0),a);break e}yh(n,s,tt,Sl,tu,e,At,hn,ya,Ds,r,0,-0,0)}}break}while(!0);Qt(t)}function yh(t,e,s,n,a,r,i,l,c,u,d,f,h,m){if(t.timeoutHandle=-1,f=e.subtreeFlags,(f&8192||(f&16785408)===16785408)&&(Mr={stylesheets:null,count:0,unsuspend:yx},Q0(e),f=_x(),f!==null)){t.cancelPendingCommit=f(_h.bind(null,t,e,r,s,n,a,i,l,c,d,1,h,m)),Ms(t,r,i,!u);return}_h(t,e,r,s,n,a,i,l,c)}function q_(t){for(var e=t;;){var s=e.tag;if((s===0||s===11||s===15)&&e.flags&16384&&(s=e.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var n=0;n<s.length;n++){var a=s[n],r=a.getSnapshot;a=a.value;try{if(!yt(r(),a))return!1}catch{return!1}}if(s=e.child,e.subtreeFlags&16384&&s!==null)s.return=e,e=s;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ms(t,e,s,n){e&=~Td,e&=~hn,t.suspendedLanes|=e,t.pingedLanes&=~e,n&&(t.warmLanes|=e),n=t.expirationTimes;for(var a=e;0<a;){var r=31-gt(a),i=1<<r;n[r]=-1,a&=~i}s!==0&&lg(t,s,e)}function so(){return re&6?!0:(ei(0),!1)}function Rd(){if(W!==null){if(ae===0)var t=W.return;else t=W,ls=Sn=null,pd(t),ca=null,Cr=0,t=W;for(;t!==null;)$0(t.alternate,t),t=t.return;W=null}}function _a(t,e){var s=t.timeoutHandle;s!==-1&&(t.timeoutHandle=-1,tx(s)),s=t.cancelPendingCommit,s!==null&&(t.cancelPendingCommit=null,s()),Rd(),ue=t,W=s=cs(t.current,null),te=e,ae=0,ft=null,Ds=!1,Aa=Pr(t,e),Ad=!1,ya=At=Td=hn=Ys=ye=0,tt=br=null,tu=!1,e&8&&(e|=e&32);var n=t.entangledLanes;if(n!==0)for(t=t.entanglements,n&=e;0<n;){var a=31-gt(n),r=1<<a;e|=t[a],n&=~r}return ms=e,Kl(),s}function tp(t,e){K=null,I.H=pl,e===Kr||e===Fl?(e=Kf(),ae=3):e===Lg?(e=Kf(),ae=4):ae=e===O0?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,ft=e,W===null&&(ye=1,vl(t,Et(e,t.current)))}function sp(){var t=I.H;return I.H=pl,t===null?pl:t}function np(){var t=I.A;return I.A=$_,t}function ru(){ye=4,Ds||(te&4194048)!==te&&Rt.current!==null||(Aa=!0),!(Ys&134217727)&&!(hn&134217727)||ue===null||Ms(ue,te,At,!1)}function Fo(t,e,s){var n=re;re|=2;var a=sp(),r=np();(ue!==t||te!==e)&&(Sl=null,_a(t,e)),e=!1;var i=ye;e:do try{if(ae!==0&&W!==null){var l=W,c=ft;switch(ae){case 8:Rd(),i=6;break e;case 3:case 2:case 9:case 6:Rt.current===null&&(e=!0);var u=ae;if(ae=0,ft=null,ta(t,l,c,u),s&&Aa){i=0;break e}break;default:u=ae,ae=0,ft=null,ta(t,l,c,u)}}z_(),i=ye;break}catch(d){tp(t,d)}while(!0);return e&&t.shellSuspendCounter++,ls=Sn=null,re=n,I.H=a,I.A=r,W===null&&(ue=null,te=0,Kl()),i}function z_(){for(;W!==null;)ap(W)}function L_(t,e){var s=re;re|=2;var n=sp(),a=np();ue!==t||te!==e?(Sl=null,wl=Yt()+500,_a(t,e)):Aa=Pr(t,e);e:do try{if(ae!==0&&W!==null){e=W;var r=ft;t:switch(ae){case 1:ae=0,ft=null,ta(t,e,r,1);break;case 2:case 9:if(Jf(r)){ae=0,ft=null,vh(e);break}e=function(){ae!==2&&ae!==9||ue!==t||(ae=7),Qt(t)},r.then(e,e);break e;case 3:ae=7;break e;case 4:ae=5;break e;case 7:Jf(r)?(ae=0,ft=null,vh(e)):(ae=0,ft=null,ta(t,e,r,7));break;case 5:var i=null;switch(W.tag){case 26:i=W.memoizedState;case 5:case 27:var l=W;if(!i||Sp(i)){ae=0,ft=null;var c=l.sibling;if(c!==null)W=c;else{var u=l.return;u!==null?(W=u,no(u)):W=null}break t}}ae=0,ft=null,ta(t,e,r,5);break;case 6:ae=0,ft=null,ta(t,e,r,6);break;case 8:Rd(),ye=6;break e;default:throw Error(k(462))}}B_();break}catch(d){tp(t,d)}while(!0);return ls=Sn=null,I.H=n,I.A=a,re=s,W!==null?0:(ue=null,te=0,Kl(),ye)}function B_(){for(;W!==null&&!ov();)ap(W)}function ap(t){var e=M0(t.alternate,t,ms);t.memoizedProps=t.pendingProps,e===null?no(t):W=e}function vh(t){var e=t,s=e.alternate;switch(e.tag){case 15:case 0:e=fh(s,e,e.pendingProps,e.type,void 0,te);break;case 11:e=fh(s,e,e.pendingProps,e.type.render,e.ref,te);break;case 5:pd(e);default:$0(s,e),e=W=$g(e,ms),e=M0(s,e,ms)}t.memoizedProps=t.pendingProps,e===null?no(t):W=e}function ta(t,e,s,n){ls=Sn=null,pd(e),ca=null,Cr=0;var a=e.return;try{if(O_(t,a,e,s,te)){ye=1,vl(t,Et(s,t.current)),W=null;return}}catch(r){if(a!==null)throw W=a,r;ye=1,vl(t,Et(s,t.current)),W=null;return}e.flags&32768?(se||n===1?t=!0:Aa||te&536870912?t=!1:(Ds=t=!0,(n===2||n===9||n===3||n===6)&&(n=Rt.current,n!==null&&n.tag===13&&(n.flags|=16384))),rp(e,t)):no(e)}function no(t){var e=t;do{if(e.flags&32768){rp(e,Ds);return}t=e.return;var s=C_(e.alternate,e,ms);if(s!==null){W=s;return}if(e=e.sibling,e!==null){W=e;return}W=e=t}while(e!==null);ye===0&&(ye=5)}function rp(t,e){do{var s=k_(t.alternate,t);if(s!==null){s.flags&=32767,W=s;return}if(s=t.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!e&&(t=t.sibling,t!==null)){W=t;return}W=t=s}while(t!==null);ye=6,W=null}function _h(t,e,s,n,a,r,i,l,c){t.cancelPendingCommit=null;do ao();while(Ge!==0);if(re&6)throw Error(k(327));if(e!==null){if(e===t.current)throw Error(k(177));if(r=e.lanes|e.childLanes,r|=nd,yv(t,s,r,i,l,c),t===ue&&(W=ue=null,te=0),va=e,Ls=t,ua=s,su=r,nu=a,F0=n,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,X_(il,function(){return up(),null})):(t.callbackNode=null,t.callbackPriority=0),n=(e.flags&13878)!==0,e.subtreeFlags&13878||n){n=I.T,I.T=null,a=ne.p,ne.p=2,i=re,re|=4;try{D_(t,e,s)}finally{re=i,ne.p=a,I.T=n}}Ge=1,ip(),lp(),op()}}function ip(){if(Ge===1){Ge=0;var t=Ls,e=va,s=(e.flags&13878)!==0;if(e.subtreeFlags&13878||s){s=I.T,I.T=null;var n=ne.p;ne.p=2;var a=re;re|=4;try{Y0(e,t);var r=cu,i=Ag(t.containerInfo),l=r.focusedElem,c=r.selectionRange;if(i!==l&&l&&l.ownerDocument&&Eg(l.ownerDocument.documentElement,l)){if(c!==null&&sd(l)){var u=c.start,d=c.end;if(d===void 0&&(d=u),"selectionStart"in l)l.selectionStart=u,l.selectionEnd=Math.min(d,l.value.length);else{var f=l.ownerDocument||document,h=f&&f.defaultView||window;if(h.getSelection){var m=h.getSelection(),x=l.textContent.length,w=Math.min(c.start,x),N=c.end===void 0?w:Math.min(c.end,x);!m.extend&&w>N&&(i=N,N=w,w=i);var y=Hf(l,w),g=Hf(l,N);if(y&&g&&(m.rangeCount!==1||m.anchorNode!==y.node||m.anchorOffset!==y.offset||m.focusNode!==g.node||m.focusOffset!==g.offset)){var p=f.createRange();p.setStart(y.node,y.offset),m.removeAllRanges(),w>N?(m.addRange(p),m.extend(g.node,g.offset)):(p.setEnd(g.node,g.offset),m.addRange(p))}}}}for(f=[],m=l;m=m.parentNode;)m.nodeType===1&&f.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<f.length;l++){var b=f[l];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}Cl=!!ou,cu=ou=null}finally{re=a,ne.p=n,I.T=s}}t.current=e,Ge=2}}function lp(){if(Ge===2){Ge=0;var t=Ls,e=va,s=(e.flags&8772)!==0;if(e.subtreeFlags&8772||s){s=I.T,I.T=null;var n=ne.p;ne.p=2;var a=re;re|=4;try{H0(t,e.alternate,e)}finally{re=a,ne.p=n,I.T=s}}Ge=3}}function op(){if(Ge===4||Ge===3){Ge=0,cv();var t=Ls,e=va,s=ua,n=F0;e.subtreeFlags&10256||e.flags&10256?Ge=5:(Ge=0,va=Ls=null,cp(t,t.pendingLanes));var a=t.pendingLanes;if(a===0&&(zs=null),Ju(s),e=e.stateNode,mt&&typeof mt.onCommitFiberRoot=="function")try{mt.onCommitFiberRoot(Gr,e,void 0,(e.current.flags&128)===128)}catch{}if(n!==null){e=I.T,a=ne.p,ne.p=2,I.T=null;try{for(var r=t.onRecoverableError,i=0;i<n.length;i++){var l=n[i];r(l.value,{componentStack:l.stack})}}finally{I.T=e,ne.p=a}}ua&3&&ao(),Qt(t),a=t.pendingLanes,s&4194090&&a&42?t===au?yr++:(yr=0,au=t):yr=0,ei(0)}}function cp(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,Jr(e)))}function ao(t){return ip(),lp(),op(),up()}function up(){if(Ge!==5)return!1;var t=Ls,e=su;su=0;var s=Ju(ua),n=I.T,a=ne.p;try{ne.p=32>s?32:s,I.T=null,s=nu,nu=null;var r=Ls,i=ua;if(Ge=0,va=Ls=null,ua=0,re&6)throw Error(k(331));var l=re;if(re|=4,K0(r.current),V0(r,r.current,i,s),re=l,ei(0,!1),mt&&typeof mt.onPostCommitFiberRoot=="function")try{mt.onPostCommitFiberRoot(Gr,r)}catch{}return!0}finally{ne.p=a,I.T=n,cp(t,e)}}function xh(t,e,s){e=Et(s,e),e=Zc(t.stateNode,e,2),t=qs(t,e,2),t!==null&&(Xr(t,2),Qt(t))}function oe(t,e,s){if(t.tag===3)xh(t,t,s);else for(;e!==null;){if(e.tag===3){xh(e,t,s);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zs===null||!zs.has(n))){t=Et(s,t),s=A0(2),n=qs(e,s,2),n!==null&&(T0(s,n,e,t),Xr(n,2),Qt(n));break}}e=e.return}}function Wo(t,e,s){var n=t.pingCache;if(n===null){n=t.pingCache=new U_;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(s)||(Ad=!0,a.add(s),t=H_.bind(null,t,e,s),e.then(t,t))}function H_(t,e,s){var n=t.pingCache;n!==null&&n.delete(e),t.pingedLanes|=t.suspendedLanes&s,t.warmLanes&=~s,ue===t&&(te&s)===s&&(ye===4||ye===3&&(te&62914560)===te&&300>Yt()-Od?!(re&2)&&_a(t,0):Td|=s,ya===te&&(ya=0)),Qt(t)}function dp(t,e){e===0&&(e=ig()),t=Ea(t,e),t!==null&&(Xr(t,e),Qt(t))}function G_(t){var e=t.memoizedState,s=0;e!==null&&(s=e.retryLane),dp(t,s)}function P_(t,e){var s=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(s=a.retryLane);break;case 19:n=t.stateNode;break;case 22:n=t.stateNode._retryCache;break;default:throw Error(k(314))}n!==null&&n.delete(e),dp(t,s)}function X_(t,e){return Vu(t,e)}var jl=null,zn=null,iu=!1,Nl=!1,ec=!1,mn=0;function Qt(t){t!==zn&&t.next===null&&(zn===null?jl=zn=t:zn=zn.next=t),Nl=!0,iu||(iu=!0,I_())}function ei(t,e){if(!ec&&Nl){ec=!0;do for(var s=!1,n=jl;n!==null;){if(t!==0){var a=n.pendingLanes;if(a===0)var r=0;else{var i=n.suspendedLanes,l=n.pingedLanes;r=(1<<31-gt(42|t)+1)-1,r&=a&~(i&~l),r=r&201326741?r&201326741|1:r?r|2:0}r!==0&&(s=!0,wh(n,r))}else r=te,r=Il(n,n===ue?r:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),!(r&3)||Pr(n,r)||(s=!0,wh(n,r));n=n.next}while(s);ec=!1}}function Y_(){fp()}function fp(){Nl=iu=!1;var t=0;mn!==0&&(ex()&&(t=mn),mn=0);for(var e=Yt(),s=null,n=jl;n!==null;){var a=n.next,r=hp(n,e);r===0?(n.next=null,s===null?jl=a:s.next=a,a===null&&(zn=s)):(s=n,(t!==0||r&3)&&(Nl=!0)),n=a}ei(t)}function hp(t,e){for(var s=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,r=t.pendingLanes&-62914561;0<r;){var i=31-gt(r),l=1<<i,c=a[i];c===-1?(!(l&s)||l&n)&&(a[i]=bv(l,e)):c<=e&&(t.expiredLanes|=l),r&=~l}if(e=ue,s=te,s=Il(t,t===e?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n=t.callbackNode,s===0||t===e&&(ae===2||ae===9)||t.cancelPendingCommit!==null)return n!==null&&n!==null&&Eo(n),t.callbackNode=null,t.callbackPriority=0;if(!(s&3)||Pr(t,s)){if(e=s&-s,e===t.callbackPriority)return e;switch(n!==null&&Eo(n),Ju(s)){case 2:case 8:s=ng;break;case 32:s=il;break;case 268435456:s=ag;break;default:s=il}return n=mp.bind(null,t),s=Vu(s,n),t.callbackPriority=e,t.callbackNode=s,e}return n!==null&&n!==null&&Eo(n),t.callbackPriority=2,t.callbackNode=null,2}function mp(t,e){if(Ge!==0&&Ge!==5)return t.callbackNode=null,t.callbackPriority=0,null;var s=t.callbackNode;if(ao()&&t.callbackNode!==s)return null;var n=te;return n=Il(t,t===ue?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),n===0?null:(ep(t,n,e),hp(t,Yt()),t.callbackNode!=null&&t.callbackNode===s?mp.bind(null,t):null)}function wh(t,e){if(ao())return null;ep(t,e,!0)}function I_(){sx(function(){re&6?Vu(sg,Y_):fp()})}function Cd(){return mn===0&&(mn=rg()),mn}function Sh(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Ui(""+t)}function jh(t,e){var s=e.ownerDocument.createElement("input");return s.name=e.name,s.value=e.value,t.id&&s.setAttribute("form",t.id),e.parentNode.insertBefore(s,e),t=new FormData(t),s.parentNode.removeChild(s),t}function V_(t,e,s,n,a){if(e==="submit"&&s&&s.stateNode===a){var r=Sh((a[at]||null).action),i=n.submitter;i&&(e=(e=i[at]||null)?Sh(e.formAction):i.getAttribute("formAction"),e!==null&&(r=e,i=null));var l=new Vl("action","action",null,n,a);t.push({event:l,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(mn!==0){var c=i?jh(a,i):new FormData(a);Jc(s,{pending:!0,data:c,method:a.method,action:r},null,c)}}else typeof r=="function"&&(l.preventDefault(),c=i?jh(a,i):new FormData(a),Jc(s,{pending:!0,data:c,method:a.method,action:r},r,c))},currentTarget:a}]})}}for(var tc=0;tc<qc.length;tc++){var sc=qc[tc],Q_=sc.toLowerCase(),J_=sc[0].toUpperCase()+sc.slice(1);qt(Q_,"on"+J_)}qt(Og,"onAnimationEnd");qt(Rg,"onAnimationIteration");qt(Cg,"onAnimationStart");qt("dblclick","onDoubleClick");qt("focusin","onFocus");qt("focusout","onBlur");qt(f_,"onTransitionRun");qt(h_,"onTransitionStart");qt(m_,"onTransitionCancel");qt(kg,"onTransitionEnd");fa("onMouseEnter",["mouseout","mouseover"]);fa("onMouseLeave",["mouseout","mouseover"]);fa("onPointerEnter",["pointerout","pointerover"]);fa("onPointerLeave",["pointerout","pointerover"]);_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_n("onBeforeInput",["compositionend","keypress","textInput","paste"]);_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kr));function gp(t,e){e=(e&4)!==0;for(var s=0;s<t.length;s++){var n=t[s],a=n.event;n=n.listeners;e:{var r=void 0;if(e)for(var i=n.length-1;0<=i;i--){var l=n[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==r&&a.isPropagationStopped())break e;r=l,a.currentTarget=u;try{r(a)}catch(d){yl(d)}a.currentTarget=null,r=c}else for(i=0;i<n.length;i++){if(l=n[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==r&&a.isPropagationStopped())break e;r=l,a.currentTarget=u;try{r(a)}catch(d){yl(d)}a.currentTarget=null,r=c}}}}function F(t,e){var s=e[Rc];s===void 0&&(s=e[Rc]=new Set);var n=t+"__bubble";s.has(n)||(pp(e,t,2,!1),s.add(n))}function nc(t,e,s){var n=0;e&&(n|=4),pp(s,t,n,e)}var xi="_reactListening"+Math.random().toString(36).slice(2);function kd(t){if(!t[xi]){t[xi]=!0,ug.forEach(function(s){s!=="selectionchange"&&(K_.has(s)||nc(s,!1,t),nc(s,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[xi]||(e[xi]=!0,nc("selectionchange",!1,e))}}function pp(t,e,s,n){switch(Tp(e)){case 2:var a=Sx;break;case 8:a=jx;break;default:a=Ud}s=a.bind(null,e,s,t),a=void 0,!Mc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,s,{capture:!0,passive:a}):t.addEventListener(e,s,!0):a!==void 0?t.addEventListener(e,s,{passive:a}):t.addEventListener(e,s,!1)}function ac(t,e,s,n,a){var r=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var l=n.stateNode.containerInfo;if(l===a)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&i.stateNode.containerInfo===a)return;i=i.return}for(;l!==null;){if(i=In(l),i===null)return;if(c=i.tag,c===5||c===6||c===26||c===27){n=r=i;continue e}l=l.parentNode}}n=n.return}yg(function(){var u=r,d=Fu(s),f=[];e:{var h=Dg.get(t);if(h!==void 0){var m=Vl,x=t;switch(t){case"keypress":if(zi(s)===0)break e;case"keydown":case"keyup":m=Xv;break;case"focusin":x="focus",m=Mo;break;case"focusout":x="blur",m=Mo;break;case"beforeblur":case"afterblur":m=Mo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Cf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=kv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Vv;break;case Og:case Rg:case Cg:m=$v;break;case kg:m=Jv;break;case"scroll":case"scrollend":m=Rv;break;case"wheel":m=Zv;break;case"copy":case"cut":case"paste":m=qv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Df;break;case"toggle":case"beforetoggle":m=Wv}var w=(e&4)!==0,N=!w&&(t==="scroll"||t==="scrollend"),y=w?h!==null?h+"Capture":null:h;w=[];for(var g=u,p;g!==null;){var b=g;if(p=b.stateNode,b=b.tag,b!==5&&b!==26&&b!==27||p===null||y===null||(b=Er(g,y),b!=null&&w.push(Dr(g,b,p))),N)break;g=g.return}0<w.length&&(h=new m(h,x,null,s,d),f.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&s!==Dc&&(x=s.relatedTarget||s.fromElement)&&(In(x)||x[ja]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=s.relatedTarget||s.toElement,m=u,x=x?In(x):null,x!==null&&(N=Hr(x),w=x.tag,x!==N||w!==5&&w!==27&&w!==6)&&(x=null)):(m=null,x=u),m!==x)){if(w=Cf,b="onMouseLeave",y="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(w=Df,b="onPointerLeave",y="onPointerEnter",g="pointer"),N=m==null?h:Va(m),p=x==null?h:Va(x),h=new w(b,g+"leave",m,s,d),h.target=N,h.relatedTarget=p,b=null,In(d)===u&&(w=new w(y,g+"enter",x,s,d),w.target=p,w.relatedTarget=N,b=w),N=b,m&&x)t:{for(w=m,y=x,g=0,p=w;p;p=En(p))g++;for(p=0,b=y;b;b=En(b))p++;for(;0<g-p;)w=En(w),g--;for(;0<p-g;)y=En(y),p--;for(;g--;){if(w===y||y!==null&&w===y.alternate)break t;w=En(w),y=En(y)}w=null}else w=null;m!==null&&Nh(f,h,m,w,!1),x!==null&&N!==null&&Nh(f,N,x,w,!0)}}e:{if(h=u?Va(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var A=qf;else if(Uf(h))if(jg)A=c_;else{A=l_;var O=i_}else m=h.nodeName,!m||m.toLowerCase()!=="input"||h.type!=="checkbox"&&h.type!=="radio"?u&&Zu(u.elementType)&&(A=qf):A=o_;if(A&&(A=A(t,u))){Sg(f,A,s,d);break e}O&&O(t,h,u),t==="focusout"&&u&&h.type==="number"&&u.memoizedProps.value!=null&&kc(h,"number",h.value)}switch(O=u?Va(u):window,t){case"focusin":(Uf(O)||O.contentEditable==="true")&&(Jn=O,$c=u,or=null);break;case"focusout":or=$c=Jn=null;break;case"mousedown":Uc=!0;break;case"contextmenu":case"mouseup":case"dragend":Uc=!1,Gf(f,s,d);break;case"selectionchange":if(d_)break;case"keydown":case"keyup":Gf(f,s,d)}var T;if(td)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Qn?xg(t,s)&&(v="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(v="onCompositionStart");v&&(_g&&s.locale!=="ko"&&(Qn||v!=="onCompositionStart"?v==="onCompositionEnd"&&Qn&&(T=vg()):(ks=d,Wu="value"in ks?ks.value:ks.textContent,Qn=!0)),O=El(u,v),0<O.length&&(v=new kf(v,t,null,s,d),f.push({event:v,listeners:O}),T?v.data=T:(T=wg(s),T!==null&&(v.data=T)))),(T=t_?s_(t,s):n_(t,s))&&(v=El(u,"onBeforeInput"),0<v.length&&(O=new kf("onBeforeInput","beforeinput",null,s,d),f.push({event:O,listeners:v}),O.data=T)),V_(f,t,u,s,d)}gp(f,e)})}function Dr(t,e,s){return{instance:t,listener:e,currentTarget:s}}function El(t,e){for(var s=e+"Capture",n=[];t!==null;){var a=t,r=a.stateNode;if(a=a.tag,a!==5&&a!==26&&a!==27||r===null||(a=Er(t,s),a!=null&&n.unshift(Dr(t,a,r)),a=Er(t,e),a!=null&&n.push(Dr(t,a,r))),t.tag===3)return n;t=t.return}return[]}function En(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Nh(t,e,s,n,a){for(var r=e._reactName,i=[];s!==null&&s!==n;){var l=s,c=l.alternate,u=l.stateNode;if(l=l.tag,c!==null&&c===n)break;l!==5&&l!==26&&l!==27||u===null||(c=u,a?(u=Er(s,r),u!=null&&i.unshift(Dr(s,u,c))):a||(u=Er(s,r),u!=null&&i.push(Dr(s,u,c)))),s=s.return}i.length!==0&&t.push({event:e,listeners:i})}var Z_=/\r\n?/g,F_=/\u0000|\uFFFD/g;function Eh(t){return(typeof t=="string"?t:""+t).replace(Z_,`
`).replace(F_,"")}function bp(t,e){return e=Eh(e),Eh(t)===e}function ro(){}function ie(t,e,s,n,a,r){switch(s){case"children":typeof n=="string"?e==="body"||e==="textarea"&&n===""||ha(t,n):(typeof n=="number"||typeof n=="bigint")&&e!=="body"&&ha(t,""+n);break;case"className":mi(t,"class",n);break;case"tabIndex":mi(t,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":mi(t,s,n);break;case"style":bg(t,n,r);break;case"data":if(e!=="object"){mi(t,"data",n);break}case"src":case"href":if(n===""&&(e!=="a"||s!=="href")){t.removeAttribute(s);break}if(n==null||typeof n=="function"||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(s);break}n=Ui(""+n),t.setAttribute(s,n);break;case"action":case"formAction":if(typeof n=="function"){t.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof r=="function"&&(s==="formAction"?(e!=="input"&&ie(t,e,"name",a.name,a,null),ie(t,e,"formEncType",a.formEncType,a,null),ie(t,e,"formMethod",a.formMethod,a,null),ie(t,e,"formTarget",a.formTarget,a,null)):(ie(t,e,"encType",a.encType,a,null),ie(t,e,"method",a.method,a,null),ie(t,e,"target",a.target,a,null)));if(n==null||typeof n=="symbol"||typeof n=="boolean"){t.removeAttribute(s);break}n=Ui(""+n),t.setAttribute(s,n);break;case"onClick":n!=null&&(t.onclick=ro);break;case"onScroll":n!=null&&F("scroll",t);break;case"onScrollEnd":n!=null&&F("scrollend",t);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(k(61));if(s=n.__html,s!=null){if(a.children!=null)throw Error(k(60));t.innerHTML=s}}break;case"multiple":t.multiple=n&&typeof n!="function"&&typeof n!="symbol";break;case"muted":t.muted=n&&typeof n!="function"&&typeof n!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(n==null||typeof n=="function"||typeof n=="boolean"||typeof n=="symbol"){t.removeAttribute("xlink:href");break}s=Ui(""+n),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,""+n):t.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,""):t.removeAttribute(s);break;case"capture":case"download":n===!0?t.setAttribute(s,""):n!==!1&&n!=null&&typeof n!="function"&&typeof n!="symbol"?t.setAttribute(s,n):t.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":n!=null&&typeof n!="function"&&typeof n!="symbol"&&!isNaN(n)&&1<=n?t.setAttribute(s,n):t.removeAttribute(s);break;case"rowSpan":case"start":n==null||typeof n=="function"||typeof n=="symbol"||isNaN(n)?t.removeAttribute(s):t.setAttribute(s,n);break;case"popover":F("beforetoggle",t),F("toggle",t),$i(t,"popover",n);break;case"xlinkActuate":Jt(t,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":Jt(t,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":Jt(t,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":Jt(t,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":Jt(t,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":Jt(t,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":Jt(t,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":Jt(t,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":Jt(t,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":$i(t,"is",n);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=Tv.get(s)||s,$i(t,s,n))}}function lu(t,e,s,n,a,r){switch(s){case"style":bg(t,n,r);break;case"dangerouslySetInnerHTML":if(n!=null){if(typeof n!="object"||!("__html"in n))throw Error(k(61));if(s=n.__html,s!=null){if(a.children!=null)throw Error(k(60));t.innerHTML=s}}break;case"children":typeof n=="string"?ha(t,n):(typeof n=="number"||typeof n=="bigint")&&ha(t,""+n);break;case"onScroll":n!=null&&F("scroll",t);break;case"onScrollEnd":n!=null&&F("scrollend",t);break;case"onClick":n!=null&&(t.onclick=ro);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!dg.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(a=s.endsWith("Capture"),e=s.slice(2,a?s.length-7:void 0),r=t[at]||null,r=r!=null?r[s]:null,typeof r=="function"&&t.removeEventListener(e,r,a),typeof n=="function")){typeof r!="function"&&r!==null&&(s in t?t[s]=null:t.hasAttribute(s)&&t.removeAttribute(s)),t.addEventListener(e,n,a);break e}s in t?t[s]=n:n===!0?t.setAttribute(s,""):$i(t,s,n)}}}function Pe(t,e,s){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":F("error",t),F("load",t);var n=!1,a=!1,r;for(r in s)if(s.hasOwnProperty(r)){var i=s[r];if(i!=null)switch(r){case"src":n=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(k(137,e));default:ie(t,e,r,i,s,null)}}a&&ie(t,e,"srcSet",s.srcSet,s,null),n&&ie(t,e,"src",s.src,s,null);return;case"input":F("invalid",t);var l=r=i=a=null,c=null,u=null;for(n in s)if(s.hasOwnProperty(n)){var d=s[n];if(d!=null)switch(n){case"name":a=d;break;case"type":i=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(k(137,e));break;default:ie(t,e,n,d,s,null)}}mg(t,r,l,c,u,i,a,!1),ll(t);return;case"select":F("invalid",t),n=i=r=null;for(a in s)if(s.hasOwnProperty(a)&&(l=s[a],l!=null))switch(a){case"value":r=l;break;case"defaultValue":i=l;break;case"multiple":n=l;default:ie(t,e,a,l,s,null)}e=r,s=i,t.multiple=!!n,e!=null?aa(t,!!n,e,!1):s!=null&&aa(t,!!n,s,!0);return;case"textarea":F("invalid",t),r=a=n=null;for(i in s)if(s.hasOwnProperty(i)&&(l=s[i],l!=null))switch(i){case"value":n=l;break;case"defaultValue":a=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(l!=null)throw Error(k(91));break;default:ie(t,e,i,l,s,null)}pg(t,n,a,r),ll(t);return;case"option":for(c in s)if(s.hasOwnProperty(c)&&(n=s[c],n!=null))switch(c){case"selected":t.selected=n&&typeof n!="function"&&typeof n!="symbol";break;default:ie(t,e,c,n,s,null)}return;case"dialog":F("beforetoggle",t),F("toggle",t),F("cancel",t),F("close",t);break;case"iframe":case"object":F("load",t);break;case"video":case"audio":for(n=0;n<kr.length;n++)F(kr[n],t);break;case"image":F("error",t),F("load",t);break;case"details":F("toggle",t);break;case"embed":case"source":case"link":F("error",t),F("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in s)if(s.hasOwnProperty(u)&&(n=s[u],n!=null))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(k(137,e));default:ie(t,e,u,n,s,null)}return;default:if(Zu(e)){for(d in s)s.hasOwnProperty(d)&&(n=s[d],n!==void 0&&lu(t,e,d,n,s,void 0));return}}for(l in s)s.hasOwnProperty(l)&&(n=s[l],n!=null&&ie(t,e,l,n,s,null))}function W_(t,e,s,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var a=null,r=null,i=null,l=null,c=null,u=null,d=null;for(m in s){var f=s[m];if(s.hasOwnProperty(m)&&f!=null)switch(m){case"checked":break;case"value":break;case"defaultValue":c=f;default:n.hasOwnProperty(m)||ie(t,e,m,null,n,f)}}for(var h in n){var m=n[h];if(f=s[h],n.hasOwnProperty(h)&&(m!=null||f!=null))switch(h){case"type":r=m;break;case"name":a=m;break;case"checked":u=m;break;case"defaultChecked":d=m;break;case"value":i=m;break;case"defaultValue":l=m;break;case"children":case"dangerouslySetInnerHTML":if(m!=null)throw Error(k(137,e));break;default:m!==f&&ie(t,e,h,m,n,f)}}Cc(t,i,l,c,u,d,r,a);return;case"select":m=i=l=h=null;for(r in s)if(c=s[r],s.hasOwnProperty(r)&&c!=null)switch(r){case"value":break;case"multiple":m=c;default:n.hasOwnProperty(r)||ie(t,e,r,null,n,c)}for(a in n)if(r=n[a],c=s[a],n.hasOwnProperty(a)&&(r!=null||c!=null))switch(a){case"value":h=r;break;case"defaultValue":l=r;break;case"multiple":i=r;default:r!==c&&ie(t,e,a,r,n,c)}e=l,s=i,n=m,h!=null?aa(t,!!s,h,!1):!!n!=!!s&&(e!=null?aa(t,!!s,e,!0):aa(t,!!s,s?[]:"",!1));return;case"textarea":m=h=null;for(l in s)if(a=s[l],s.hasOwnProperty(l)&&a!=null&&!n.hasOwnProperty(l))switch(l){case"value":break;case"children":break;default:ie(t,e,l,null,n,a)}for(i in n)if(a=n[i],r=s[i],n.hasOwnProperty(i)&&(a!=null||r!=null))switch(i){case"value":h=a;break;case"defaultValue":m=a;break;case"children":break;case"dangerouslySetInnerHTML":if(a!=null)throw Error(k(91));break;default:a!==r&&ie(t,e,i,a,n,r)}gg(t,h,m);return;case"option":for(var x in s)if(h=s[x],s.hasOwnProperty(x)&&h!=null&&!n.hasOwnProperty(x))switch(x){case"selected":t.selected=!1;break;default:ie(t,e,x,null,n,h)}for(c in n)if(h=n[c],m=s[c],n.hasOwnProperty(c)&&h!==m&&(h!=null||m!=null))switch(c){case"selected":t.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:ie(t,e,c,h,n,m)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var w in s)h=s[w],s.hasOwnProperty(w)&&h!=null&&!n.hasOwnProperty(w)&&ie(t,e,w,null,n,h);for(u in n)if(h=n[u],m=s[u],n.hasOwnProperty(u)&&h!==m&&(h!=null||m!=null))switch(u){case"children":case"dangerouslySetInnerHTML":if(h!=null)throw Error(k(137,e));break;default:ie(t,e,u,h,n,m)}return;default:if(Zu(e)){for(var N in s)h=s[N],s.hasOwnProperty(N)&&h!==void 0&&!n.hasOwnProperty(N)&&lu(t,e,N,void 0,n,h);for(d in n)h=n[d],m=s[d],!n.hasOwnProperty(d)||h===m||h===void 0&&m===void 0||lu(t,e,d,h,n,m);return}}for(var y in s)h=s[y],s.hasOwnProperty(y)&&h!=null&&!n.hasOwnProperty(y)&&ie(t,e,y,null,n,h);for(f in n)h=n[f],m=s[f],!n.hasOwnProperty(f)||h===m||h==null&&m==null||ie(t,e,f,h,n,m)}var ou=null,cu=null;function Al(t){return t.nodeType===9?t:t.ownerDocument}function Ah(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yp(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function uu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rc=null;function ex(){var t=window.event;return t&&t.type==="popstate"?t===rc?!1:(rc=t,!0):(rc=null,!1)}var vp=typeof setTimeout=="function"?setTimeout:void 0,tx=typeof clearTimeout=="function"?clearTimeout:void 0,Th=typeof Promise=="function"?Promise:void 0,sx=typeof queueMicrotask=="function"?queueMicrotask:typeof Th<"u"?function(t){return Th.resolve(null).then(t).catch(nx)}:vp;function nx(t){setTimeout(function(){throw t})}function Vs(t){return t==="head"}function Oh(t,e){var s=e,n=0,a=0;do{var r=s.nextSibling;if(t.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(0<n&&8>n){s=n;var i=t.ownerDocument;if(s&1&&vr(i.documentElement),s&2&&vr(i.body),s&4)for(s=i.head,vr(s),i=s.firstChild;i;){var l=i.nextSibling,c=i.nodeName;i[Yr]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&i.rel.toLowerCase()==="stylesheet"||s.removeChild(i),i=l}}if(a===0){t.removeChild(r),zr(e);return}a--}else s==="$"||s==="$?"||s==="$!"?a++:n=s.charCodeAt(0)-48;else n=0;s=r}while(s);zr(e)}function du(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var s=e;switch(e=e.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":du(s),Ku(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}t.removeChild(s)}}function ax(t,e,s,n){for(;t.nodeType===1;){var a=s;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!n&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(n){if(!t[Yr])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(r=t.getAttribute("rel"),r==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(r!==a.rel||t.getAttribute("href")!==(a.href==null||a.href===""?null:a.href)||t.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin)||t.getAttribute("title")!==(a.title==null?null:a.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(r=t.getAttribute("src"),(r!==(a.src==null?null:a.src)||t.getAttribute("type")!==(a.type==null?null:a.type)||t.getAttribute("crossorigin")!==(a.crossOrigin==null?null:a.crossOrigin))&&r&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var r=a.name==null?null:""+a.name;if(a.type==="hidden"&&t.getAttribute("name")===r)return t}else return t;if(t=Ut(t.nextSibling),t===null)break}return null}function rx(t,e,s){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!s||(t=Ut(t.nextSibling),t===null))return null;return t}function fu(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function ix(t,e){var s=t.ownerDocument;if(t.data!=="$?"||s.readyState==="complete")e();else{var n=function(){e(),s.removeEventListener("DOMContentLoaded",n)};s.addEventListener("DOMContentLoaded",n),t._reactRetry=n}}function Ut(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var hu=null;function Rh(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(e===0)return t;e--}else s==="/$"&&e++}t=t.previousSibling}return null}function _p(t,e,s){switch(e=Al(s),t){case"html":if(t=e.documentElement,!t)throw Error(k(452));return t;case"head":if(t=e.head,!t)throw Error(k(453));return t;case"body":if(t=e.body,!t)throw Error(k(454));return t;default:throw Error(k(451))}}function vr(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);Ku(t)}var Ct=new Map,Ch=new Set;function Tl(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var gs=ne.d;ne.d={f:lx,r:ox,D:cx,C:ux,L:dx,m:fx,X:mx,S:hx,M:gx};function lx(){var t=gs.f(),e=so();return t||e}function ox(t){var e=Na(t);e!==null&&e.tag===5&&e.type==="form"?h0(e):gs.r(t)}var Ta=typeof document>"u"?null:document;function xp(t,e,s){var n=Ta;if(n&&typeof e=="string"&&e){var a=Nt(e);a='link[rel="'+t+'"][href="'+a+'"]',typeof s=="string"&&(a+='[crossorigin="'+s+'"]'),Ch.has(a)||(Ch.add(a),t={rel:t,crossOrigin:s,href:e},n.querySelector(a)===null&&(e=n.createElement("link"),Pe(e,"link",t),$e(e),n.head.appendChild(e)))}}function cx(t){gs.D(t),xp("dns-prefetch",t,null)}function ux(t,e){gs.C(t,e),xp("preconnect",t,e)}function dx(t,e,s){gs.L(t,e,s);var n=Ta;if(n&&t&&e){var a='link[rel="preload"][as="'+Nt(e)+'"]';e==="image"&&s&&s.imageSrcSet?(a+='[imagesrcset="'+Nt(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(a+='[imagesizes="'+Nt(s.imageSizes)+'"]')):a+='[href="'+Nt(t)+'"]';var r=a;switch(e){case"style":r=xa(t);break;case"script":r=Oa(t)}Ct.has(r)||(t=fe({rel:"preload",href:e==="image"&&s&&s.imageSrcSet?void 0:t,as:e},s),Ct.set(r,t),n.querySelector(a)!==null||e==="style"&&n.querySelector(ti(r))||e==="script"&&n.querySelector(si(r))||(e=n.createElement("link"),Pe(e,"link",t),$e(e),n.head.appendChild(e)))}}function fx(t,e){gs.m(t,e);var s=Ta;if(s&&t){var n=e&&typeof e.as=="string"?e.as:"script",a='link[rel="modulepreload"][as="'+Nt(n)+'"][href="'+Nt(t)+'"]',r=a;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Oa(t)}if(!Ct.has(r)&&(t=fe({rel:"modulepreload",href:t},e),Ct.set(r,t),s.querySelector(a)===null)){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(si(r)))return}n=s.createElement("link"),Pe(n,"link",t),$e(n),s.head.appendChild(n)}}}function hx(t,e,s){gs.S(t,e,s);var n=Ta;if(n&&t){var a=na(n).hoistableStyles,r=xa(t);e=e||"default";var i=a.get(r);if(!i){var l={loading:0,preload:null};if(i=n.querySelector(ti(r)))l.loading=5;else{t=fe({rel:"stylesheet",href:t,"data-precedence":e},s),(s=Ct.get(r))&&Dd(t,s);var c=i=n.createElement("link");$e(c),Pe(c,"link",t),c._p=new Promise(function(u,d){c.onload=u,c.onerror=d}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Yi(i,e,n)}i={type:"stylesheet",instance:i,count:1,state:l},a.set(r,i)}}}function mx(t,e){gs.X(t,e);var s=Ta;if(s&&t){var n=na(s).hoistableScripts,a=Oa(t),r=n.get(a);r||(r=s.querySelector(si(a)),r||(t=fe({src:t,async:!0},e),(e=Ct.get(a))&&Md(t,e),r=s.createElement("script"),$e(r),Pe(r,"link",t),s.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},n.set(a,r))}}function gx(t,e){gs.M(t,e);var s=Ta;if(s&&t){var n=na(s).hoistableScripts,a=Oa(t),r=n.get(a);r||(r=s.querySelector(si(a)),r||(t=fe({src:t,async:!0,type:"module"},e),(e=Ct.get(a))&&Md(t,e),r=s.createElement("script"),$e(r),Pe(r,"link",t),s.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},n.set(a,r))}}function kh(t,e,s,n){var a=(a=$s.current)?Tl(a):null;if(!a)throw Error(k(446));switch(t){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(e=xa(s.href),s=na(a).hoistableStyles,n=s.get(e),n||(n={type:"style",instance:null,count:0,state:null},s.set(e,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){t=xa(s.href);var r=na(a).hoistableStyles,i=r.get(t);if(i||(a=a.ownerDocument||a,i={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},r.set(t,i),(r=a.querySelector(ti(t)))&&!r._p&&(i.instance=r,i.state.loading=5),Ct.has(t)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Ct.set(t,s),r||px(a,t,s,i.state))),e&&n===null)throw Error(k(528,""));return i}if(e&&n!==null)throw Error(k(529,""));return null;case"script":return e=s.async,s=s.src,typeof s=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=Oa(s),s=na(a).hoistableScripts,n=s.get(e),n||(n={type:"script",instance:null,count:0,state:null},s.set(e,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(k(444,t))}}function xa(t){return'href="'+Nt(t)+'"'}function ti(t){return'link[rel="stylesheet"]['+t+"]"}function wp(t){return fe({},t,{"data-precedence":t.precedence,precedence:null})}function px(t,e,s,n){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?n.loading=1:(e=t.createElement("link"),n.preload=e,e.addEventListener("load",function(){return n.loading|=1}),e.addEventListener("error",function(){return n.loading|=2}),Pe(e,"link",s),$e(e),t.head.appendChild(e))}function Oa(t){return'[src="'+Nt(t)+'"]'}function si(t){return"script[async]"+t}function Dh(t,e,s){if(e.count++,e.instance===null)switch(e.type){case"style":var n=t.querySelector('style[data-href~="'+Nt(s.href)+'"]');if(n)return e.instance=n,$e(n),n;var a=fe({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return n=(t.ownerDocument||t).createElement("style"),$e(n),Pe(n,"style",a),Yi(n,s.precedence,t),e.instance=n;case"stylesheet":a=xa(s.href);var r=t.querySelector(ti(a));if(r)return e.state.loading|=4,e.instance=r,$e(r),r;n=wp(s),(a=Ct.get(a))&&Dd(n,a),r=(t.ownerDocument||t).createElement("link"),$e(r);var i=r;return i._p=new Promise(function(l,c){i.onload=l,i.onerror=c}),Pe(r,"link",n),e.state.loading|=4,Yi(r,s.precedence,t),e.instance=r;case"script":return r=Oa(s.src),(a=t.querySelector(si(r)))?(e.instance=a,$e(a),a):(n=s,(a=Ct.get(r))&&(n=fe({},s),Md(n,a)),t=t.ownerDocument||t,a=t.createElement("script"),$e(a),Pe(a,"link",n),t.head.appendChild(a),e.instance=a);case"void":return null;default:throw Error(k(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(n=e.instance,e.state.loading|=4,Yi(n,s.precedence,t));return e.instance}function Yi(t,e,s){for(var n=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=n.length?n[n.length-1]:null,r=a,i=0;i<n.length;i++){var l=n[i];if(l.dataset.precedence===e)r=l;else if(r!==a)break}r?r.parentNode.insertBefore(t,r.nextSibling):(e=s.nodeType===9?s.head:s,e.insertBefore(t,e.firstChild))}function Dd(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function Md(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var Ii=null;function Mh(t,e,s){if(Ii===null){var n=new Map,a=Ii=new Map;a.set(s,n)}else a=Ii,n=a.get(s),n||(n=new Map,a.set(s,n));if(n.has(t))return n;for(n.set(t,null),s=s.getElementsByTagName(t),a=0;a<s.length;a++){var r=s[a];if(!(r[Yr]||r[Ie]||t==="link"&&r.getAttribute("rel")==="stylesheet")&&r.namespaceURI!=="http://www.w3.org/2000/svg"){var i=r.getAttribute(e)||"";i=t+i;var l=n.get(i);l?l.push(r):n.set(i,[r])}}return n}function $h(t,e,s){t=t.ownerDocument||t,t.head.insertBefore(s,e==="title"?t.querySelector("head > title"):null)}function bx(t,e,s){if(s===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function Sp(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var Mr=null;function yx(){}function vx(t,e,s){if(Mr===null)throw Error(k(475));var n=Mr;if(e.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var a=xa(s.href),r=t.querySelector(ti(a));if(r){t=r._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(n.count++,n=Ol.bind(n),t.then(n,n)),e.state.loading|=4,e.instance=r,$e(r);return}r=t.ownerDocument||t,s=wp(s),(a=Ct.get(a))&&Dd(s,a),r=r.createElement("link"),$e(r);var i=r;i._p=new Promise(function(l,c){i.onload=l,i.onerror=c}),Pe(r,"link",s),e.instance=r}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(n.count++,e=Ol.bind(n),t.addEventListener("load",e),t.addEventListener("error",e))}}function _x(){if(Mr===null)throw Error(k(475));var t=Mr;return t.stylesheets&&t.count===0&&mu(t,t.stylesheets),0<t.count?function(e){var s=setTimeout(function(){if(t.stylesheets&&mu(t,t.stylesheets),t.unsuspend){var n=t.unsuspend;t.unsuspend=null,n()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(s)}}:null}function Ol(){if(this.count--,this.count===0){if(this.stylesheets)mu(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Rl=null;function mu(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Rl=new Map,e.forEach(xx,t),Rl=null,Ol.call(t))}function xx(t,e){if(!(e.state.loading&4)){var s=Rl.get(t);if(s)var n=s.get(null);else{s=new Map,Rl.set(t,s);for(var a=t.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<a.length;r++){var i=a[r];(i.nodeName==="LINK"||i.getAttribute("media")!=="not all")&&(s.set(i.dataset.precedence,i),n=i)}n&&s.set(null,n)}a=e.instance,i=a.getAttribute("data-precedence"),r=s.get(i)||n,r===n&&s.set(null,a),s.set(i,a),this.count++,n=Ol.bind(this),a.addEventListener("load",n),a.addEventListener("error",n),r?r.parentNode.insertBefore(a,r.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(a,t.firstChild)),e.state.loading|=4}}var $r={$$typeof:as,Provider:null,Consumer:null,_currentValue:on,_currentValue2:on,_threadCount:0};function wx(t,e,s,n,a,r,i,l){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ao(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ao(0),this.hiddenUpdates=Ao(null),this.identifierPrefix=n,this.onUncaughtError=a,this.onCaughtError=r,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function jp(t,e,s,n,a,r,i,l,c,u,d,f){return t=new wx(t,e,s,i,l,c,u,f),e=1,r===!0&&(e|=24),r=ht(3,null,null,e),t.current=r,r.stateNode=t,e=od(),e.refCount++,t.pooledCache=e,e.refCount++,r.memoizedState={element:n,isDehydrated:s,cache:e},ud(r),t}function Np(t){return t?(t=Fn,t):Fn}function Ep(t,e,s,n,a,r){a=Np(a),n.context===null?n.context=a:n.pendingContext=a,n=Us(e),n.payload={element:s},r=r===void 0?null:r,r!==null&&(n.callback=r),s=qs(t,n,e),s!==null&&(bt(s,t,e),dr(s,t,e))}function Uh(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<e?s:e}}function $d(t,e){Uh(t,e),(t=t.alternate)&&Uh(t,e)}function Ap(t){if(t.tag===13){var e=Ea(t,67108864);e!==null&&bt(e,t,67108864),$d(t,67108864)}}var Cl=!0;function Sx(t,e,s,n){var a=I.T;I.T=null;var r=ne.p;try{ne.p=2,Ud(t,e,s,n)}finally{ne.p=r,I.T=a}}function jx(t,e,s,n){var a=I.T;I.T=null;var r=ne.p;try{ne.p=8,Ud(t,e,s,n)}finally{ne.p=r,I.T=a}}function Ud(t,e,s,n){if(Cl){var a=gu(n);if(a===null)ac(t,e,n,kl,s),qh(t,n);else if(Ex(a,t,e,s,n))n.stopPropagation();else if(qh(t,n),e&4&&-1<Nx.indexOf(t)){for(;a!==null;){var r=Na(a);if(r!==null)switch(r.tag){case 3:if(r=r.stateNode,r.current.memoizedState.isDehydrated){var i=Fs(r.pendingLanes);if(i!==0){var l=r;for(l.pendingLanes|=2,l.entangledLanes|=2;i;){var c=1<<31-gt(i);l.entanglements[1]|=c,i&=~c}Qt(r),!(re&6)&&(wl=Yt()+500,ei(0))}}break;case 13:l=Ea(r,2),l!==null&&bt(l,r,2),so(),$d(r,2)}if(r=gu(n),r===null&&ac(t,e,n,kl,s),r===a)break;a=r}a!==null&&n.stopPropagation()}else ac(t,e,n,null,s)}}function gu(t){return t=Fu(t),qd(t)}var kl=null;function qd(t){if(kl=null,t=In(t),t!==null){var e=Hr(t);if(e===null)t=null;else{var s=e.tag;if(s===13){if(t=Fm(e),t!==null)return t;t=null}else if(s===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return kl=t,null}function Tp(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(uv()){case sg:return 2;case ng:return 8;case il:case dv:return 32;case ag:return 268435456;default:return 32}default:return 32}}var pu=!1,Bs=null,Hs=null,Gs=null,Ur=new Map,qr=new Map,Os=[],Nx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function qh(t,e){switch(t){case"focusin":case"focusout":Bs=null;break;case"dragenter":case"dragleave":Hs=null;break;case"mouseover":case"mouseout":Gs=null;break;case"pointerover":case"pointerout":Ur.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qr.delete(e.pointerId)}}function Ga(t,e,s,n,a,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:s,eventSystemFlags:n,nativeEvent:r,targetContainers:[a]},e!==null&&(e=Na(e),e!==null&&Ap(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Ex(t,e,s,n,a){switch(e){case"focusin":return Bs=Ga(Bs,t,e,s,n,a),!0;case"dragenter":return Hs=Ga(Hs,t,e,s,n,a),!0;case"mouseover":return Gs=Ga(Gs,t,e,s,n,a),!0;case"pointerover":var r=a.pointerId;return Ur.set(r,Ga(Ur.get(r)||null,t,e,s,n,a)),!0;case"gotpointercapture":return r=a.pointerId,qr.set(r,Ga(qr.get(r)||null,t,e,s,n,a)),!0}return!1}function Op(t){var e=In(t.target);if(e!==null){var s=Hr(e);if(s!==null){if(e=s.tag,e===13){if(e=Fm(s),e!==null){t.blockedOn=e,vv(t.priority,function(){if(s.tag===13){var n=pt();n=Qu(n);var a=Ea(s,n);a!==null&&bt(a,s,n),$d(s,n)}});return}}else if(e===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Vi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var s=gu(t.nativeEvent);if(s===null){s=t.nativeEvent;var n=new s.constructor(s.type,s);Dc=n,s.target.dispatchEvent(n),Dc=null}else return e=Na(s),e!==null&&Ap(e),t.blockedOn=s,!1;e.shift()}return!0}function zh(t,e,s){Vi(t)&&s.delete(e)}function Ax(){pu=!1,Bs!==null&&Vi(Bs)&&(Bs=null),Hs!==null&&Vi(Hs)&&(Hs=null),Gs!==null&&Vi(Gs)&&(Gs=null),Ur.forEach(zh),qr.forEach(zh)}function wi(t,e){t.blockedOn===e&&(t.blockedOn=null,pu||(pu=!0,Ce.unstable_scheduleCallback(Ce.unstable_NormalPriority,Ax)))}var Si=null;function Lh(t){Si!==t&&(Si=t,Ce.unstable_scheduleCallback(Ce.unstable_NormalPriority,function(){Si===t&&(Si=null);for(var e=0;e<t.length;e+=3){var s=t[e],n=t[e+1],a=t[e+2];if(typeof n!="function"){if(qd(n||s)===null)continue;break}var r=Na(s);r!==null&&(t.splice(e,3),e-=3,Jc(r,{pending:!0,data:a,method:s.method,action:n},n,a))}}))}function zr(t){function e(c){return wi(c,t)}Bs!==null&&wi(Bs,t),Hs!==null&&wi(Hs,t),Gs!==null&&wi(Gs,t),Ur.forEach(e),qr.forEach(e);for(var s=0;s<Os.length;s++){var n=Os[s];n.blockedOn===t&&(n.blockedOn=null)}for(;0<Os.length&&(s=Os[0],s.blockedOn===null);)Op(s),s.blockedOn===null&&Os.shift();if(s=(t.ownerDocument||t).$$reactFormReplay,s!=null)for(n=0;n<s.length;n+=3){var a=s[n],r=s[n+1],i=a[at]||null;if(typeof r=="function")i||Lh(s);else if(i){var l=null;if(r&&r.hasAttribute("formAction")){if(a=r,i=r[at]||null)l=i.formAction;else if(qd(a)!==null)continue}else l=i.action;typeof l=="function"?s[n+1]=l:(s.splice(n,3),n-=3),Lh(s)}}}function zd(t){this._internalRoot=t}io.prototype.render=zd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(k(409));var s=e.current,n=pt();Ep(s,n,t,e,null,null)};io.prototype.unmount=zd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ep(t.current,2,null,t,null,null),so(),e[ja]=null}};function io(t){this._internalRoot=t}io.prototype.unstable_scheduleHydration=function(t){if(t){var e=cg();t={blockedOn:null,target:t,priority:e};for(var s=0;s<Os.length&&e!==0&&e<Os[s].priority;s++);Os.splice(s,0,t),s===0&&Op(t)}};var Bh=Km.version;if(Bh!=="19.1.1")throw Error(k(527,Bh,"19.1.1"));ne.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(k(188)):(t=Object.keys(t).join(","),Error(k(268,t)));return t=nv(e),t=t!==null?Wm(t):null,t=t===null?null:t.stateNode,t};var Tx={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ji=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ji.isDisabled&&ji.supportsFiber)try{Gr=ji.inject(Tx),mt=ji}catch{}}Xl.createRoot=function(t,e){if(!Zm(t))throw Error(k(299));var s=!1,n="",a=j0,r=N0,i=E0,l=null;return e!=null&&(e.unstable_strictMode===!0&&(s=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onUncaughtError!==void 0&&(a=e.onUncaughtError),e.onCaughtError!==void 0&&(r=e.onCaughtError),e.onRecoverableError!==void 0&&(i=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(l=e.unstable_transitionCallbacks)),e=jp(t,1,!1,null,null,s,n,a,r,i,l,null),t[ja]=e.current,kd(t),new zd(e)};Xl.hydrateRoot=function(t,e,s){if(!Zm(t))throw Error(k(299));var n=!1,a="",r=j0,i=N0,l=E0,c=null,u=null;return s!=null&&(s.unstable_strictMode===!0&&(n=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onUncaughtError!==void 0&&(r=s.onUncaughtError),s.onCaughtError!==void 0&&(i=s.onCaughtError),s.onRecoverableError!==void 0&&(l=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(c=s.unstable_transitionCallbacks),s.formState!==void 0&&(u=s.formState)),e=jp(t,1,!0,e,s??null,n,a,r,i,l,c,u),e.context=Np(null),s=e.current,n=pt(),n=Qu(n),a=Us(n),a.callback=null,qs(s,a,n),s=n,e.current.lanes=s,Xr(e,s),Qt(e),t[ja]=e.current,kd(t),new io(e)};Xl.version="19.1.1";function Rp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Rp)}catch(t){console.error(t)}}Rp(),Xm.exports=Xl;var Ox=Xm.exports;const Rx=Mm(Ox),Cx="modulepreload",kx=function(t){return"/"+t},Hh={},ni=function(e,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=kx(c),c in Hh)return;Hh[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Cx,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},Dx=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>ni(async()=>{const{default:n}=await Promise.resolve().then(()=>Ra);return{default:n}},void 0).then(({default:n})=>n(...s)):e=fetch,(...s)=>e(...s)};class Ld extends Error{constructor(e,s="FunctionsError",n){super(e),this.name=s,this.context=n}}class Mx extends Ld{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Gh extends Ld{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ph extends Ld{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var bu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(bu||(bu={}));var $x=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class Ux{constructor(e,{headers:s={},customFetch:n,region:a=bu.Any}={}){this.url=e,this.headers=s,this.region=a,this.fetch=Dx(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,s={}){var n;return $x(this,void 0,void 0,function*(){try{const{headers:a,method:r,body:i}=s;let l={},{region:c}=s;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const f=yield this.fetch(u.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:d}).catch(w=>{throw new Mx(w)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Gh(f);if(!f.ok)throw new Ph(f);let m=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield f.json():m==="application/octet-stream"?x=yield f.blob():m==="text/event-stream"?x=f:m==="multipart/form-data"?x=yield f.formData():x=yield f.text(),{data:x,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Ph||a instanceof Gh?a.context:void 0}}})}}var nt={},Bd={},lo={},ai={},oo={},co={},qx=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},wa=qx();const zx=wa.fetch,Cp=wa.fetch.bind(wa),kp=wa.Headers,Lx=wa.Request,Bx=wa.Response,Ra=Object.freeze(Object.defineProperty({__proto__:null,Headers:kp,Request:Lx,Response:Bx,default:Cp,fetch:zx},Symbol.toStringTag,{value:"Module"})),Hx=ky(Ra);var uo={};Object.defineProperty(uo,"__esModule",{value:!0});let Gx=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};uo.default=Gx;var Dp=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(co,"__esModule",{value:!0});const Px=Dp(Hx),Xx=Dp(uo);let Yx=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Px.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,s){return this.headers=Object.assign({},this.headers),this.headers[e]=s,this}then(e,s){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var i,l,c;let u=null,d=null,f=null,h=r.status,m=r.statusText;if(r.ok){if(this.method!=="HEAD"){const y=await r.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=y:d=JSON.parse(y))}const w=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),N=(l=r.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&N&&N.length>1&&(f=parseInt(N[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,h=406,m="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const w=await r.text();try{u=JSON.parse(w),Array.isArray(u)&&r.status===404&&(d=[],u=null,h=200,m="OK")}catch{r.status===404&&w===""?(h=204,m="No Content"):u={message:w}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,h=200,m="OK"),u&&this.shouldThrowOnError)throw new Xx.default(u)}return{error:u,data:d,count:f,status:h,statusText:m}});return this.shouldThrowOnError||(a=a.catch(r=>{var i,l,c;return{error:{message:`${(i=r==null?void 0:r.name)!==null&&i!==void 0?i:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(l=r==null?void 0:r.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=r==null?void 0:r.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,s)}returns(){return this}overrideTypes(){return this}};co.default=Yx;var Ix=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oo,"__esModule",{value:!0});const Vx=Ix(co);let Qx=class extends Vx.default{select(e){let s=!1;const n=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:s=!0,nullsFirst:n,foreignTable:a,referencedTable:r=a}={}){const i=r?`${r}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${s?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:s,referencedTable:n=s}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,s,{foreignTable:n,referencedTable:a=n}={}){const r=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(i,`${s-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:s=!1,settings:n=!1,buffers:a=!1,wal:r=!1,format:i="text"}={}){var l;const c=[e?"analyze":null,s?"verbose":null,n?"settings":null,a?"buffers":null,r?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`,i==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};oo.default=Qx;var Jx=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ai,"__esModule",{value:!0});const Kx=Jx(oo);let Zx=class extends Kx.default{eq(e,s){return this.url.searchParams.append(e,`eq.${s}`),this}neq(e,s){return this.url.searchParams.append(e,`neq.${s}`),this}gt(e,s){return this.url.searchParams.append(e,`gt.${s}`),this}gte(e,s){return this.url.searchParams.append(e,`gte.${s}`),this}lt(e,s){return this.url.searchParams.append(e,`lt.${s}`),this}lte(e,s){return this.url.searchParams.append(e,`lte.${s}`),this}like(e,s){return this.url.searchParams.append(e,`like.${s}`),this}likeAllOf(e,s){return this.url.searchParams.append(e,`like(all).{${s.join(",")}}`),this}likeAnyOf(e,s){return this.url.searchParams.append(e,`like(any).{${s.join(",")}}`),this}ilike(e,s){return this.url.searchParams.append(e,`ilike.${s}`),this}ilikeAllOf(e,s){return this.url.searchParams.append(e,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(e,s){return this.url.searchParams.append(e,`ilike(any).{${s.join(",")}}`),this}is(e,s){return this.url.searchParams.append(e,`is.${s}`),this}in(e,s){const n=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cs.{${s.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(s)}`),this}containedBy(e,s){return typeof s=="string"?this.url.searchParams.append(e,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(e,`cd.{${s.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(s)}`),this}rangeGt(e,s){return this.url.searchParams.append(e,`sr.${s}`),this}rangeGte(e,s){return this.url.searchParams.append(e,`nxl.${s}`),this}rangeLt(e,s){return this.url.searchParams.append(e,`sl.${s}`),this}rangeLte(e,s){return this.url.searchParams.append(e,`nxr.${s}`),this}rangeAdjacent(e,s){return this.url.searchParams.append(e,`adj.${s}`),this}overlaps(e,s){return typeof s=="string"?this.url.searchParams.append(e,`ov.${s}`):this.url.searchParams.append(e,`ov.{${s.join(",")}}`),this}textSearch(e,s,{config:n,type:a}={}){let r="";a==="plain"?r="pl":a==="phrase"?r="ph":a==="websearch"&&(r="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${r}fts${i}.${s}`),this}match(e){return Object.entries(e).forEach(([s,n])=>{this.url.searchParams.append(s,`eq.${n}`)}),this}not(e,s,n){return this.url.searchParams.append(e,`not.${s}.${n}`),this}or(e,{foreignTable:s,referencedTable:n=s}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,s,n){return this.url.searchParams.append(e,`${s}.${n}`),this}};ai.default=Zx;var Fx=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lo,"__esModule",{value:!0});const Pa=Fx(ai);let Wx=class{constructor(e,{headers:s={},schema:n,fetch:a}){this.url=e,this.headers=s,this.schema=n,this.fetch=a}select(e,{head:s=!1,count:n}={}){const a=s?"HEAD":"GET";let r=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!r?"":(l==='"'&&(r=!r),l)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new Pa.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:s,defaultToNull:n=!0}={}){const a="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),s&&r.push(`count=${s}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const i=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(i.length>0){const l=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Pa.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:s,ignoreDuplicates:n=!1,count:a,defaultToNull:r=!0}={}){const i="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),r||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Pa.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:s}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new Pa.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const s="DELETE",n=[];return e&&n.push(`count=${e}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Pa.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};lo.default=Wx;var fo={},ho={};Object.defineProperty(ho,"__esModule",{value:!0});ho.version=void 0;ho.version="0.0.0-automated";Object.defineProperty(fo,"__esModule",{value:!0});fo.DEFAULT_HEADERS=void 0;const ew=ho;fo.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ew.version}`};var Mp=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Bd,"__esModule",{value:!0});const tw=Mp(lo),sw=Mp(ai),nw=fo;let aw=class $p{constructor(e,{headers:s={},schema:n,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},nw.DEFAULT_HEADERS),s),this.schemaName=n,this.fetch=a}from(e){const s=new URL(`${this.url}/${e}`);return new tw.default(s,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new $p(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,s={},{head:n=!1,get:a=!1,count:r}={}){let i;const l=new URL(`${this.url}/rpc/${e}`);let c;n||a?(i=n?"HEAD":"GET",Object.entries(s).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{l.searchParams.append(d,f)})):(i="POST",c=s);const u=Object.assign({},this.headers);return r&&(u.Prefer=`count=${r}`),new sw.default({method:i,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Bd.default=aw;var Ca=Ot&&Ot.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(nt,"__esModule",{value:!0});nt.PostgrestError=nt.PostgrestBuilder=nt.PostgrestTransformBuilder=nt.PostgrestFilterBuilder=nt.PostgrestQueryBuilder=nt.PostgrestClient=void 0;const Up=Ca(Bd);nt.PostgrestClient=Up.default;const qp=Ca(lo);nt.PostgrestQueryBuilder=qp.default;const zp=Ca(ai);nt.PostgrestFilterBuilder=zp.default;const Lp=Ca(oo);nt.PostgrestTransformBuilder=Lp.default;const Bp=Ca(co);nt.PostgrestBuilder=Bp.default;const Hp=Ca(uo);nt.PostgrestError=Hp.default;var rw=nt.default={PostgrestClient:Up.default,PostgrestQueryBuilder:qp.default,PostgrestFilterBuilder:zp.default,PostgrestTransformBuilder:Lp.default,PostgrestBuilder:Bp.default,PostgrestError:Hp.default};const{PostgrestClient:iw,PostgrestQueryBuilder:T1,PostgrestFilterBuilder:O1,PostgrestTransformBuilder:R1,PostgrestBuilder:C1,PostgrestError:k1}=rw;function lw(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const ow=lw(),cw="2.11.15",uw=`realtime-js/${cw}`,dw="1.0.0",Gp=1e4,fw=1e3;var _r;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_r||(_r={}));var Ye;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Ye||(Ye={}));var $t;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})($t||($t={}));var yu;(function(t){t.websocket="websocket"})(yu||(yu={}));var nn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(nn||(nn={}));class hw{constructor(){this.HEADER_LENGTH=1}decode(e,s){return e.constructor===ArrayBuffer?s(this._binaryDecode(e)):s(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const s=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,s,n)}_decodeBroadcast(e,s,n){const a=s.getUint8(1),r=s.getUint8(2);let i=this.HEADER_LENGTH+2;const l=n.decode(e.slice(i,i+a));i=i+a;const c=n.decode(e.slice(i,i+r));i=i+r;const u=JSON.parse(n.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Pp{constructor(e,s){this.callback=e,this.timerCalc=s,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=s}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ce;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ce||(ce={}));const Xh=(t,e,s={})=>{var n;const a=(n=s.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((r,i)=>(r[i]=mw(i,t,e,a),r),{})},mw=(t,e,s,n)=>{const a=e.find(l=>l.name===t),r=a==null?void 0:a.type,i=s[t];return r&&!n.includes(r)?Xp(r,i):vu(i)},Xp=(t,e)=>{if(t.charAt(0)==="_"){const s=t.slice(1,t.length);return yw(e,s)}switch(t){case ce.bool:return gw(e);case ce.float4:case ce.float8:case ce.int2:case ce.int4:case ce.int8:case ce.numeric:case ce.oid:return pw(e);case ce.json:case ce.jsonb:return bw(e);case ce.timestamp:return vw(e);case ce.abstime:case ce.date:case ce.daterange:case ce.int4range:case ce.int8range:case ce.money:case ce.reltime:case ce.text:case ce.time:case ce.timestamptz:case ce.timetz:case ce.tsrange:case ce.tstzrange:return vu(e);default:return vu(e)}},vu=t=>t,gw=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},bw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},yw=(t,e)=>{if(typeof t!="string")return t;const s=t.length-1,n=t[s];if(t[0]==="{"&&n==="}"){let r;const i=t.slice(1,s);try{r=JSON.parse("["+i+"]")}catch{r=i?i.split(","):[]}return r.map(l=>Xp(e,l))}return t},vw=t=>typeof t=="string"?t.replace(" ","T"):t,Yp=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ic{constructor(e,s,n={},a=Gp){this.channel=e,this.event=s,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,s){var n;return this._hasReceived(e)&&s((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:s}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=s=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=s,this._matchReceive(s)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,s){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:s})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:s}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(s))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Yh;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Yh||(Yh={}));class xr{constructor(e,s){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(s==null?void 0:s.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:r,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xr.syncState(this.state,a,r,i),this.pendingDiffs.forEach(c=>{this.state=xr.syncDiff(this.state,c,r,i)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:r,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=xr.syncDiff(this.state,a,r,i),l())}),this.onJoin((a,r,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:r,newPresences:i})}),this.onLeave((a,r,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:r,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,s,n,a){const r=this.cloneDeep(e),i=this.transformState(s),l={},c={};return this.map(r,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=r[u];if(f){const h=d.map(N=>N.presence_ref),m=f.map(N=>N.presence_ref),x=d.filter(N=>m.indexOf(N.presence_ref)<0),w=f.filter(N=>h.indexOf(N.presence_ref)<0);x.length>0&&(l[u]=x),w.length>0&&(c[u]=w)}else l[u]=d}),this.syncDiff(r,{joins:l,leaves:c},n,a)}static syncDiff(e,s,n,a){const{joins:r,leaves:i}={joins:this.transformState(s.joins),leaves:this.transformState(s.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(r,(l,c)=>{var u;const d=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),d.length>0){const f=e[l].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);e[l].unshift(...h)}n(l,d,c)}),this.map(i,(l,c)=>{let u=e[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),e[l]=u,a(l,u,c),u.length===0&&delete e[l]}),e}static map(e,s){return Object.getOwnPropertyNames(e).map(n=>s(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((s,n)=>{const a=e[n];return"metas"in a?s[n]=a.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):s[n]=a,s},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ih;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Ih||(Ih={}));var Vh;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Vh||(Vh={}));var ts;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ts||(ts={}));class Hd{constructor(e,s={config:{}},n){this.topic=e,this.params=s,this.socket=n,this.bindings={},this.state=Ye.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},s.config),this.timeout=this.socket.timeout,this.joinPush=new ic(this,$t.join,this.params,this.timeout),this.rejoinTimer=new Pp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ye.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ye.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Ye.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ye.errored,this.rejoinTimer.scheduleTimeout())}),this._on($t.reply,{},(a,r)=>{this._trigger(this._replyEventName(r),a)}),this.presence=new xr(this),this.broadcastEndpointURL=Yp(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,s=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Ye.closed){const{config:{broadcast:r,presence:i,private:l}}=this.params;this._onError(d=>e==null?void 0:e(ts.CHANNEL_ERROR,d)),this._onClose(()=>e==null?void 0:e(ts.CLOSED));const c={},u={broadcast:r,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(d=>d.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},c)),this.joinedOnce=!0,this._rejoin(s),this.joinPush.receive("ok",async({postgres_changes:d})=>{var f;if(this.socket.setAuth(),d===void 0){e==null||e(ts.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,m=(f=h==null?void 0:h.length)!==null&&f!==void 0?f:0,x=[];for(let w=0;w<m;w++){const N=h[w],{filter:{event:y,schema:g,table:p,filter:b}}=N,A=d&&d[w];if(A&&A.event===y&&A.schema===g&&A.table===p&&A.filter===b)x.push(Object.assign(Object.assign({},N),{id:A.id}));else{this.unsubscribe(),this.state=Ye.errored,e==null||e(ts.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(ts.SUBSCRIBED);return}}).receive("error",d=>{this.state=Ye.errored,e==null||e(ts.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ts.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,s={}){return await this.send({type:"presence",event:"track",payload:e},s.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,s,n){return this._on(e,s,n)}async send(e,s={}){var n,a;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var i,l,c;const u=this._push(e.type,e,s.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&r("ok"),u.receive("ok",()=>r("ok")),u.receive("error",()=>r("error")),u.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ye.leaving;const s=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($t.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new ic(this,$t.leave,{},e),n.receive("ok",()=>{s(),a("ok")}).receive("timeout",()=>{s(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,s,n){const a=new AbortController,r=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(e,Object.assign(Object.assign({},s),{signal:a.signal}));return clearTimeout(r),i}_push(e,s,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ic(this,e,s,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,s,n){return s}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,s,n){var a,r;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=$t;if(n&&[l,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,s,n);if(s&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var x,w,N;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((N=(w=m.filter)===null||w===void 0?void 0:w.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(r=this.bindings[i])===null||r===void 0||r.filter(m=>{var x,w,N,y,g,p;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const b=m.id,A=(x=m.filter)===null||x===void 0?void 0:x.event;return b&&((w=s.ids)===null||w===void 0?void 0:w.includes(b))&&(A==="*"||(A==null?void 0:A.toLocaleLowerCase())===((N=s.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const b=(g=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return b==="*"||b===((p=s==null?void 0:s.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:w,table:N,commit_timestamp:y,type:g,errors:p}=x;h=Object.assign(Object.assign({},{schema:w,table:N,commit_timestamp:y,eventType:g,new:{},old:{},errors:p}),this._getPayloadRecords(x))}m.callback(h,n)})}_isClosed(){return this.state===Ye.closed}_isJoined(){return this.state===Ye.joined}_isJoining(){return this.state===Ye.joining}_isLeaving(){return this.state===Ye.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,s,n){const a=e.toLocaleLowerCase(),r={type:a,filter:s,callback:n};return this.bindings[a]?this.bindings[a].push(r):this.bindings[a]=[r],this}_off(e,s){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var r;return!(((r=a.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===n&&Hd.isEqual(a.filter,s))}),this}static isEqual(e,s){if(Object.keys(e).length!==Object.keys(s).length)return!1;for(const n in e)if(e[n]!==s[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($t.close,{},e)}_onError(e){this._on($t.error,{},s=>e(s))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ye.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const s={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(s.new=Xh(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(s.old=Xh(e.columns,e.old_record)),s}}const Qh=()=>{},_w=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class xw{constructor(e,s){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gp,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Qh,this.ref=0,this.logger=Qh,this.conn=null,this.sendBuffer=[],this.serializer=new hw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=r=>{let i;return r?i=r:typeof fetch>"u"?i=(...l)=>ni(async()=>{const{default:c}=await Promise.resolve().then(()=>Ra);return{default:c}},void 0).then(({default:c})=>c(...l)):i=fetch,(...l)=>i(...l)},this.endPoint=`${e}/${yu.websocket}`,this.httpEndpoint=Yp(e),s!=null&&s.transport?this.transport=s.transport:this.transport=null,s!=null&&s.params&&(this.params=s.params),s!=null&&s.timeout&&(this.timeout=s.timeout),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),s!=null&&s.heartbeatIntervalMs&&(this.heartbeatIntervalMs=s.heartbeatIntervalMs);const a=(n=s==null?void 0:s.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=s!=null&&s.reconnectAfterMs?s.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=s!=null&&s.encode?s.encode:(r,i)=>i(JSON.stringify(r)),this.decode=s!=null&&s.decode?s.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Pp(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(s==null?void 0:s.fetch),s!=null&&s.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(s==null?void 0:s.worker)||!1,this.workerUrl=s==null?void 0:s.workerUrl}this.accessToken=(s==null?void 0:s.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=ow),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dw}))}disconnect(e,s){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,s??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(e){const s=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),s}async removeAllChannels(){const e=await Promise.all(this.channels.map(s=>s.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,s,n){this.logger(e,s,n)}connectionState(){switch(this.conn&&this.conn.readyState){case _r.connecting:return nn.Connecting;case _r.open:return nn.Open;case _r.closing:return nn.Closing;default:return nn.Closed}}isConnected(){return this.connectionState()===nn.Open}channel(e,s={config:{}}){const n=`realtime:${e}`,a=this.getChannels().find(r=>r.topic===n);if(a)return a;{const r=new Hd(`realtime:${e}`,s,this);return this.channels.push(r),r}}push(e){const{topic:s,event:n,payload:a,ref:r}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${s} ${n} (${r})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let s=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=s&&(this.accessTokenValue=s,this.channels.forEach(n=>{const a={access_token:s,version:uw};s&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push($t.access_token,{access_token:s})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(fw,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let s=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));s&&(this.log("transport",`leaving duplicate topic "${e}"`),s.unsubscribe())}_remove(e){this.channels=this.channels.filter(s=>s.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,s=>{let{topic:n,event:a,payload:r,ref:i}=s;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(s.payload.status=="ok"?"ok":"error"),i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,r),Array.from(this.channels).filter(l=>l._isMember(n)).forEach(l=>l._trigger(a,r,i)),this.stateChangeCallbacks.message.forEach(l=>l(s))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=s=>{this.log("worker","worker error",s.message),this.workerRef.terminate()},this.workerRef.onmessage=s=>{s.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(s=>s(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(s=>s(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger($t.error))}_appendParams(e,s){if(Object.keys(s).length===0)return e;const n=e.match(/\?/)?"&":"?",a=new URLSearchParams(s);return`${e}${n}${a}`}_workerObjectUrl(e){let s;if(e)s=e;else{const n=new Blob([_w],{type:"application/javascript"});s=URL.createObjectURL(n)}return s}}class Gd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function De(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class ww extends Gd{constructor(e,s,n){super(e),this.name="StorageApiError",this.status=s,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class _u extends Gd{constructor(e,s){super(e),this.name="StorageUnknownError",this.originalError=s}}var Sw=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Ip=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>ni(async()=>{const{default:n}=await Promise.resolve().then(()=>Ra);return{default:n}},void 0).then(({default:n})=>n(...s)):e=fetch,(...s)=>e(...s)},jw=()=>Sw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ni(()=>Promise.resolve().then(()=>Ra),void 0)).Response:Response}),xu=t=>{if(Array.isArray(t))return t.map(s=>xu(s));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([s,n])=>{const a=s.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[a]=xu(n)}),e},Nw=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var jn=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const lc=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ew=(t,e,s)=>jn(void 0,void 0,void 0,function*(){const n=yield jw();t instanceof n&&!(s!=null&&s.noResolveJson)?t.json().then(a=>{const r=t.status||500,i=(a==null?void 0:a.statusCode)||r+"";e(new ww(lc(a),r,i))}).catch(a=>{e(new _u(lc(a),a))}):e(new _u(lc(t),t))}),Aw=(t,e,s,n)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?a:(Nw(n)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),s))};function ri(t,e,s,n,a,r){return jn(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(s,Aw(e,n,a,r)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Ew(c,l,n))})})}function Dl(t,e,s,n){return jn(this,void 0,void 0,function*(){return ri(t,"GET",e,s,n)})}function ss(t,e,s,n,a){return jn(this,void 0,void 0,function*(){return ri(t,"POST",e,n,a,s)})}function wu(t,e,s,n,a){return jn(this,void 0,void 0,function*(){return ri(t,"PUT",e,n,a,s)})}function Tw(t,e,s,n){return jn(this,void 0,void 0,function*(){return ri(t,"HEAD",e,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)})}function Vp(t,e,s,n,a){return jn(this,void 0,void 0,function*(){return ri(t,"DELETE",e,n,a,s)})}var Fe=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Ow={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Rw{constructor(e,s={},n,a){this.url=e,this.headers=s,this.bucketId=n,this.fetch=Ip(a)}uploadOrUpdate(e,s,n,a){return Fe(this,void 0,void 0,function*(){try{let r;const i=Object.assign(Object.assign({},Jh),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(r=new FormData,r.append("cacheControl",i.cacheControl),c&&r.append("metadata",this.encodeMetadata(c)),r.append("",n)):typeof FormData<"u"&&n instanceof FormData?(r=n,r.append("cacheControl",i.cacheControl),c&&r.append("metadata",this.encodeMetadata(c))):(r=n,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const u=this._removeEmptyFolders(s),d=this._getFinalPath(u),f=yield(e=="PUT"?wu:ss)(this.fetch,`${this.url}/object/${d}`,r,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}})}upload(e,s,n){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,s,n)})}uploadToSignedUrl(e,s,n,a){return Fe(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),i=this._getFinalPath(r),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",s);try{let c;const u=Object.assign({upsert:Jh.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield wu(this.fetch,l.toString(),c,{headers:d});return{data:{path:r,fullPath:f.Key},error:null}}catch(c){if(De(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,s){return Fe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const a=Object.assign({},this.headers);s!=null&&s.upsert&&(a["x-upsert"]="true");const r=yield ss(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+r.url),l=i.searchParams.get("token");if(!l)throw new Gd("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}update(e,s,n){return Fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,s,n)})}move(e,s,n){return Fe(this,void 0,void 0,function*(){try{return{data:yield ss(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(De(a))return{data:null,error:a};throw a}})}copy(e,s,n){return Fe(this,void 0,void 0,function*(){try{return{data:{path:(yield ss(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:s,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(De(a))return{data:null,error:a};throw a}})}createSignedUrl(e,s,n){return Fe(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),r=yield ss(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:s},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${i}`)},{data:r,error:null}}catch(a){if(De(a))return{data:null,error:a};throw a}})}createSignedUrls(e,s,n){return Fe(this,void 0,void 0,function*(){try{const a=yield ss(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:s,paths:e},{headers:this.headers}),r=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${r}`):null})),error:null}}catch(a){if(De(a))return{data:null,error:a};throw a}})}download(e,s){return Fe(this,void 0,void 0,function*(){const a=typeof(s==null?void 0:s.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((s==null?void 0:s.transform)||{}),i=r?`?${r}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Dl(this.fetch,`${this.url}/${a}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(De(l))return{data:null,error:l};throw l}})}info(e){return Fe(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{const n=yield Dl(this.fetch,`${this.url}/object/info/${s}`,{headers:this.headers});return{data:xu(n),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}exists(e){return Fe(this,void 0,void 0,function*(){const s=this._getFinalPath(e);try{return yield Tw(this.fetch,`${this.url}/object/${s}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(De(n)&&n instanceof _u){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,s){const n=this._getFinalPath(e),a=[],r=s!=null&&s.download?`download=${s.download===!0?"":s.download}`:"";r!==""&&a.push(r);const l=typeof(s==null?void 0:s.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((s==null?void 0:s.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return Fe(this,void 0,void 0,function*(){try{return{data:yield Vp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}list(e,s,n){return Fe(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ow),s),{prefix:e||""});return{data:yield ss(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(De(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const s=[];return e.width&&s.push(`width=${e.width}`),e.height&&s.push(`height=${e.height}`),e.resize&&s.push(`resize=${e.resize}`),e.format&&s.push(`format=${e.format}`),e.quality&&s.push(`quality=${e.quality}`),s.join("&")}}const Cw="2.10.4",kw={"X-Client-Info":`storage-js/${Cw}`};var An=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class Dw{constructor(e,s={},n,a){const r=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href,this.headers=Object.assign(Object.assign({},kw),s),this.fetch=Ip(n)}listBuckets(){return An(this,void 0,void 0,function*(){try{return{data:yield Dl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(De(e))return{data:null,error:e};throw e}})}getBucket(e){return An(this,void 0,void 0,function*(){try{return{data:yield Dl(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}createBucket(e,s={public:!1}){return An(this,void 0,void 0,function*(){try{return{data:yield ss(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}updateBucket(e,s){return An(this,void 0,void 0,function*(){try{return{data:yield wu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}})}emptyBucket(e){return An(this,void 0,void 0,function*(){try{return{data:yield ss(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}deleteBucket(e){return An(this,void 0,void 0,function*(){try{return{data:yield Vp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(s){if(De(s))return{data:null,error:s};throw s}})}}class Mw extends Dw{constructor(e,s={},n,a){super(e,s,n,a)}from(e){return new Rw(this.url,this.headers,e,this.fetch)}}const $w="2.53.0";let Ja="";typeof Deno<"u"?Ja="deno":typeof document<"u"?Ja="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ja="react-native":Ja="node";const Uw={"X-Client-Info":`supabase-js-${Ja}/${$w}`},qw={headers:Uw},zw={schema:"public"},Lw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Bw={};var Hw=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Gw=t=>{let e;return t?e=t:typeof fetch>"u"?e=Cp:e=fetch,(...s)=>e(...s)},Pw=()=>typeof Headers>"u"?kp:Headers,Xw=(t,e,s)=>{const n=Gw(s),a=Pw();return(r,i)=>Hw(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new a(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(r,Object.assign(Object.assign({},i),{headers:u}))})};var Yw=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};function Iw(t){return t.endsWith("/")?t:t+"/"}function Vw(t,e){var s,n;const{db:a,auth:r,realtime:i,global:l}=t,{db:c,auth:u,realtime:d,global:f}=e,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),r),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(s=f==null?void 0:f.headers)!==null&&s!==void 0?s:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Yw(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}const Qp="2.71.1",Ln=30*1e3,Su=3,oc=Su*Ln,Qw="http://localhost:9999",Jw="supabase.auth.token",Kw={"X-Client-Info":`gotrue-js/${Qp}`},ju="X-Supabase-Api-Version",Jp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Fw=10*60*1e3;class Pd extends Error{constructor(e,s,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=s,this.code=n}}function Q(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Ww extends Pd{constructor(e,s,n){super(e,s,n),this.name="AuthApiError",this.status=s,this.code=n}}function eS(t){return Q(t)&&t.name==="AuthApiError"}class Kp extends Pd{constructor(e,s){super(e),this.name="AuthUnknownError",this.originalError=s}}class Qs extends Pd{constructor(e,s,n,a){super(e,n,a),this.name=s,this.status=n}}class Ss extends Qs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function tS(t){return Q(t)&&t.name==="AuthSessionMissingError"}class Ni extends Qs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ei extends Qs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ai extends Qs{constructor(e,s=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sS(t){return Q(t)&&t.name==="AuthImplicitGrantRedirectError"}class Kh extends Qs{constructor(e,s=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=s}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nu extends Qs{constructor(e,s){super(e,"AuthRetryableFetchError",s,void 0)}}function cc(t){return Q(t)&&t.name==="AuthRetryableFetchError"}class Zh extends Qs{constructor(e,s,n){super(e,"AuthWeakPasswordError",s,"weak_password"),this.reasons=n}}class Eu extends Qs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ml="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Fh=` 	
\r=`.split(""),nS=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Fh.length;e+=1)t[Fh[e].charCodeAt(0)]=-2;for(let e=0;e<Ml.length;e+=1)t[Ml[e].charCodeAt(0)]=e;return t})();function Wh(t,e,s){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;s(Ml[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;s(Ml[n]),e.queuedBits-=6}}function Zp(t,e,s){const n=nS[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)s(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function em(t){const e=[],s=i=>{e.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},r=i=>{iS(i,n,s)};for(let i=0;i<t.length;i+=1)Zp(t.charCodeAt(i),a,r);return e.join("")}function aS(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function rS(t,e){for(let s=0;s<t.length;s+=1){let n=t.charCodeAt(s);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(t.charCodeAt(s+1)-56320&65535|a)+65536,s+=1}aS(n,e)}}function iS(t,e,s){if(e.utf8seq===0){if(t<=127){s(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&s(e.codepoint)}}function lS(t){const e=[],s={queue:0,queuedBits:0},n=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)Zp(t.charCodeAt(a),s,n);return new Uint8Array(e)}function oS(t){const e=[];return rS(t,s=>e.push(s)),new Uint8Array(e)}function cS(t){const e=[],s={queue:0,queuedBits:0},n=a=>{e.push(a)};return t.forEach(a=>Wh(a,s,n)),Wh(null,s,n),e.join("")}function uS(t){return Math.round(Date.now()/1e3)+t}function dS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const kt=()=>typeof window<"u"&&typeof document<"u",Ks={tested:!1,writable:!1},Fp=()=>{if(!kt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ks.tested)return Ks.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ks.tested=!0,Ks.writable=!0}catch{Ks.tested=!0,Ks.writable=!1}return Ks.writable};function fS(t){const e={},s=new URL(t);if(s.hash&&s.hash[0]==="#")try{new URLSearchParams(s.hash.substring(1)).forEach((a,r)=>{e[r]=a})}catch{}return s.searchParams.forEach((n,a)=>{e[a]=n}),e}const Wp=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...s)=>ni(async()=>{const{default:n}=await Promise.resolve().then(()=>Ra);return{default:n}},void 0).then(({default:n})=>n(...s)):e=fetch,(...s)=>e(...s)},hS=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Bn=async(t,e,s)=>{await t.setItem(e,JSON.stringify(s))},Zs=async(t,e)=>{const s=await t.getItem(e);if(!s)return null;try{return JSON.parse(s)}catch{return s}},vs=async(t,e)=>{await t.removeItem(e)};class mo{constructor(){this.promise=new mo.promiseConstructor((e,s)=>{this.resolve=e,this.reject=s})}}mo.promiseConstructor=Promise;function uc(t){const e=t.split(".");if(e.length!==3)throw new Eu("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!Zw.test(e[n]))throw new Eu("JWT not in base64url format");return{header:JSON.parse(em(e[0])),payload:JSON.parse(em(e[1])),signature:lS(e[2]),raw:{header:e[0],payload:e[1]}}}async function mS(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function gS(t,e){return new Promise((n,a)=>{(async()=>{for(let r=0;r<1/0;r++)try{const i=await t(r);if(!e(r,null,i)){n(i);return}}catch(i){if(!e(r,i)){a(i);return}}})()})}function pS(t){return("0"+t.toString(16)).substr(-2)}function bS(){const e=new Uint32Array(56);if(typeof crypto>"u"){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=s.length;let a="";for(let r=0;r<56;r++)a+=s.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(e),Array.from(e,pS).join("")}async function yS(t){const s=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",s),a=new Uint8Array(n);return Array.from(a).map(r=>String.fromCharCode(r)).join("")}async function vS(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const s=await yS(t);return btoa(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Tn(t,e,s=!1){const n=bS();let a=n;s&&(a+="/PASSWORD_RECOVERY"),await Bn(t,`${e}-code-verifier`,a);const r=await vS(n);return[r,n===r?"plain":"s256"]}const _S=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function xS(t){const e=t.headers.get(ju);if(!e||!e.match(_S))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function wS(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function SS(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jS=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function On(t){if(!jS.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dc(){const t={};return new Proxy(t,{get:(e,s)=>{if(s==="__isUserNotAvailableProxy")return!0;if(typeof s=="symbol"){const n=s.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${s}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,s)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${s}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tm(t){return JSON.parse(JSON.stringify(t))}var NS=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]]);return s};const tn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ES=[502,503,504];async function sm(t){var e;if(!hS(t))throw new Nu(tn(t),0);if(ES.includes(t.status))throw new Nu(tn(t),t.status);let s;try{s=await t.json()}catch(r){throw new Kp(tn(r),r)}let n;const a=xS(t);if(a&&a.getTime()>=Jp["2024-01-01"].timestamp&&typeof s=="object"&&s&&typeof s.code=="string"?n=s.code:typeof s=="object"&&s&&typeof s.error_code=="string"&&(n=s.error_code),n){if(n==="weak_password")throw new Zh(tn(s),t.status,((e=s.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ss}else if(typeof s=="object"&&s&&typeof s.weak_password=="object"&&s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.reasons.reduce((r,i)=>r&&typeof i=="string",!0))throw new Zh(tn(s),t.status,s.weak_password.reasons);throw new Ww(tn(s),t.status||500,n)}const AS=(t,e,s,n)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),s))};async function Z(t,e,s,n){var a;const r=Object.assign({},n==null?void 0:n.headers);r[ju]||(r[ju]=Jp["2024-01-01"].name),n!=null&&n.jwt&&(r.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await TS(t,e,s+l,{headers:r,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function TS(t,e,s,n,a,r){const i=AS(e,n,a,r);let l;try{l=await t(s,Object.assign({},i))}catch(c){throw console.error(c),new Nu(tn(c),0)}if(l.ok||await sm(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await sm(c)}}function Wt(t){var e;let s=null;kS(t)&&(s=Object.assign({},t),t.expires_at||(s.expires_at=uS(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:s,user:n},error:null}}function nm(t){const e=Wt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((s,n)=>s&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Rs(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function OS(t){return{data:t,error:null}}function RS(t){const{action_link:e,email_otp:s,hashed_token:n,redirect_to:a,verification_type:r}=t,i=NS(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:s,hashed_token:n,redirect_to:a,verification_type:r},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function CS(t){return t}function kS(t){return t.access_token&&t.refresh_token&&t.expires_in}const fc=["global","local","others"];var DS=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]]);return s};class MS{constructor({url:e="",headers:s={},fetch:n}){this.url=e,this.headers=s,this.fetch=Wp(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,s=fc[0]){if(fc.indexOf(s)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fc.join(", ")}`);try{return await Z(this.fetch,"POST",`${this.url}/logout?scope=${s}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,s={}){try{return await Z(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:s.data},headers:this.headers,redirectTo:s.redirectTo,xform:Rs})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:s}=e,n=DS(e,["options"]),a=Object.assign(Object.assign({},n),s);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:RS,redirectTo:s==null?void 0:s.redirectTo})}catch(s){if(Q(s))return{data:{properties:null,user:null},error:s};throw s}}async createUser(e){try{return await Z(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Rs})}catch(s){if(Q(s))return{data:{user:null},error:s};throw s}}async listUsers(e){var s,n,a,r,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(s=e==null?void 0:e.page)===null||s===void 0?void 0:s.toString())!==null&&n!==void 0?n:"",per_page:(r=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:""},xform:CS});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const w=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(x.split(";")[1].split("=")[1]);u[`${N}Page`]=w}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Q(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){On(e);try{return await Z(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Rs})}catch(s){if(Q(s))return{data:{user:null},error:s};throw s}}async updateUserById(e,s){On(e);try{return await Z(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:s,headers:this.headers,xform:Rs})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,s=!1){On(e);try{return await Z(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:s},xform:Rs})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){On(e.userId);try{const{data:s,error:n}=await Z(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:s,error:n}}catch(s){if(Q(s))return{data:null,error:s};throw s}}async _deleteFactor(e){On(e.userId),On(e.id);try{return{data:await Z(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}}}function am(t={}){return{getItem:e=>t[e]||null,setItem:(e,s)=>{t[e]=s},removeItem:e=>{delete t[e]}}}function $S(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Rn={debug:!!(globalThis&&Fp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class eb extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class US extends eb{}async function qS(t,e,s){Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await s()}finally{Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Rn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new US(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Rn.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}}))}$S();const zS={url:Qw,storageKey:Jw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Kw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rm(t,e,s){return await s()}const Cn={};class Lr{constructor(e){var s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Lr.nextInstanceID,Lr.nextInstanceID+=1,this.instanceID>0&&kt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},zS),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new MS({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Wp(a.fetch),this.lock=a.lock||rm,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:kt()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=qS:this.lock=rm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Fp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=am(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=am(this.memoryStorage)),kt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}get jwks(){var e,s;return(s=(e=Cn[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&s!==void 0?s:{keys:[]}}set jwks(e){Cn[this.storageKey]=Object.assign(Object.assign({},Cn[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,s;return(s=(e=Cn[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&s!==void 0?s:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Cn[this.storageKey]=Object.assign(Object.assign({},Cn[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Qp}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const s=fS(window.location.href);let n="none";if(this._isImplicitGrantCallback(s)?n="implicit":await this._isPKCECallback(s)&&(n="pkce"),kt()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:r}=await this._getSessionFromURL(s,n);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),sS(r)){const c=(e=r.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:i,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(s){return Q(s)?{error:s}:{error:new Kp("Unexpected error during initialization",s)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var s,n,a;try{const r=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Wt}),{data:i,error:l}=r;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(Q(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var s,n,a;try{let r;if("email"in e){const{email:d,password:f,options:h}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Tn(this.storage,this.storageKey)),r=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Wt})}else if("phone"in e){const{phone:d,password:f,options:h}=e;r=await Z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Wt})}else throw new Ei("You must provide either an email or phone number and a password");const{data:i,error:l}=r;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(r){if(Q(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let s;if("email"in e){const{email:r,password:i,options:l}=e;s=await Z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:nm})}else if("phone"in e){const{phone:r,password:i,options:l}=e;s=await Z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:nm})}else throw new Ei("You must provide either an email or phone number and a password");const{data:n,error:a}=s;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ni}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(s){if(Q(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOAuth(e){var s,n,a,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(s=e.options)===null||s===void 0?void 0:s.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:s}=e;if(s==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${s}"`)}async signInWithSolana(e){var s,n,a,r,i,l,c,u,d,f,h,m;let x,w;if("message"in e)x=e.message,w=e.signature;else{const{chain:N,wallet:y,statement:g,options:p}=e;let b;if(kt())if(typeof y=="object")b=y;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))b=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=y}const A=new URL((s=p==null?void 0:p.url)!==null&&s!==void 0?s:window.location.href);if("signIn"in b&&b.signIn){const O=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),g?{statement:g}:null));let T;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")T=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)T=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)x=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),w=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${A.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(a=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((r=p==null?void 0:p.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((u=p==null?void 0:p.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((f=(d=p==null?void 0:p.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...p.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const O=await b.signMessage(new TextEncoder().encode(x),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=O}}try{const{data:N,error:y}=await Z(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:cS(w)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Wt});if(y)throw y;return!N||!N.session||!N.user?{data:{user:null,session:null},error:new Ni}:(N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),{data:Object.assign({},N),error:y})}catch(N){if(Q(N))return{data:{user:null,session:null},error:N};throw N}}async _exchangeCodeForSession(e){const s=await Zs(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(s??"").split("/");try{const{data:r,error:i}=await Z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Wt});if(await vs(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new Ni}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:a??null}),error:i})}catch(r){if(Q(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:s,provider:n,token:a,access_token:r,nonce:i}=e,l=await Z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:r,nonce:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:Wt}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ni}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(s){if(Q(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(e){var s,n,a,r,i;try{if("email"in e){const{email:l,options:c}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Tn(this.storage,this.storageKey));const{error:f}=await Z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:d}=await Z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new Ei("You must provide either an email or phone number.")}catch(l){if(Q(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var s,n;try{let a,r;"options"in e&&(a=(s=e.options)===null||s===void 0?void 0:s.redirectTo,r=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:l}=await Z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:a,xform:Wt});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Q(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var s,n,a;try{let r=null,i=null;return this.flowType==="pkce"&&([r,i]=await Tn(this.storage,this.storageKey)),await Z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(s=e.options)===null||s===void 0?void 0:s.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:i}),headers:this.headers,xform:OS})}catch(r){if(Q(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:s},error:n}=e;if(n)throw n;if(!s)throw new Ss;const{error:a}=await Z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Q(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const s=`${this.url}/resend`;if("email"in e){const{email:n,type:a,options:r}=e,{error:i}=await Z(this.fetch,"POST",s,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:n,type:a,options:r}=e,{data:i,error:l}=await Z(this.fetch,"POST",s,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new Ei("You must provide either an email or phone number and a type")}catch(s){if(Q(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(e,s){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await s()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=s();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await e(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const s=await Zs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?e=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<oc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const i=await Zs(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=dc()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:e},error:null}}const{session:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Rs}):await this._useSession(async s=>{var n,a,r;const{data:i,error:l}=s;if(l)throw l;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ss}:await Z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&r!==void 0?r:void 0,xform:Rs})})}catch(s){if(Q(s))return tS(s)&&(await this._removeSession(),await vs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(e,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,s))}async _updateUser(e,s={}){try{return await this._useSession(async n=>{const{data:a,error:r}=n;if(r)throw r;if(!a.session)throw new Ss;const i=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Tn(this.storage,this.storageKey));const{data:u,error:d}=await Z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Rs});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Q(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ss;const s=Date.now()/1e3;let n=s,a=!0,r=null;const{payload:i}=uc(e.access_token);if(i.exp&&(n=i.exp,a=n<=s),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};r=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;r={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-s,expires_at:n},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(s){if(Q(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async s=>{var n;if(!e){const{data:i,error:l}=s;if(l)throw l;e=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ss;const{session:a,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(Q(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(e,s){try{if(!kt())throw new Ai("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ai(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new Kh("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ai("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Kh("No code detected.");const{data:g,error:p}=await this._exchangeCodeForSession(e.code);if(p)throw p;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:r,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=e;if(!r||!l||!i||!u)throw new Ai("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=Ln&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const x=h-f;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,d);const{data:w,error:N}=await this._getUser(r);if(N)throw N;const y={provider_token:n,provider_refresh_token:a,access_token:r,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(n){if(Q(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const s=await Zs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&s)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async s=>{var n;const{data:a,error:r}=s;if(r)return{error:r};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(eS(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await vs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const s=dS(),n={id:s,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async s=>{var n,a;try{const{data:{session:r},error:i}=s;if(i)throw i;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,s={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Tn(this.storage,this.storageKey,!0));try{return await Z(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(r){if(Q(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:s,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=s.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(s){if(Q(s))return{data:null,error:s};throw s}}async linkIdentity(e){var s;try{const{data:n,error:a}=await this._useSession(async r=>{var i,l,c,u,d;const{data:f,error:h}=r;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Z(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return kt()&&!(!((s=e.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Q(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async s=>{var n,a;const{data:r,error:i}=s;if(i)throw i;return await Z(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(s){if(Q(s))return{data:null,error:s};throw s}}async _refreshAccessToken(e){const s=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{const n=Date.now();return await gS(async a=>(a>0&&await mS(200*Math.pow(2,a-1)),this._debug(s,"refreshing attempt",a),await Z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Wt})),(a,r)=>{const i=200*Math.pow(2,a);return r&&cc(r)&&Date.now()+i-n<Ln})}catch(n){if(this._debug(s,"error",n),Q(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(s,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,s){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",s,"url",n),kt()&&!s.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,s;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Zs(this.storage,this.storageKey);if(a&&this.userStorage){let i=await Zs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await Bn(this.userStorage,this.storageKey+"-user",i)),a.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:dc()}else if(a&&!a.user&&!a.user){const i=await Zs(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await vs(this.storage,this.storageKey+"-user"),await Bn(this.storage,this.storageKey,a)):a.user=dc()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const r=((s=a.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<oc;if(this._debug(n,`session has${r?"":" not"} expired with margin of ${oc}s`),r){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),cc(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(a.access_token);!l&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var s,n;if(!e)throw new Ss;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new mo;const{data:r,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!r.session)throw new Ss;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const l={session:r.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(r){if(this._debug(a,"error",r),Q(r)){const i={session:null,error:r};return cc(r)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(r),r}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,s,n=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",s,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:s});const r=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,s)}catch(c){r.push(c)}});if(await Promise.all(i),r.length>0){for(let l=0;l<r.length;l+=1)console.error(r[l]);throw r[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const s=Object.assign({},e),n=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&s.user&&await Bn(this.userStorage,this.storageKey+"-user",{user:s.user});const a=Object.assign({},s);delete a.user;const r=tm(a);await Bn(this.storage,this.storageKey,r)}else{const a=tm(s);await Bn(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await vs(this.storage,this.storageKey),await vs(this.storage,this.storageKey+"-code-verifier"),await vs(this.storage,this.storageKey+"-user"),this.userStorage&&await vs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&kt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ln);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async s=>{const{data:{session:n}}=s;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-e)/Ln);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ln}ms, refresh threshold is ${Su} ticks`),a<=Su&&await this._callRefreshToken(n.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof eb)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const s=`#_onVisibilityChanged(${e})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,s,n){const a=[`provider=${encodeURIComponent(s)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[r,i]=await Tn(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const r=new URLSearchParams(n.queryParams);a.push(r.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async s=>{var n;const{data:a,error:r}=s;return r?{data:null,error:r}:await Z(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(s){if(Q(s))return{data:null,error:s};throw s}}async _enroll(e){try{return await this._useSession(async s=>{var n,a;const{data:r,error:i}=s;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await Z(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=r==null?void 0:r.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(s){if(Q(s))return{data:null,error:s};throw s}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:a,error:r}=s;if(r)return{data:null,error:r};const{data:i,error:l}=await Z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(s){if(Q(s))return{data:null,error:s};throw s}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var n;const{data:a,error:r}=s;return r?{data:null,error:r}:await Z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(s){if(Q(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(e){const{data:s,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:s.id,code:e.code})}async _listFactors(){const{data:{user:e},error:s}=await this.getUser();if(s)return{data:null,error:s};const n=(e==null?void 0:e.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),r=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var s,n;const{data:{session:a},error:r}=e;if(r)return{data:null,error:r};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=uc(a.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((n=(s=a.user.factors)===null||s===void 0?void 0:s.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,s={keys:[]}){let n=s.keys.find(l=>l.kid===e);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+Fw>a)return n;const{data:r,error:i}=await Z(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=a,n=r.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,s={}){try{let n=e;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};n=m.session.access_token}const{header:a,payload:r,signature:i,raw:{header:l,payload:c}}=uc(n);s!=null&&s.allowExpired||wS(r.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:r,header:a,signature:i},error:null}}const d=SS(a.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,oS(`${l}.${c}`)))throw new Eu("Invalid JWT signature");return{data:{claims:r,header:a,signature:i},error:null}}catch(n){if(Q(n))return{data:null,error:n};throw n}}}Lr.nextInstanceID=0;const LS=Lr;class BS extends LS{constructor(e){super(e)}}var HS=function(t,e,s,n){function a(r){return r instanceof s?r:new s(function(i){i(r)})}return new(s||(s=Promise))(function(r,i){function l(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?r(d.value):a(d.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class GS{constructor(e,s,n){var a,r,i;if(this.supabaseUrl=e,this.supabaseKey=s,!e)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const l=Iw(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:zw,realtime:Bw,auth:Object.assign(Object.assign({},Lw),{storageKey:u}),global:qw},f=Vw(n??{},d);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(r=f.global.headers)!==null&&r!==void 0?r:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(h,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=Xw(s,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new iw(new URL("rest/v1",c).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new Mw(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Ux(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,s={},n={}){return this.rest.rpc(e,s,n)}channel(e,s={config:{}}){return this.realtime.channel(e,s)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,s;return HS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(s=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:s,detectSessionInUrl:n,storage:a,storageKey:r,flowType:i,lock:l,debug:c},u,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BS({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:r,autoRefreshToken:e,persistSession:s,detectSessionInUrl:n,storage:a,flowType:i,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new xw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,n)=>{this._handleTokenChanged(s,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,s,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const PS=(t,e,s)=>new GS(t,e,s);function XS(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}XS()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const YS="https://dfdyqdkadnzeaarepdjj.supabase.co",IS="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRmZHlxZGthZG56ZWFhcmVwZGpqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2NTQ3ODMsImV4cCI6MjA3MTIzMDc4M30.8ZvJpiR7uSLrk-E6jZ26Avb4GpPKE_BaJxLZfLs8WvE",je=PS(YS,IS),ka=()=>{const[t,e]=U.useState({isAuthenticated:!1,user:null,role:null});return U.useEffect(()=>{const r=localStorage.getItem("studyspark-auth");if(r)try{const i=JSON.parse(r);e(i)}catch(i){console.error("Failed to parse saved auth state:",i),localStorage.removeItem("studyspark-auth")}},[]),{...t,login:r=>{const i={isAuthenticated:!0,user:r,role:null};e(i),localStorage.setItem("studyspark-auth",JSON.stringify(i))},selectRole:r=>{const i={...t,role:r};e(i),localStorage.setItem("studyspark-auth",JSON.stringify(i))},logout:()=>{e({isAuthenticated:!1,user:null,role:null}),localStorage.removeItem("studyspark-auth")}}};function VS(){const{user:t}=ka(),[e,s]=U.useState(""),[n,a]=U.useState(""),[r,i]=U.useState("class"),[l,c]=U.useState(""),[u,d]=U.useState(""),[f,h]=U.useState(""),[m,x]=U.useState(""),[w,N]=U.useState(!1),[y,g]=U.useState(""),[p,b]=U.useState("success"),[A,O]=U.useState([]),[T,v]=U.useState(1);U.useEffect(()=>{const S=new Date().toLocaleDateString("sv-SE");s(S)},[]),U.useEffect(()=>{e&&n&&r&&(t!=null&&t.id)?C():(O([]),v(1))},[e,n,r,t==null?void 0:t.id]);const C=async()=>{if(t!=null&&t.id)try{const{data:S,error:q}=await je.from("study_records").select("*").eq("student_id",t.id).eq("study_date",e).eq("subject",n).eq("content_type",r).order("attempt_number",{ascending:!0});if(q)throw q;O(S||[]),v(((S==null?void 0:S.length)||0)+1)}catch(S){console.error("履歴取得エラー:",S)}},j=async S=>{if(S.preventDefault(),!(t!=null&&t.id)){g("ユーザー情報が取得できません"),b("error");return}if(!e||!n||!r||!l||!u||!f){g("すべての項目を入力してください"),b("error");return}const q=parseInt(l),G=parseInt(u);if(isNaN(q)||isNaN(G)||q<=0||G<0||G>q){g("問題数と正解数を正しく入力してください"),b("error");return}try{N(!0),g("");const $=new Date().toISOString(),{error:B}=await je.from("study_records").insert([{student_id:t.id,date:$,study_date:e,subject:n,content_type:r,attempt_number:T,questions_total:q,questions_correct:G,emotion:f,comment:m.trim()||null}]);if(B)throw B;g("✅ 学習記録を保存しました！"),b("success"),c(""),d(""),h(""),x("")}catch(_){console.error("❌ 保存エラー:",_),g("保存に失敗しました。もう一度お試しください。"),b("error")}finally{N(!1)}},R=S=>({aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"})[S]||S,M=S=>S.length===0?"":S.map(q=>`${q.questions_correct}/${q.questions_total}`).join(" → ");return o.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"harmonious-header-1",children:"📝 学習記録"}),o.jsx("p",{className:"harmonious-text-lg",children:"今日のがんばりを記録しよう！"})]}),A.length>0&&o.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:[o.jsx("h3",{className:"font-bold text-blue-800 mb-2",children:"📚 この学習内容の履歴"}),o.jsxs("div",{className:"text-blue-700",children:[o.jsxs("div",{className:"font-medium",children:[R(n),"（",r==="class"?"授業":"宿題","） - ",new Date(e).toLocaleDateString("ja-JP"),"実施分"]}),o.jsxs("div",{className:"text-lg mt-1",children:["これまでの成績: ",M(A)]}),o.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:["今回は",T,"回目の挑戦です"]})]})]}),o.jsxs("form",{onSubmit:j,className:"space-y-6",children:[o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"📅 いつの学習内容ですか？"}),o.jsx("input",{type:"date",value:e,onChange:S=>s(S.target.value),max:new Date().toLocaleDateString("sv-SE"),className:"w-full text-lg p-4 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",required:!0}),o.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"今日復習した学習内容が、いつ実施されたものかを選択してください"})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"📚 科目を選択"}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[{key:"aptitude",label:"適性",icon:"🧠",color:"purple"},{key:"japanese",label:"国語",icon:"📚",color:"rose"},{key:"math",label:"算数",icon:"🔢",color:"blue"},{key:"science",label:"理科",icon:"🔬",color:"green"},{key:"social",label:"社会",icon:"🌍",color:"amber"}].map(S=>o.jsxs("button",{type:"button",onClick:()=>a(S.key),className:`p-4 rounded-xl border-2 transition-all font-medium ${n===S.key?S.color==="purple"?"border-purple-400 bg-purple-50 text-purple-700":S.color==="rose"?"border-rose-400 bg-rose-50 text-rose-700":S.color==="blue"?"border-blue-400 bg-blue-50 text-blue-700":S.color==="green"?"border-green-400 bg-green-50 text-green-700":S.color==="amber"?"border-amber-400 bg-amber-50 text-amber-700":"border-blue-400 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[o.jsx("div",{className:"text-2xl mb-1",children:S.icon}),o.jsx("div",{className:"text-sm",children:S.label})]},S.key))})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"🎯 授業？宿題？"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("button",{type:"button",onClick:()=>i("class"),className:`p-4 rounded-xl border-2 transition-all font-medium ${r==="class"?"border-blue-400 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"🏫"}),o.jsx("div",{className:"font-bold",children:"授業"}),o.jsx("div",{className:"text-sm",children:"授業で習った内容"})]}),o.jsxs("button",{type:"button",onClick:()=>i("homework"),className:`p-4 rounded-xl border-2 transition-all font-medium ${r==="homework"?"border-orange-400 bg-orange-50 text-orange-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:"📝"}),o.jsx("div",{className:"font-bold",children:"宿題"}),o.jsx("div",{className:"text-sm",children:"宿題として出された内容"})]})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"🎯 今回の成績"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"問題数（全体）"}),o.jsx("input",{type:"number",min:"1",max:"200",value:l,onChange:S=>c(S.target.value),className:"w-full text-lg p-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",placeholder:"例: 10",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-2",children:"正解数"}),o.jsx("input",{type:"number",min:"0",max:l||"200",value:u,onChange:S=>d(S.target.value),className:"w-full text-lg p-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",placeholder:"例: 7",required:!0})]})]}),l&&u&&o.jsx("div",{className:"mt-3 text-center",children:o.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["正答率: ",Math.round(parseInt(u)/parseInt(l)*100),"%"]})})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"😊 今日の気持ち"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{key:"good",label:"よくできた",icon:"😊",color:"green"},{key:"normal",label:"普通",icon:"😐",color:"blue"},{key:"hard",label:"難しかった",icon:"😞",color:"orange"}].map(S=>o.jsxs("button",{type:"button",onClick:()=>h(S.key),className:`p-4 rounded-xl border-2 transition-all font-medium ${f===S.key?S.color==="green"?"border-green-400 bg-green-50 text-green-700":S.color==="blue"?"border-blue-400 bg-blue-50 text-blue-700":S.color==="orange"?"border-orange-400 bg-orange-50 text-orange-700":"border-blue-400 bg-blue-50 text-blue-700":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"}`,children:[o.jsx("div",{className:"text-3xl mb-2",children:S.icon}),o.jsx("div",{className:"text-sm",children:S.label})]},S.key))})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:[o.jsx("label",{className:"block text-lg font-bold text-slate-700 mb-3",children:"💭 今日の振り返り（自由記入）"}),o.jsx("textarea",{value:m,onChange:S=>x(S.target.value),maxLength:300,className:"w-full min-h-24 p-4 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100 text-lg resize-none",placeholder:"今日の学習でどんなことを感じましたか？（任意）"}),o.jsxs("div",{className:"text-right text-sm text-slate-500 mt-2",children:[m.length,"/300文字"]})]}),y&&o.jsx("div",{className:`p-4 rounded-xl font-medium ${p==="success"?"bg-green-100 border border-green-300 text-green-800":"bg-red-100 border border-red-300 text-red-800"}`,children:y}),o.jsx("button",{type:"submit",disabled:w,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white text-xl font-bold py-4 px-6 rounded-2xl hover:from-blue-600 hover:to-purple-700 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:w?"保存中...":"📝 学習記録を保存"})]})]})}function QS(){const{user:t}=ka(),[e,s]=U.useState(null),[n,a]=U.useState([]),[r,i]=U.useState(!0),[l,c]=U.useState(null);U.useEffect(()=>{t!=null&&t.id&&u()},[t==null?void 0:t.id]),U.useEffect(()=>{if(!(t!=null&&t.id))return;const v=setInterval(u,3e4);return()=>clearInterval(v)},[t==null?void 0:t.id]);const u=async()=>{if(!(t!=null&&t.id)){console.log("❌ ユーザーIDが見つかりません");return}console.log("🔄 ダッシュボードデータ取得開始 - ユーザーID:",t.id);try{i(!0),c(null);const{data:v,error:C}=await je.from("study_records").select("*").eq("student_id",t.id).order("date",{ascending:!1});if(console.log("📊 取得した学習記録:",(v==null?void 0:v.length)||0,"件"),console.log("📊 取得した学習記録詳細:",v),C)throw C;const{data:j,error:R}=await je.from("feedbacks").select(`
          *,
          study_records (
            id,
            student_id,
            date,
            study_date,
            subject,
            content_type,
            attempt_number,
            questions_total,
            questions_correct,
            emotion,
            comment
          )
        `).eq("student_id",t.id).order("created_at",{ascending:!1});if(R)throw R;const M=new Date().toISOString().split("T")[0];console.log("📅 今日の日付:",M);const S=(v==null?void 0:v.filter(D=>{const X=new Date(D.date),de=new Date().toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"}),it=X.toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"});return console.log("📊 記録詳細:",{recordId:D.id,studentId:D.student_id,rawDate:D.date,recordDateJST:it,todayJST:de,isMatch:it===de,subject:D.subject}),it===de}))||[];console.log("📅 今日の記録(フィルタ後):",S.length,"件"),console.log("📅 今日の記録詳細:",S);const q=await d(S,v||[]),G=f(v||[]),_=h(v||[]),$=m(v||[]),B=x(v||[]),L=w(v||[]);s({continueDays:G,cumulativeDays:_,todayRecords:q,subjectStats:$,recentEmotions:B,totalSessions:(v==null?void 0:v.length)||0,growthMetrics:L}),a(j||[])}catch(v){const C=v instanceof Error?v.message:"データの取得に失敗しました";c(C),console.error("❌ ダッシュボードデータ取得エラー:",C)}finally{i(!1)}},d=async(v,C)=>{const j=[];for(const R of v){const M=C.filter(S=>S.study_date===R.study_date&&S.subject===R.subject&&S.content_type===R.content_type).sort((S,q)=>S.attempt_number-q.attempt_number).map(S=>({attempt:S.attempt_number,correct:S.questions_correct,total:S.questions_total,accuracy:Math.round(S.questions_correct/S.questions_total*100),record_date:S.date,emotion:S.emotion}));j.push({id:R.id,study_date:R.study_date,subject:R.subject,content_type:R.content_type,attempt_number:R.attempt_number,questions_total:R.questions_total,questions_correct:R.questions_correct,emotion:R.emotion,comment:R.comment,history:M})}return j.sort((R,M)=>M.id-R.id)},f=v=>{if(!v.length)return 0;new Date().toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"});const C=Array.from(new Set(v.map(M=>new Date(M.date).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"})))).sort().reverse();if(C.length===0)return 0;let j=0,R=new Date;for(;;){const M=R.toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"});if(C.includes(M))j++,R.setDate(R.getDate()-1);else break}return j},h=v=>v.length?Array.from(new Set(v.map(j=>new Date(j.date).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"})))).sort().length:0,m=v=>[{key:"aptitude",label:"適性",icon:"🧠",color:"from-purple-400 to-purple-600"},{key:"japanese",label:"国語",icon:"📚",color:"from-rose-400 to-rose-600"},{key:"math",label:"算数",icon:"🔢",color:"from-blue-400 to-blue-600"},{key:"science",label:"理科",icon:"🔬",color:"from-green-400 to-green-600"},{key:"social",label:"社会",icon:"🌍",color:"from-amber-400 to-amber-600"}].map(j=>{const R=v.filter(G=>G.subject===j.key),M=R.reduce((G,_)=>G+_.questions_total,0),S=R.reduce((G,_)=>G+_.questions_correct,0),q=M>0?Math.round(S/M*100):0;return{subject:j.key,label:j.label,totalQuestions:M,totalCorrect:S,accuracy:q,icon:j.icon,color:j.color}}).filter(j=>j.totalQuestions>0),x=v=>{const C=new Map;return v.forEach(R=>{const M=new Date(R.date).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"});C.has(M)||C.set(M,[]),C.get(M).push(R)}),Array.from(C.keys()).sort().reverse().slice(0,5).map(R=>{const M=C.get(R)||[],S={good:0,normal:0,hard:0};M.forEach(G=>{S[G.emotion]++});const q=Object.entries(S).sort(([,G],[,_])=>_-G)[0][0];return{date:R,emotion:q}})},w=v=>{const C=new Date().toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"}),R=new Date(Date.now()-24*60*60*1e3).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"}),M=v.filter(we=>new Date(we.date).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"})===C),S=v.filter(we=>new Date(we.date).toLocaleDateString("ja-JP",{timeZone:"Asia/Tokyo"})===R),q=M.length>0?M.reduce((we,ve)=>we+ve.questions_correct/ve.questions_total,0)/M.length*100:0,G=S.length>0?S.reduce((we,ve)=>we+ve.questions_correct/ve.questions_total,0)/S.length*100:0,_={percentage:Math.abs(q-G),isImprovement:q>G},$=new Date,B=new Date($.getTime()-$.getDay()*24*60*60*1e3),L=new Date(B.getTime()-7*24*60*60*1e3),D=new Date(B.getTime()-1),X=v.filter(we=>new Date(we.date)>=B),de=v.filter(we=>{const ve=new Date(we.date);return ve>=L&&ve<=D}),it=X.length>0?X.reduce((we,ve)=>we+ve.questions_correct/ve.questions_total,0)/X.length*100:0,vt=de.length>0?de.reduce((we,ve)=>we+ve.questions_correct/ve.questions_total,0)/de.length*100:0,_t={current:Math.round(it),previous:Math.round(vt),improvement:Math.round(it-vt)},ff=f(v),ze=new Date($.getTime()-14*24*60*60*1e3),hf=new Date($.getTime()-7*24*60*60*1e3),Oy=["aptitude","japanese","math","science","social"],Ry={aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"};let mf=null,gf=0;return Oy.forEach(we=>{const ve=v.filter(ps=>ps.subject===we&&new Date(ps.date)>=hf),wo=v.filter(ps=>ps.subject===we&&new Date(ps.date)>=ze&&new Date(ps.date)<hf);if(ve.length>0&&wo.length>0){const ps=ve.reduce((jo,Ma)=>jo+Ma.questions_correct/Ma.questions_total,0)/ve.length*100,Cy=wo.reduce((jo,Ma)=>jo+Ma.questions_correct/Ma.questions_total,0)/wo.length*100,So=ps-Cy;So>gf&&(gf=So,mf={subject:we,label:Ry[we],improvement:Math.round(So)})}}),{todayImprovement:_,weeklyAverage:_t,consecutiveStreak:ff,mostImprovedSubject:mf}},N=v=>({good:"😊",normal:"😐",hard:"😞"})[v]||"😐",y=v=>({aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"})[v]||v,g=v=>({aptitude:"🎯",japanese:"✍️",math:"🔢",science:"🧪",social:"🌍"})[v]||"📚",p=v=>v==="class"?"授業":"宿題",b=v=>({good:"😊 よくできた",normal:"😐 普通",hard:"😞 難しかった"})[v]||v,A=v=>v.length<=1?"":v.map(C=>`(${C.correct}/${C.total})`).join(" → "),O=v=>!v||v==="1970-01-01"?"未設定":new Date(v).toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"}),T=()=>{const v=new Date;return v.setDate(v.getDate()-7),n.filter(R=>new Date(R.created_at)>=v).sort((R,M)=>new Date(M.created_at).getTime()-new Date(R.created_at).getTime()).slice(0,10).map(R=>({feedback:R,record:R.study_records||null}))};return r?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-lg",children:"ダッシュボードを読み込み中..."})]}):l?o.jsx("div",{className:"p-8 text-center",children:o.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:[o.jsx("h3",{className:"font-bold",children:"エラーが発生しました"}),o.jsx("p",{children:l}),o.jsx("button",{onClick:u,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"再読み込み"})]})}):e?o.jsxs("div",{className:"p-6 max-w-6xl mx-auto space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"harmonious-header-1",children:"📊 学習ダッシュボード"}),o.jsx("p",{className:"harmonious-text-lg",children:"がんばりの記録を確認しよう！"})]}),o.jsxs("div",{className:"bg-gradient-to-r from-orange-400 to-red-500 text-white rounded-2xl p-8 text-center shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-center gap-4 mb-4",children:[o.jsx("span",{className:"text-6xl",children:"🔥"}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-4xl font-black",children:"継続日数"}),o.jsx("p",{className:"text-xl opacity-90",children:"がんばり日数"})]})]}),o.jsxs("div",{className:"flex items-center justify-center gap-8 mb-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-5xl font-black mb-1",children:[e.continueDays,o.jsx("span",{className:"text-2xl",children:"/10"})]}),o.jsx("div",{className:"text-lg opacity-80",children:"連続日数"})]}),o.jsx("div",{className:"text-white/50 text-4xl",children:"|"}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-5xl font-black mb-1",children:[e.cumulativeDays,o.jsx("span",{className:"text-2xl",children:"/10"})]}),o.jsx("div",{className:"text-lg opacity-80",children:"累積日数"})]})]}),o.jsx("div",{className:"text-xl opacity-90",children:e.continueDays>=17?"🎉 完走達成！":e.continueDays>=10?"💪 もう少し！":e.continueDays>=5?"🌟 順調です！":"📈 がんばろう！"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("span",{className:"text-2xl",children:"📈"}),o.jsx("h3",{className:"font-bold text-lg",children:"今日の成果"})]}),e.growthMetrics.todayImprovement.percentage>0?o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:`text-2xl font-bold ${e.growthMetrics.todayImprovement.isImprovement?"text-green-600":"text-red-600"}`,children:[e.growthMetrics.todayImprovement.isImprovement?"+":"-",e.growthMetrics.todayImprovement.percentage.toFixed(1),"%"]}),o.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["昨日より ",e.growthMetrics.todayImprovement.isImprovement?"UP!":"DOWN",e.growthMetrics.todayImprovement.isImprovement&&e.growthMetrics.todayImprovement.percentage>=10?" 🔥":""]})]}):o.jsx("div",{className:"text-center text-slate-500 text-sm",children:"昨日のデータなし"})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("span",{className:"text-2xl",children:"📊"}),o.jsx("h3",{className:"font-bold text-lg",children:"週間平均"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[e.growthMetrics.weeklyAverage.current,"%"]}),e.growthMetrics.weeklyAverage.previous>0&&o.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["先週: ",e.growthMetrics.weeklyAverage.previous,"%",e.growthMetrics.weeklyAverage.improvement!==0&&o.jsxs("span",{className:`ml-1 ${e.growthMetrics.weeklyAverage.improvement>0?"text-green-600":"text-red-600"}`,children:["(",e.growthMetrics.weeklyAverage.improvement>0?"+":"",e.growthMetrics.weeklyAverage.improvement,"%)"]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("span",{className:"text-2xl",children:"⭐"}),o.jsx("h3",{className:"font-bold text-lg",children:"連続記録"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[e.growthMetrics.consecutiveStreak,"日連続"]}),o.jsx("div",{className:"text-sm text-slate-600 mt-1",children:e.growthMetrics.consecutiveStreak>=5?"素晴らしい！":"がんばろう！"})]})]}),o.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("span",{className:"text-2xl",children:"🚀"}),o.jsx("h3",{className:"font-bold text-lg",children:"成長科目"})]}),e.growthMetrics.mostImprovedSubject?o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-lg font-bold text-green-600",children:e.growthMetrics.mostImprovedSubject.label}),o.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:["+",e.growthMetrics.mostImprovedSubject.improvement,"% UP!"]})]}):o.jsx("div",{className:"text-center text-slate-500 text-sm",children:"データ蓄積中"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"📅"}),"今日の記録"]}),e.todayRecords.length>0?o.jsx("div",{className:"space-y-4",children:e.todayRecords.map(v=>o.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl",children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg",children:[y(v.subject),"（",p(v.content_type),"）"]}),o.jsxs("div",{className:"text-sm text-slate-500",children:[O(v.study_date),"実施分",v.attempt_number>1&&o.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:[v.attempt_number,"回目"]})]})]}),o.jsx("span",{className:"text-sm text-slate-500",children:b(v.emotion)})]}),o.jsxs("div",{className:"text-blue-600 font-medium mb-2",children:["現在: ",v.questions_correct,"/",v.questions_total,"問正解",o.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",Math.round(v.questions_correct/v.questions_total*100),"%)"]})]}),v.history.length>1&&o.jsxs("div",{className:"text-sm text-slate-600 mb-2",children:[o.jsx("span",{className:"font-medium",children:"成績の変化:"}),o.jsx("div",{className:"mt-1 font-mono text-blue-700",children:A(v.history)}),o.jsx("div",{className:"text-xs text-slate-500 mt-1",children:v.history.length>1&&o.jsxs("span",{children:["改善: +",v.history[v.history.length-1].accuracy-v.history[0].accuracy,"%"]})})]}),v.comment&&o.jsx("p",{className:"text-slate-600 text-sm mt-2 bg-white p-2 rounded",children:v.comment})]},v.id))}):o.jsxs("div",{className:"text-center py-8 text-slate-500",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"📝"}),o.jsx("p",{className:"text-lg",children:"今日はまだ学習記録がありません"}),o.jsx("p",{className:"text-sm",children:"がんばって記録をつけよう！"})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"💭"}),"最近の調子"]}),e.recentEmotions.length>0?o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex justify-center items-center gap-2 text-4xl",children:e.recentEmotions.map((v,C)=>o.jsx("span",{className:"transition-transform hover:scale-125",children:N(v.emotion)},C))}),o.jsx("div",{className:"text-center text-sm text-slate-500",children:e.recentEmotions.map((v,C)=>o.jsx("span",{className:"inline-block mx-1",children:new Date(v.date).toLocaleDateString("ja-JP",{month:"short",day:"numeric"})},C))})]}):o.jsxs("div",{className:"text-center py-8 text-slate-500",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"🤔"}),o.jsx("p",{children:"まだデータが少ないです"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"📈"}),"科目別成績"]}),e.subjectStats.length>0?o.jsx(o.Fragment,{children:o.jsxs("div",{className:"space-y-4 mb-8",children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-700 mb-4",children:"累積正答率"}),e.subjectStats.map(v=>o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3 w-24",children:[o.jsx("span",{className:"text-2xl",children:v.icon}),o.jsx("span",{className:"font-medium",children:v.label})]}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"flex-1 bg-slate-200 rounded-full h-6 overflow-hidden",children:o.jsx("div",{className:`h-full bg-gradient-to-r ${v.color} transition-all duration-500`,style:{width:`${v.accuracy}%`}})}),o.jsxs("div",{className:"text-lg font-bold text-slate-700 w-12 text-right",children:[v.accuracy,"%"]})]}),o.jsxs("div",{className:"text-sm text-slate-500 mt-1",children:[v.totalCorrect,"/",v.totalQuestions,"問正解"]})]})]},v.subject))]})}):o.jsxs("div",{className:"text-center py-8 text-slate-500",children:[o.jsx("span",{className:"text-4xl mb-4 block",children:"📊"}),o.jsx("p",{children:"学習記録を追加すると成績が表示されます"})]})]}),T().length>0&&o.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"💌"}),"最近の応援メッセージ・スタンプ"]}),o.jsx("button",{onClick:u,disabled:r,className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 disabled:opacity-50 transition-colors",children:"🔄 更新"})]}),o.jsx("div",{className:"space-y-4",children:T().map(v=>o.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl",children:[v.record&&o.jsxs("div",{className:"mb-3 p-3 bg-white rounded-lg border border-slate-200",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-lg",children:g(v.record.subject)}),o.jsx("span",{className:"font-semibold",children:y(v.record.subject)}),o.jsx("span",{className:"text-sm px-2 py-1 bg-slate-100 text-slate-600 rounded",children:p(v.record.content_type)}),v.record.attempt_number>1&&o.jsxs("span",{className:"text-sm px-2 py-1 bg-blue-100 text-blue-700 rounded",children:[v.record.attempt_number,"回目"]})]}),o.jsxs("div",{className:"text-sm text-slate-600 flex items-center gap-4",children:[o.jsxs("span",{children:["📅 ",O(v.record.study_date),"実施分"]}),o.jsxs("span",{className:"font-medium text-blue-600",children:["🎯 ",v.record.questions_correct,"/",v.record.questions_total,"問正解 (",Math.round(v.record.questions_correct/v.record.questions_total*100),"%)"]}),o.jsx("span",{children:b(v.record.emotion)})]})]}),o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${v.feedback.sender_type==="parent"?"bg-pink-100 text-pink-800":"bg-blue-100 text-blue-800"}`,children:v.feedback.sender_type==="parent"?"👨‍👩‍👧‍👦 保護者":"👨‍🏫 指導者"}),v.feedback.reaction_type&&o.jsxs("span",{className:"text-2xl",children:[v.feedback.reaction_type==="clap"&&"👏",v.feedback.reaction_type==="thumbs"&&"👍",v.feedback.reaction_type==="muscle"&&"💪"]}),o.jsx("span",{className:"text-xs text-slate-500 ml-auto",children:(()=>{const C=new Date(v.feedback.created_at);return new Date(C.getTime()+9*60*60*1e3).toLocaleString("ja-JP",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})})()})]}),v.feedback.message&&typeof v.feedback.message=="string"&&v.feedback.message.trim()!==""?o.jsx("p",{className:"text-slate-700",children:v.feedback.message}):v.feedback.reaction_type&&o.jsxs("p",{className:"text-slate-600 italic text-sm",children:[v.feedback.reaction_type==="clap"&&"すごい！",v.feedback.reaction_type==="thumbs"&&"いいね！",v.feedback.reaction_type==="muscle"&&"頑張って！"]})]},v.feedback.id))})]})]}):null}function Y(t,e,s,n,a){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,s),s}function E(t,e,s,n){if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?n:s==="a"?n.call(t):n?n.value:e.get(t)}let tb=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return tb=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),s=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^s()&15>>+n/4).toString(16))};function Au(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Tu=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class P extends Error{}class Xe extends P{constructor(e,s,n,a){super(`${Xe.makeMessage(e,s,n)}`),this.status=e,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=s;const r=s;this.code=r==null?void 0:r.code,this.param=r==null?void 0:r.param,this.type=r==null?void 0:r.type}static makeMessage(e,s,n){const a=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):n;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,s,n,a){if(!e||!a)return new go({message:n,cause:Tu(s)});const r=s==null?void 0:s.error;return e===400?new sb(e,r,n,a):e===401?new nb(e,r,n,a):e===403?new ab(e,r,n,a):e===404?new rb(e,r,n,a):e===409?new ib(e,r,n,a):e===422?new lb(e,r,n,a):e===429?new ob(e,r,n,a):e>=500?new cb(e,r,n,a):new Xe(e,r,n,a)}}class Tt extends Xe{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class go extends Xe{constructor({message:e,cause:s}){super(void 0,void 0,e||"Connection error.",void 0),s&&(this.cause=s)}}class Xd extends go{constructor({message:e}={}){super({message:e??"Request timed out."})}}class sb extends Xe{}class nb extends Xe{}class ab extends Xe{}class rb extends Xe{}class ib extends Xe{}class lb extends Xe{}class ob extends Xe{}class cb extends Xe{}class ub extends P{constructor(){super("Could not parse response content as the length limit was reached")}}class db extends P{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ka extends Error{constructor(e){super(e)}}const JS=/^[a-z][a-z0-9+.-]*:/i,KS=t=>JS.test(t);let st=t=>(st=Array.isArray,st(t)),im=st;function ZS(t){return typeof t!="object"?{}:t??{}}function FS(t){if(!t)return!0;for(const e in t)return!1;return!0}function WS(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function hc(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const ej=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new P(`${t} must be an integer`);if(e<0)throw new P(`${t} must be a positive integer`);return e},tj=t=>{try{return JSON.parse(t)}catch{return}},ii=t=>new Promise(e=>setTimeout(e,t)),Hn="5.13.1",sj=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function nj(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const aj=()=>{var s;const t=nj();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hn,"X-Stainless-OS":om(Deno.build.os),"X-Stainless-Arch":lm(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((s=Deno.version)==null?void 0:s.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hn,"X-Stainless-OS":om(globalThis.process.platform??"unknown"),"X-Stainless-Arch":lm(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=rj();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Hn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function rj(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:s}of t){const n=s.exec(navigator.userAgent);if(n){const a=n[1]||0,r=n[2]||0,i=n[3]||0;return{browser:e,version:`${a}.${r}.${i}`}}}return null}const lm=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",om=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let cm;const ij=()=>cm??(cm=aj());function lj(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function fb(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function hb(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return fb({start(){},async pull(s){const{done:n,value:a}=await e.next();n?s.close():s.enqueue(a)},async cancel(){var s;await((s=e.return)==null?void 0:s.call(e))}})}function mb(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const s=await e.read();return s!=null&&s.done&&e.releaseLock(),s}catch(s){throw e.releaseLock(),s}},async return(){const s=e.cancel();return e.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function oj(t){var n,a;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((a=(n=t[Symbol.asyncIterator]()).return)==null?void 0:a.call(n));return}const e=t.getReader(),s=e.cancel();e.releaseLock(),await s}const cj=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),gb="RFC3986",pb=t=>String(t),um={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:pb},uj="RFC1738";let Ou=(t,e)=>(Ou=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Ou(t,e));const Lt=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),mc=1024,dj=(t,e,s,n,a)=>{if(t.length===0)return t;let r=t;if(typeof t=="symbol"?r=Symbol.prototype.toString.call(t):typeof t!="string"&&(r=String(t)),s==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let i="";for(let l=0;l<r.length;l+=mc){const c=r.length>=mc?r.slice(l,l+mc):r,u=[];for(let d=0;d<c.length;++d){let f=c.charCodeAt(d);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===uj&&(f===40||f===41)){u[u.length]=c.charAt(d);continue}if(f<128){u[u.length]=Lt[f];continue}if(f<2048){u[u.length]=Lt[192|f>>6]+Lt[128|f&63];continue}if(f<55296||f>=57344){u[u.length]=Lt[224|f>>12]+Lt[128|f>>6&63]+Lt[128|f&63];continue}d+=1,f=65536+((f&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=Lt[240|f>>18]+Lt[128|f>>12&63]+Lt[128|f>>6&63]+Lt[128|f&63]}i+=u.join("")}return i};function fj(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function dm(t,e){if(st(t)){const s=[];for(let n=0;n<t.length;n+=1)s.push(e(t[n]));return s}return e(t)}const bb={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},yb=function(t,e){Array.prototype.push.apply(t,st(e)?e:[e])};let fm;const Te={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:dj,encodeValuesOnly:!1,format:gb,formatter:pb,indices:!1,serializeDate(t){return(fm??(fm=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function hj(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const gc={};function vb(t,e,s,n,a,r,i,l,c,u,d,f,h,m,x,w,N,y){let g=t,p=y,b=0,A=!1;for(;(p=p.get(gc))!==void 0&&!A;){const j=p.get(t);if(b+=1,typeof j<"u"){if(j===b)throw new RangeError("Cyclic object value");A=!0}typeof p.get(gc)>"u"&&(b=0)}if(typeof u=="function"?g=u(e,g):g instanceof Date?g=h==null?void 0:h(g):s==="comma"&&st(g)&&(g=dm(g,function(j){return j instanceof Date?h==null?void 0:h(j):j})),g===null){if(r)return c&&!w?c(e,Te.encoder,N,"key",m):e;g=""}if(hj(g)||fj(g)){if(c){const j=w?e:c(e,Te.encoder,N,"key",m);return[(x==null?void 0:x(j))+"="+(x==null?void 0:x(c(g,Te.encoder,N,"value",m)))]}return[(x==null?void 0:x(e))+"="+(x==null?void 0:x(String(g)))]}const O=[];if(typeof g>"u")return O;let T;if(s==="comma"&&st(g))w&&c&&(g=dm(g,c)),T=[{value:g.length>0?g.join(",")||null:void 0}];else if(st(u))T=u;else{const j=Object.keys(g);T=d?j.sort(d):j}const v=l?String(e).replace(/\./g,"%2E"):String(e),C=n&&st(g)&&g.length===1?v+"[]":v;if(a&&st(g)&&g.length===0)return C+"[]";for(let j=0;j<T.length;++j){const R=T[j],M=typeof R=="object"&&typeof R.value<"u"?R.value:g[R];if(i&&M===null)continue;const S=f&&l?R.replace(/\./g,"%2E"):R,q=st(g)?typeof s=="function"?s(C,S):C:C+(f?"."+S:"["+S+"]");y.set(t,b);const G=new WeakMap;G.set(gc,y),yb(O,vb(M,q,s,n,a,r,i,l,s==="comma"&&w&&st(g)?null:c,u,d,f,h,m,x,w,N,G))}return O}function mj(t=Te){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Te.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=gb;if(typeof t.format<"u"){if(!Ou(um,t.format))throw new TypeError("Unknown format option provided.");s=t.format}const n=um[s];let a=Te.filter;(typeof t.filter=="function"||st(t.filter))&&(a=t.filter);let r;if(t.arrayFormat&&t.arrayFormat in bb?r=t.arrayFormat:"indices"in t?r=t.indices?"indices":"repeat":r=Te.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Te.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Te.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Te.allowEmptyArrays,arrayFormat:r,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Te.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Te.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Te.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Te.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Te.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Te.encodeValuesOnly,filter:a,format:s,formatter:n,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Te.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Te.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Te.strictNullHandling}}function gj(t,e={}){let s=t;const n=mj(e);let a,r;typeof n.filter=="function"?(r=n.filter,s=r("",s)):st(n.filter)&&(r=n.filter,a=r);const i=[];if(typeof s!="object"||s===null)return"";const l=bb[n.arrayFormat],c=l==="comma"&&n.commaRoundTrip;a||(a=Object.keys(s)),n.sort&&a.sort(n.sort);const u=new WeakMap;for(let h=0;h<a.length;++h){const m=a[h];n.skipNulls&&s[m]===null||yb(i,vb(s[m],m,l,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}const d=i.join(n.delimiter);let f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""}function pj(t){let e=0;for(const a of t)e+=a.length;const s=new Uint8Array(e);let n=0;for(const a of t)s.set(a,n),n+=a.length;return s}let hm;function Yd(t){let e;return(hm??(e=new globalThis.TextEncoder,hm=e.encode.bind(e)))(t)}let mm;function gm(t){let e;return(mm??(e=new globalThis.TextDecoder,mm=e.decode.bind(e)))(t)}var ct,ut;class po{constructor(){ct.set(this,void 0),ut.set(this,void 0),Y(this,ct,new Uint8Array),Y(this,ut,null)}decode(e){if(e==null)return[];const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Yd(e):e;Y(this,ct,pj([E(this,ct,"f"),s]));const n=[];let a;for(;(a=bj(E(this,ct,"f"),E(this,ut,"f")))!=null;){if(a.carriage&&E(this,ut,"f")==null){Y(this,ut,a.index);continue}if(E(this,ut,"f")!=null&&(a.index!==E(this,ut,"f")+1||a.carriage)){n.push(gm(E(this,ct,"f").subarray(0,E(this,ut,"f")-1))),Y(this,ct,E(this,ct,"f").subarray(E(this,ut,"f"))),Y(this,ut,null);continue}const r=E(this,ut,"f")!==null?a.preceding-1:a.preceding,i=gm(E(this,ct,"f").subarray(0,r));n.push(i),Y(this,ct,E(this,ct,"f").subarray(a.index)),Y(this,ut,null)}return n}flush(){return E(this,ct,"f").length?this.decode(`
`):[]}}ct=new WeakMap,ut=new WeakMap;po.NEWLINE_CHARS=new Set([`
`,"\r"]);po.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function bj(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function yj(t){for(let n=0;n<t.length-1;n++){if(t[n]===10&&t[n+1]===10||t[n]===13&&t[n+1]===13)return n+2;if(t[n]===13&&t[n+1]===10&&n+3<t.length&&t[n+2]===13&&t[n+3]===10)return n+4}return-1}const $l={off:0,error:200,warn:300,info:400,debug:500},pm=(t,e,s)=>{if(t){if(WS($l,t))return t;Le(s).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys($l))}`)}};function Za(){}function Ti(t,e,s){return!e||$l[t]>$l[s]?Za:e[t].bind(e)}const vj={error:Za,warn:Za,info:Za,debug:Za};let bm=new WeakMap;function Le(t){const e=t.logger,s=t.logLevel??"off";if(!e)return vj;const n=bm.get(e);if(n&&n[0]===s)return n[1];const a={error:Ti("error",e,s),warn:Ti("warn",e,s),info:Ti("info",e,s),debug:Ti("debug",e,s)};return bm.set(e,[s,a]),a}const sn=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,s])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Xa;class Pt{constructor(e,s,n){this.iterator=e,Xa.set(this,void 0),this.controller=s,Y(this,Xa,n)}static fromSSEResponse(e,s,n){let a=!1;const r=n?Le(n):console;async function*i(){if(a)throw new P("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let l=!1;try{for await(const c of _j(e,s))if(!l){if(c.data.startsWith("[DONE]")){l=!0;continue}if(c.event===null||!c.event.startsWith("thread.")){let u;try{u=JSON.parse(c.data)}catch(d){throw r.error("Could not parse message into JSON:",c.data),r.error("From chunk:",c.raw),d}if(u&&u.error)throw new Xe(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(c.data)}catch(d){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),d}if(c.event=="error")throw new Xe(void 0,u.error,u.message,void 0);yield{event:c.event,data:u}}}l=!0}catch(c){if(Au(c))return;throw c}finally{l||s.abort()}}return new Pt(i,s,n)}static fromReadableStream(e,s,n){let a=!1;async function*r(){const l=new po,c=mb(e);for await(const u of c)for(const d of l.decode(u))yield d;for(const u of l.flush())yield u}async function*i(){if(a)throw new P("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let l=!1;try{for await(const c of r())l||c&&(yield JSON.parse(c));l=!0}catch(c){if(Au(c))return;throw c}finally{l||s.abort()}}return new Pt(i,s,n)}[(Xa=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],s=[],n=this.iterator(),a=r=>({next:()=>{if(r.length===0){const i=n.next();e.push(i),s.push(i)}return r.shift()}});return[new Pt(()=>a(e),this.controller,E(this,Xa,"f")),new Pt(()=>a(s),this.controller,E(this,Xa,"f"))]}toReadableStream(){const e=this;let s;return fb({async start(){s=e[Symbol.asyncIterator]()},async pull(n){try{const{value:a,done:r}=await s.next();if(r)return n.close();const i=Yd(JSON.stringify(a)+`
`);n.enqueue(i)}catch(a){n.error(a)}},async cancel(){var n;await((n=s.return)==null?void 0:n.call(s))}})}}async function*_j(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new P("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new P("Attempted to iterate over a response with no body");const s=new wj,n=new po,a=mb(t.body);for await(const r of xj(a))for(const i of n.decode(r)){const l=s.decode(i);l&&(yield l)}for(const r of n.flush()){const i=s.decode(r);i&&(yield i)}}async function*xj(t){let e=new Uint8Array;for await(const s of t){if(s==null)continue;const n=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?Yd(s):s;let a=new Uint8Array(e.length+n.length);a.set(e),a.set(n,e.length),e=a;let r;for(;(r=yj(e))!==-1;)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}class wj{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[s,n,a]=Sj(e,":");return a.startsWith(" ")&&(a=a.substring(1)),s==="event"?this.event=a:s==="data"&&this.data.push(a),null}}function Sj(t,e){const s=t.indexOf(e);return s!==-1?[t.substring(0,s),e,t.substring(s+e.length)]:[t,"",""]}async function _b(t,e){const{response:s,requestLogID:n,retryOfRequestLogID:a,startTime:r}=e,i=await(async()=>{var f;if(e.options.stream)return Le(t).debug("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller,t):Pt.fromSSEResponse(s,e.controller,t);if(s.status===204)return null;if(e.options.__binaryResponse)return s;const l=s.headers.get("content-type"),c=(f=l==null?void 0:l.split(";")[0])==null?void 0:f.trim();if((c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))){const h=await s.json();return xb(h,s)}return await s.text()})();return Le(t).debug(`[${n}] response parsed`,sn({retryOfRequestLogID:a,url:s.url,status:s.status,body:i,durationMs:Date.now()-r})),i}function xb(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Fa;class bo extends Promise{constructor(e,s,n=_b){super(a=>{a(null)}),this.responsePromise=s,this.parseResponse=n,Fa.set(this,void 0),Y(this,Fa,e)}_thenUnwrap(e){return new bo(E(this,Fa,"f"),this.responsePromise,async(s,n)=>xb(e(await this.parseResponse(s,n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:s,request_id:s.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(E(this,Fa,"f"),e))),this.parsedPromise}then(e,s){return this.parse().then(e,s)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Fa=new WeakMap;var Oi;class wb{constructor(e,s,n,a){Oi.set(this,void 0),Y(this,Oi,e),this.options=a,this.response=s,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new P("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await E(this,Oi,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Oi=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const s of e.getPaginatedItems())yield s}}class jj extends bo{constructor(e,s,n){super(e,s,async(a,r)=>new n(a,r.response,await _b(a,r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const s of e)yield s}}class yo extends wb{constructor(e,s,n,a){super(e,s,n,a),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Ee extends wb{constructor(e,s,n,a){super(e,s,n,a),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var n;const e=this.getPaginatedItems(),s=(n=e[e.length-1])==null?void 0:n.id;return s?{...this.options,query:{...ZS(this.options.query),after:s}}:null}}const Sb=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,s=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function wr(t,e,s){return Sb(),new File(t,e??"unknown_file",s)}function Qi(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const jb=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",vn=async(t,e)=>({...t,body:await Ej(t.body,e)}),ym=new WeakMap;function Nj(t){const e=typeof t=="function"?t:t.fetch,s=ym.get(e);if(s)return s;const n=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,r=new FormData;return r.toString()!==await new a(r).text()}catch{return!0}})();return ym.set(e,n),n}const Ej=async(t,e)=>{if(!await Nj(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const s=new FormData;return await Promise.all(Object.entries(t||{}).map(([n,a])=>Ru(s,n,a))),s},Aj=t=>t instanceof Blob&&"name"in t,Ru=async(t,e,s)=>{if(s!==void 0){if(s==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")t.append(e,String(s));else if(s instanceof Response)t.append(e,wr([await s.blob()],Qi(s)));else if(jb(s))t.append(e,wr([await new Response(hb(s)).blob()],Qi(s)));else if(Aj(s))t.append(e,s,Qi(s));else if(Array.isArray(s))await Promise.all(s.map(n=>Ru(t,e+"[]",n)));else if(typeof s=="object")await Promise.all(Object.entries(s).map(([n,a])=>Ru(t,`${e}[${n}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},Nb=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Tj=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Nb(t),Oj=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function Rj(t,e,s){if(Sb(),t=await t,Tj(t))return t instanceof File?t:wr([await t.arrayBuffer()],t.name);if(Oj(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),wr(await Cu(a),e,s)}const n=await Cu(t);if(e||(e=Qi(t)),!(s!=null&&s.type)){const a=n.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof a=="string"&&(s={...s,type:a})}return wr(n,e,s)}async function Cu(t){var s;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Nb(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(jb(t))for await(const n of t)e.push(...await Cu(n));else{const n=(s=t==null?void 0:t.constructor)==null?void 0:s.name;throw new Error(`Unexpected data type: ${typeof t}${n?`; constructor: ${n}`:""}${Cj(t)}`)}return e}function Cj(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(s=>`"${s}"`).join(", ")}]`}class V{constructor(e){this._client=e}}function Eb(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const vm=Object.freeze(Object.create(null)),kj=(t=Eb)=>function(s,...n){if(s.length===1)return s[0];let a=!1;const r=[],i=s.reduce((d,f,h)=>{var w;/[?#]/.test(f)&&(a=!0);const m=n[h];let x=(a?encodeURIComponent:t)(""+m);return h!==n.length&&(m==null||typeof m=="object"&&m.toString===((w=Object.getPrototypeOf(Object.getPrototypeOf(m.hasOwnProperty??vm)??vm))==null?void 0:w.toString))&&(x=m+"",r.push({start:d.length+f.length,length:x.length,error:`Value of type ${Object.prototype.toString.call(m).slice(8,-1)} is not a valid path parameter`})),d+f+(h===n.length?"":x)},""),l=i.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=c.exec(l))!==null;)r.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(r.sort((d,f)=>d.start-f.start),r.length>0){let d=0;const f=r.reduce((h,m)=>{const x=" ".repeat(m.start-d),w="^".repeat(m.length);return d=m.start+m.length,h+x+w},"");throw new P(`Path parameters result in path with invalid segments:
${r.map(h=>h.error).join(`
`)}
${i}
${f}`)}return i},z=kj(Eb);let Ab=class extends V{list(e,s={},n){return this._client.getAPIList(z`/chat/completions/${e}/messages`,Ee,{query:s,...n})}};function Ul(t){return t!==void 0&&"function"in t&&t.function!==void 0}function Id(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function li(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Dj(t,e){return!e||!Tb(e)?{...t,choices:t.choices.map(s=>(Ob(s.message.tool_calls),{...s,message:{...s.message,parsed:null,...s.message.tool_calls?{tool_calls:s.message.tool_calls}:void 0}}))}:Vd(t,e)}function Vd(t,e){const s=t.choices.map(n=>{var a;if(n.finish_reason==="length")throw new ub;if(n.finish_reason==="content_filter")throw new db;return Ob(n.message.tool_calls),{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((a=n.message.tool_calls)==null?void 0:a.map(r=>$j(e,r)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?Mj(e,n.message.content):null}}});return{...t,choices:s}}function Mj(t,e){var s,n;return((s=t.response_format)==null?void 0:s.type)!=="json_schema"?null:((n=t.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function $j(t,e){var n;const s=(n=t.tools)==null?void 0:n.find(a=>{var r;return Ul(a)&&((r=a.function)==null?void 0:r.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:li(s)?s.$parseRaw(e.function.arguments):s!=null&&s.function.strict?JSON.parse(e.function.arguments):null}}}function Uj(t,e){var n;if(!t||!("tools"in t)||!t.tools)return!1;const s=(n=t.tools)==null?void 0:n.find(a=>{var r;return Ul(a)&&((r=a.function)==null?void 0:r.name)===e.function.name});return Ul(s)&&(li(s)||(s==null?void 0:s.function.strict)||!1)}function Tb(t){var e;return Id(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(s=>li(s)||s.type==="function"&&s.function.strict===!0))??!1}function Ob(t){for(const e of t||[])if(e.type!=="function")throw new P(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function qj(t){for(const e of t??[]){if(e.type!=="function")throw new P(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new P(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const ql=t=>(t==null?void 0:t.role)==="assistant",Rb=t=>(t==null?void 0:t.role)==="tool";var ku,Ji,Ki,Wa,er,Zi,tr,es,sr,zl,Ll,Gn,Cb;class Qd{constructor(){ku.add(this),this.controller=new AbortController,Ji.set(this,void 0),Ki.set(this,()=>{}),Wa.set(this,()=>{}),er.set(this,void 0),Zi.set(this,()=>{}),tr.set(this,()=>{}),es.set(this,{}),sr.set(this,!1),zl.set(this,!1),Ll.set(this,!1),Gn.set(this,!1),Y(this,Ji,new Promise((e,s)=>{Y(this,Ki,e,"f"),Y(this,Wa,s,"f")})),Y(this,er,new Promise((e,s)=>{Y(this,Zi,e,"f"),Y(this,tr,s,"f")})),E(this,Ji,"f").catch(()=>{}),E(this,er,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},E(this,ku,"m",Cb).bind(this))},0)}_connected(){this.ended||(E(this,Ki,"f").call(this),this._emit("connect"))}get ended(){return E(this,sr,"f")}get errored(){return E(this,zl,"f")}get aborted(){return E(this,Ll,"f")}abort(){this.controller.abort()}on(e,s){return(E(this,es,"f")[e]||(E(this,es,"f")[e]=[])).push({listener:s}),this}off(e,s){const n=E(this,es,"f")[e];if(!n)return this;const a=n.findIndex(r=>r.listener===s);return a>=0&&n.splice(a,1),this}once(e,s){return(E(this,es,"f")[e]||(E(this,es,"f")[e]=[])).push({listener:s,once:!0}),this}emitted(e){return new Promise((s,n)=>{Y(this,Gn,!0),e!=="error"&&this.once("error",n),this.once(e,s)})}async done(){Y(this,Gn,!0),await E(this,er,"f")}_emit(e,...s){if(E(this,sr,"f"))return;e==="end"&&(Y(this,sr,!0),E(this,Zi,"f").call(this));const n=E(this,es,"f")[e];if(n&&(E(this,es,"f")[e]=n.filter(a=>!a.once),n.forEach(({listener:a})=>a(...s))),e==="abort"){const a=s[0];!E(this,Gn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),E(this,Wa,"f").call(this,a),E(this,tr,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=s[0];!E(this,Gn,"f")&&!(n!=null&&n.length)&&Promise.reject(a),E(this,Wa,"f").call(this,a),E(this,tr,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Ji=new WeakMap,Ki=new WeakMap,Wa=new WeakMap,er=new WeakMap,Zi=new WeakMap,tr=new WeakMap,es=new WeakMap,sr=new WeakMap,zl=new WeakMap,Ll=new WeakMap,Gn=new WeakMap,ku=new WeakSet,Cb=function(e){if(Y(this,zl,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Tt),e instanceof Tt)return Y(this,Ll,!0),this._emit("abort",e);if(e instanceof P)return this._emit("error",e);if(e instanceof Error){const s=new P(e.message);return s.cause=e,this._emit("error",s)}return this._emit("error",new P(String(e)))};function zj(t){return typeof t.parse=="function"}var Qe,Du,Bl,Mu,$u,Uu,kb,Db;const Lj=10;class Mb extends Qd{constructor(){super(...arguments),Qe.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const s=(n=e.choices[0])==null?void 0:n.message;return s&&this._addMessage(s),e}_addMessage(e,s=!0){if("content"in e||(e.content=null),this.messages.push(e),s){if(this._emit("message",e),Rb(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(ql(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionToolCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new P("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),E(this,Qe,"m",Du).call(this)}async finalMessage(){return await this.done(),E(this,Qe,"m",Bl).call(this)}async finalFunctionToolCall(){return await this.done(),E(this,Qe,"m",Mu).call(this)}async finalFunctionToolCallResult(){return await this.done(),E(this,Qe,"m",$u).call(this)}async totalUsage(){return await this.done(),E(this,Qe,"m",Uu).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const s=E(this,Qe,"m",Bl).call(this);s&&this._emit("finalMessage",s);const n=E(this,Qe,"m",Du).call(this);n&&this._emit("finalContent",n);const a=E(this,Qe,"m",Mu).call(this);a&&this._emit("finalFunctionToolCall",a);const r=E(this,Qe,"m",$u).call(this);r!=null&&this._emit("finalFunctionToolCallResult",r),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",E(this,Qe,"m",Uu).call(this))}async _createChatCompletion(e,s,n){const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),E(this,Qe,"m",kb).call(this,s);const r=await e.chat.completions.create({...s,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Vd(r,s))}async _runChatCompletion(e,s,n){for(const a of s.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,s,n)}async _runTools(e,s,n){var m,x,w;const a="tool",{tool_choice:r="auto",stream:i,...l}=s,c=typeof r!="string"&&r.type==="function"&&((m=r==null?void 0:r.function)==null?void 0:m.name),{maxChatCompletions:u=Lj}=n||{},d=s.tools.map(N=>{if(li(N)){if(!N.$callback)throw new P("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:N.$callback,name:N.function.name,description:N.function.description||"",parameters:N.function.parameters,parse:N.$parseRaw,strict:!0}}}return N}),f={};for(const N of d)N.type==="function"&&(f[N.function.name||N.function.function.name]=N.function);const h="tools"in s?d.map(N=>N.type==="function"?{type:"function",function:{name:N.function.name||N.function.function.name,parameters:N.function.parameters,description:N.function.description,strict:N.function.strict}}:N):void 0;for(const N of s.messages)this._addMessage(N,!1);for(let N=0;N<u;++N){const g=(x=(await this._createChatCompletion(e,{...l,tool_choice:r,tools:h,messages:[...this.messages]},n)).choices[0])==null?void 0:x.message;if(!g)throw new P("missing message in ChatCompletion response");if(!((w=g.tool_calls)!=null&&w.length))return;for(const p of g.tool_calls){if(p.type!=="function")continue;const b=p.id,{name:A,arguments:O}=p.function,T=f[A];if(T){if(c&&c!==A){const R=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:b,content:R});continue}}else{const R=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(f).map(M=>JSON.stringify(M)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:b,content:R});continue}let v;try{v=zj(T)?await T.parse(O):O}catch(R){const M=R instanceof Error?R.message:String(R);this._addMessage({role:a,tool_call_id:b,content:M});continue}const C=await T.function(v,this),j=E(this,Qe,"m",Db).call(this,C);if(this._addMessage({role:a,tool_call_id:b,content:j}),c)return}}}}Qe=new WeakSet,Du=function(){return E(this,Qe,"m",Bl).call(this).content??null},Bl=function(){let e=this.messages.length;for(;e-- >0;){const s=this.messages[e];if(ql(s))return{...s,content:s.content??null,refusal:s.refusal??null}}throw new P("stream ended without producing a ChatCompletionMessage with role=assistant")},Mu=function(){var e,s;for(let n=this.messages.length-1;n>=0;n--){const a=this.messages[n];if(ql(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(s=a.tool_calls.filter(r=>r.type==="function").at(-1))==null?void 0:s.function}},$u=function(){for(let e=this.messages.length-1;e>=0;e--){const s=this.messages[e];if(Rb(s)&&s.content!=null&&typeof s.content=="string"&&this.messages.some(n=>{var a;return n.role==="assistant"&&((a=n.tool_calls)==null?void 0:a.some(r=>r.type==="function"&&r.id===s.tool_call_id))}))return s.content}},Uu=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:s}of this._chatCompletions)s&&(e.completion_tokens+=s.completion_tokens,e.prompt_tokens+=s.prompt_tokens,e.total_tokens+=s.total_tokens);return e},kb=function(e){if(e.n!=null&&e.n>1)throw new P("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Db=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Jd extends Mb{static runTools(e,s,n){const a=new Jd,r={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,s,r)),a}_addMessage(e,s=!0){super._addMessage(e,s),ql(e)&&e.content&&this._emit("content",e.content)}}const $b=1,Ub=2,qb=4,zb=8,Lb=16,Bb=32,Hb=64,Gb=128,Pb=256,Xb=Gb|Pb,Yb=Lb|Bb|Xb|Hb,Ib=$b|Ub|Yb,Vb=qb|zb,Bj=Ib|Vb,ke={STR:$b,NUM:Ub,ARR:qb,OBJ:zb,NULL:Lb,BOOL:Bb,NAN:Hb,INFINITY:Gb,MINUS_INFINITY:Pb,INF:Xb,SPECIAL:Yb,ATOM:Ib,COLLECTION:Vb,ALL:Bj};class Hj extends Error{}class Gj extends Error{}function Pj(t,e=ke.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return Xj(t.trim(),e)}const Xj=(t,e)=>{const s=t.length;let n=0;const a=h=>{throw new Hj(`${h} at position ${n}`)},r=h=>{throw new Gj(`${h} at position ${n}`)},i=()=>(f(),n>=s&&a("Unexpected end of input"),t[n]==='"'?l():t[n]==="{"?c():t[n]==="["?u():t.substring(n,n+4)==="null"||ke.NULL&e&&s-n<4&&"null".startsWith(t.substring(n))?(n+=4,null):t.substring(n,n+4)==="true"||ke.BOOL&e&&s-n<4&&"true".startsWith(t.substring(n))?(n+=4,!0):t.substring(n,n+5)==="false"||ke.BOOL&e&&s-n<5&&"false".startsWith(t.substring(n))?(n+=5,!1):t.substring(n,n+8)==="Infinity"||ke.INFINITY&e&&s-n<8&&"Infinity".startsWith(t.substring(n))?(n+=8,1/0):t.substring(n,n+9)==="-Infinity"||ke.MINUS_INFINITY&e&&1<s-n&&s-n<9&&"-Infinity".startsWith(t.substring(n))?(n+=9,-1/0):t.substring(n,n+3)==="NaN"||ke.NAN&e&&s-n<3&&"NaN".startsWith(t.substring(n))?(n+=3,NaN):d()),l=()=>{const h=n;let m=!1;for(n++;n<s&&(t[n]!=='"'||m&&t[n-1]==="\\");)m=t[n]==="\\"?!m:!1,n++;if(t.charAt(n)=='"')try{return JSON.parse(t.substring(h,++n-Number(m)))}catch(x){r(String(x))}else if(ke.STR&e)try{return JSON.parse(t.substring(h,n-Number(m))+'"')}catch{return JSON.parse(t.substring(h,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{n++,f();const h={};try{for(;t[n]!=="}";){if(f(),n>=s&&ke.OBJ&e)return h;const m=l();f(),n++;try{const x=i();Object.defineProperty(h,m,{value:x,writable:!0,enumerable:!0,configurable:!0})}catch(x){if(ke.OBJ&e)return h;throw x}f(),t[n]===","&&n++}}catch{if(ke.OBJ&e)return h;a("Expected '}' at end of object")}return n++,h},u=()=>{n++;const h=[];try{for(;t[n]!=="]";)h.push(i()),f(),t[n]===","&&n++}catch{if(ke.ARR&e)return h;a("Expected ']' at end of array")}return n++,h},d=()=>{if(n===0){t==="-"&&ke.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ke.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}r(String(m))}}const h=n;for(t[n]==="-"&&n++;t[n]&&!",]}".includes(t[n]);)n++;n==s&&!(ke.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(h,n))}catch{t.substring(h,n)==="-"&&ke.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(h,t.lastIndexOf("e")))}catch(x){r(String(x))}}},f=()=>{for(;n<s&&` 
\r	`.includes(t[n]);)n++};return i()},_m=t=>Pj(t,ke.ALL^ke.NUM);var Ae,Ft,kn,_s,pc,Ri,bc,yc,vc,Ci,_c,xm;class Br extends Mb{constructor(e){super(),Ae.add(this),Ft.set(this,void 0),kn.set(this,void 0),_s.set(this,void 0),Y(this,Ft,e),Y(this,kn,[])}get currentChatCompletionSnapshot(){return E(this,_s,"f")}static fromReadableStream(e){const s=new Br(null);return s._run(()=>s._fromReadableStream(e)),s}static createChatCompletion(e,s,n){const a=new Br(s);return a._run(()=>a._runChatCompletion(e,{...s,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,s,n){var i;super._createChatCompletion;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),E(this,Ae,"m",pc).call(this);const r=await e.chat.completions.create({...s,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const l of r)E(this,Ae,"m",bc).call(this,l);if((i=r.controller.signal)!=null&&i.aborted)throw new Tt;return this._addChatCompletion(E(this,Ae,"m",Ci).call(this))}async _fromReadableStream(e,s){var i;const n=s==null?void 0:s.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),E(this,Ae,"m",pc).call(this),this._connected();const a=Pt.fromReadableStream(e,this.controller);let r;for await(const l of a)r&&r!==l.id&&this._addChatCompletion(E(this,Ae,"m",Ci).call(this)),E(this,Ae,"m",bc).call(this,l),r=l.id;if((i=a.controller.signal)!=null&&i.aborted)throw new Tt;return this._addChatCompletion(E(this,Ae,"m",Ci).call(this))}[(Ft=new WeakMap,kn=new WeakMap,_s=new WeakMap,Ae=new WeakSet,pc=function(){this.ended||Y(this,_s,void 0)},Ri=function(s){let n=E(this,kn,"f")[s.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},E(this,kn,"f")[s.index]=n,n)},bc=function(s){var a,r,i,l,c,u,d,f,h,m,x,w,N,y,g;if(this.ended)return;const n=E(this,Ae,"m",xm).call(this,s);this._emit("chunk",s,n);for(const p of s.choices){const b=n.choices[p.index];p.delta.content!=null&&((a=b.message)==null?void 0:a.role)==="assistant"&&((r=b.message)!=null&&r.content)&&(this._emit("content",p.delta.content,b.message.content),this._emit("content.delta",{delta:p.delta.content,snapshot:b.message.content,parsed:b.message.parsed})),p.delta.refusal!=null&&((i=b.message)==null?void 0:i.role)==="assistant"&&((l=b.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:p.delta.refusal,snapshot:b.message.refusal}),((c=p.logprobs)==null?void 0:c.content)!=null&&((u=b.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=p.logprobs)==null?void 0:d.content,snapshot:((f=b.logprobs)==null?void 0:f.content)??[]}),((h=p.logprobs)==null?void 0:h.refusal)!=null&&((m=b.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(x=p.logprobs)==null?void 0:x.refusal,snapshot:((w=b.logprobs)==null?void 0:w.refusal)??[]});const A=E(this,Ae,"m",Ri).call(this,b);b.finish_reason&&(E(this,Ae,"m",vc).call(this,b),A.current_tool_call_index!=null&&E(this,Ae,"m",yc).call(this,b,A.current_tool_call_index));for(const O of p.delta.tool_calls??[])A.current_tool_call_index!==O.index&&(E(this,Ae,"m",vc).call(this,b),A.current_tool_call_index!=null&&E(this,Ae,"m",yc).call(this,b,A.current_tool_call_index)),A.current_tool_call_index=O.index;for(const O of p.delta.tool_calls??[]){const T=(N=b.message.tool_calls)==null?void 0:N[O.index];T!=null&&T.type&&((T==null?void 0:T.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=T.function)==null?void 0:y.name,index:O.index,arguments:T.function.arguments,parsed_arguments:T.function.parsed_arguments,arguments_delta:((g=O.function)==null?void 0:g.arguments)??""}):(T==null||T.type,void 0))}}},yc=function(s,n){var i,l,c;if(E(this,Ae,"m",Ri).call(this,s).done_tool_calls.has(n))return;const r=(i=s.message.tool_calls)==null?void 0:i[n];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if(r.type==="function"){const u=(c=(l=E(this,Ft,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>Ul(d)&&d.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:n,arguments:r.function.arguments,parsed_arguments:li(u)?u.$parseRaw(r.function.arguments):u!=null&&u.function.strict?JSON.parse(r.function.arguments):null})}else r.type},vc=function(s){var a,r;const n=E(this,Ae,"m",Ri).call(this,s);if(s.message.content&&!n.content_done){n.content_done=!0;const i=E(this,Ae,"m",_c).call(this);this._emit("content.done",{content:s.message.content,parsed:i?i.$parseRaw(s.message.content):null})}s.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:s.message.refusal})),(a=s.logprobs)!=null&&a.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:s.logprobs.content})),(r=s.logprobs)!=null&&r.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:s.logprobs.refusal}))},Ci=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const s=E(this,_s,"f");if(!s)throw new P("request ended without sending any chunks");return Y(this,_s,void 0),Y(this,kn,[]),Yj(s,E(this,Ft,"f"))},_c=function(){var n;const s=(n=E(this,Ft,"f"))==null?void 0:n.response_format;return Id(s)?s:null},xm=function(s){var n,a,r,i;let l=E(this,_s,"f");const{choices:c,...u}=s;l?Object.assign(l,u):l=Y(this,_s,{...u,choices:[]});for(const{delta:d,finish_reason:f,index:h,logprobs:m=null,...x}of s.choices){let w=l.choices[h];if(w||(w=l.choices[h]={finish_reason:f,index:h,message:{},logprobs:m,...x}),m)if(!w.logprobs)w.logprobs=Object.assign({},m);else{const{content:O,refusal:T,...v}=m;Object.assign(w.logprobs,v),O&&((n=w.logprobs).content??(n.content=[]),w.logprobs.content.push(...O)),T&&((a=w.logprobs).refusal??(a.refusal=[]),w.logprobs.refusal.push(...T))}if(f&&(w.finish_reason=f,E(this,Ft,"f")&&Tb(E(this,Ft,"f")))){if(f==="length")throw new ub;if(f==="content_filter")throw new db}if(Object.assign(w,x),!d)continue;const{content:N,refusal:y,function_call:g,role:p,tool_calls:b,...A}=d;if(Object.assign(w.message,A),y&&(w.message.refusal=(w.message.refusal||"")+y),p&&(w.message.role=p),g&&(w.message.function_call?(g.name&&(w.message.function_call.name=g.name),g.arguments&&((r=w.message.function_call).arguments??(r.arguments=""),w.message.function_call.arguments+=g.arguments)):w.message.function_call=g),N&&(w.message.content=(w.message.content||"")+N,!w.message.refusal&&E(this,Ae,"m",_c).call(this)&&(w.message.parsed=_m(w.message.content))),b){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:O,id:T,type:v,function:C,...j}of b){const R=(i=w.message.tool_calls)[O]??(i[O]={});Object.assign(R,j),T&&(R.id=T),v&&(R.type=v),C&&(R.function??(R.function={name:C.name??"",arguments:""})),C!=null&&C.name&&(R.function.name=C.name),C!=null&&C.arguments&&(R.function.arguments+=C.arguments,Uj(E(this,Ft,"f"),R)&&(R.function.parsed_arguments=_m(R.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],s=[];let n=!1;return this.on("chunk",a=>{const r=s.shift();r?r.resolve(a):e.push(a)}),this.on("end",()=>{n=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),this.on("error",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((r,i)=>s.push({resolve:r,reject:i})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Pt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Yj(t,e){const{id:s,choices:n,created:a,model:r,system_fingerprint:i,...l}=t,c={...l,id:s,choices:n.map(({message:u,finish_reason:d,index:f,logprobs:h,...m})=>{if(!d)throw new P(`missing finish_reason for choice ${f}`);const{content:x=null,function_call:w,tool_calls:N,...y}=u,g=u.role;if(!g)throw new P(`missing role for choice ${f}`);if(w){const{arguments:p,name:b}=w;if(p==null)throw new P(`missing function_call.arguments for choice ${f}`);if(!b)throw new P(`missing function_call.name for choice ${f}`);return{...m,message:{content:x,function_call:{arguments:p,name:b},role:g,refusal:u.refusal??null},finish_reason:d,index:f,logprobs:h}}return N?{...m,index:f,finish_reason:d,logprobs:h,message:{...y,role:g,content:x,refusal:u.refusal??null,tool_calls:N.map((p,b)=>{const{function:A,type:O,id:T,...v}=p,{arguments:C,name:j,...R}=A||{};if(T==null)throw new P(`missing choices[${f}].tool_calls[${b}].id
${ki(t)}`);if(O==null)throw new P(`missing choices[${f}].tool_calls[${b}].type
${ki(t)}`);if(j==null)throw new P(`missing choices[${f}].tool_calls[${b}].function.name
${ki(t)}`);if(C==null)throw new P(`missing choices[${f}].tool_calls[${b}].function.arguments
${ki(t)}`);return{...v,id:T,type:O,function:{...R,name:j,arguments:C}}})}}:{...m,message:{...y,content:x,role:g,refusal:u.refusal??null},finish_reason:d,index:f,logprobs:h}}),created:a,model:r,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Dj(c,e)}function ki(t){return JSON.stringify(t)}class Hl extends Br{static fromReadableStream(e){const s=new Hl(null);return s._run(()=>s._fromReadableStream(e)),s}static runTools(e,s,n){const a=new Hl(s),r={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,s,r)),a}}let Kd=class extends V{constructor(){super(...arguments),this.messages=new Ab(this._client)}create(e,s){return this._client.post("/chat/completions",{body:e,...s,stream:e.stream??!1})}retrieve(e,s){return this._client.get(z`/chat/completions/${e}`,s)}update(e,s,n){return this._client.post(z`/chat/completions/${e}`,{body:s,...n})}list(e={},s){return this._client.getAPIList("/chat/completions",Ee,{query:e,...s})}delete(e,s){return this._client.delete(z`/chat/completions/${e}`,s)}parse(e,s){return qj(e.tools),this._client.chat.completions.create(e,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(n=>Vd(n,e))}runTools(e,s){return e.stream?Hl.runTools(this._client,e,s):Jd.runTools(this._client,e,s)}stream(e,s){return Br.createChatCompletion(this._client,e,s)}};Kd.Messages=Ab;class Zd extends V{constructor(){super(...arguments),this.completions=new Kd(this._client)}}Zd.Completions=Kd;const Qb=Symbol("brand.privateNullableHeaders");function*Ij(t){if(!t)return;if(Qb in t){const{values:n,nulls:a}=t;yield*n.entries();for(const r of a)yield[r,null];return}let e=!1,s;t instanceof Headers?s=t.entries():im(t)?s=t:(e=!0,s=Object.entries(t??{}));for(let n of s){const a=n[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const r=im(n[1])?n[1]:[n[1]];let i=!1;for(const l of r)l!==void 0&&(e&&!i&&(i=!0,yield[a,null]),yield[a,l])}}const H=t=>{const e=new Headers,s=new Set;for(const n of t){const a=new Set;for(const[r,i]of Ij(n)){const l=r.toLowerCase();a.has(l)||(e.delete(r),a.add(l)),i===null?(e.delete(r),s.add(l)):(e.append(r,i),s.delete(l))}}return{[Qb]:!0,values:e,nulls:s}};class Jb extends V{create(e,s){return this._client.post("/audio/speech",{body:e,...s,headers:H([{Accept:"application/octet-stream"},s==null?void 0:s.headers]),__binaryResponse:!0})}}class Kb extends V{create(e,s){return this._client.post("/audio/transcriptions",vn({body:e,...s,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class Zb extends V{create(e,s){return this._client.post("/audio/translations",vn({body:e,...s,__metadata:{model:e.model}},this._client))}}class oi extends V{constructor(){super(...arguments),this.transcriptions=new Kb(this._client),this.translations=new Zb(this._client),this.speech=new Jb(this._client)}}oi.Transcriptions=Kb;oi.Translations=Zb;oi.Speech=Jb;class Fb extends V{create(e,s){return this._client.post("/batches",{body:e,...s})}retrieve(e,s){return this._client.get(z`/batches/${e}`,s)}list(e={},s){return this._client.getAPIList("/batches",Ee,{query:e,...s})}cancel(e,s){return this._client.post(z`/batches/${e}/cancel`,s)}}class Wb extends V{create(e,s){return this._client.post("/assistants",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,s){return this._client.get(z`/assistants/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,s,n){return this._client.post(z`/assistants/${e}`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e={},s){return this._client.getAPIList("/assistants",Ee,{query:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,s){return this._client.delete(z`/assistants/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class ey extends V{create(e,s){return this._client.post("/realtime/sessions",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class ty extends V{create(e,s){return this._client.post("/realtime/transcription_sessions",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class vo extends V{constructor(){super(...arguments),this.sessions=new ey(this._client),this.transcriptionSessions=new ty(this._client)}}vo.Sessions=ey;vo.TranscriptionSessions=ty;class sy extends V{create(e,s,n){return this._client.post(z`/threads/${e}/messages`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,s,n){const{thread_id:a}=s;return this._client.get(z`/threads/${a}/messages/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,s,n){const{thread_id:a,...r}=s;return this._client.post(z`/threads/${a}/messages/${e}`,{body:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,s={},n){return this._client.getAPIList(z`/threads/${e}/messages`,Ee,{query:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,s,n){const{thread_id:a}=s;return this._client.delete(z`/threads/${a}/messages/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class ny extends V{retrieve(e,s,n){const{thread_id:a,run_id:r,...i}=s;return this._client.get(z`/threads/${a}/runs/${r}/steps/${e}`,{query:i,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,s,n){const{thread_id:a,...r}=s;return this._client.getAPIList(z`/threads/${a}/runs/${e}/steps`,Ee,{query:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}const Vj=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),s=e.length,n=new Uint8Array(s);for(let a=0;a<s;a++)n[a]=e.charCodeAt(a);return Array.from(new Float32Array(n.buffer))}};var xc={};const Dn=t=>{var e,s,n,a;if(typeof globalThis.process<"u")return((e=xc==null?void 0:xc[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(n=(s=globalThis.Deno.env)==null?void 0:s.get)==null?void 0:n.call(s,t))==null?void 0:a.trim()};var He,rn,qu,Bt,Fi,Dt,ln,sa,an,Gl,dt,Wi,el,Sr,nr,ar,wm,Sm,jm,Nm,Em,Am,Tm;class jr extends Qd{constructor(){super(...arguments),He.add(this),qu.set(this,[]),Bt.set(this,{}),Fi.set(this,{}),Dt.set(this,void 0),ln.set(this,void 0),sa.set(this,void 0),an.set(this,void 0),Gl.set(this,void 0),dt.set(this,void 0),Wi.set(this,void 0),el.set(this,void 0),Sr.set(this,void 0)}[(qu=new WeakMap,Bt=new WeakMap,Fi=new WeakMap,Dt=new WeakMap,ln=new WeakMap,sa=new WeakMap,an=new WeakMap,Gl=new WeakMap,dt=new WeakMap,Wi=new WeakMap,el=new WeakMap,Sr=new WeakMap,He=new WeakSet,Symbol.asyncIterator)](){const e=[],s=[];let n=!1;return this.on("event",a=>{const r=s.shift();r?r.resolve(a):e.push(a)}),this.on("end",()=>{n=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),this.on("error",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((r,i)=>s.push({resolve:r,reject:i})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const s=new rn;return s._run(()=>s._fromReadableStream(e)),s}async _fromReadableStream(e,s){var r;const n=s==null?void 0:s.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Pt.fromReadableStream(e,this.controller);for await(const i of a)E(this,He,"m",nr).call(this,i);if((r=a.controller.signal)!=null&&r.aborted)throw new Tt;return this._addRun(E(this,He,"m",ar).call(this))}toReadableStream(){return new Pt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,s,n,a){const r=new rn;return r._run(()=>r._runToolAssistantStream(e,s,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createToolAssistantStream(e,s,n,a){var c;const r=a==null?void 0:a.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},l=await e.submitToolOutputs(s,i,{...a,signal:this.controller.signal});this._connected();for await(const u of l)E(this,He,"m",nr).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new Tt;return this._addRun(E(this,He,"m",ar).call(this))}static createThreadAssistantStream(e,s,n){const a=new rn;return a._run(()=>a._threadAssistantStream(e,s,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,s,n,a){const r=new rn;return r._run(()=>r._runAssistantStream(e,s,n,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),r}currentEvent(){return E(this,Wi,"f")}currentRun(){return E(this,el,"f")}currentMessageSnapshot(){return E(this,Dt,"f")}currentRunStepSnapshot(){return E(this,Sr,"f")}async finalRunSteps(){return await this.done(),Object.values(E(this,Bt,"f"))}async finalMessages(){return await this.done(),Object.values(E(this,Fi,"f"))}async finalRun(){if(await this.done(),!E(this,ln,"f"))throw Error("Final run was not received.");return E(this,ln,"f")}async _createThreadAssistantStream(e,s,n){var l;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const r={...s,stream:!0},i=await e.createAndRun(r,{...n,signal:this.controller.signal});this._connected();for await(const c of i)E(this,He,"m",nr).call(this,c);if((l=i.controller.signal)!=null&&l.aborted)throw new Tt;return this._addRun(E(this,He,"m",ar).call(this))}async _createAssistantStream(e,s,n,a){var c;const r=a==null?void 0:a.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},l=await e.create(s,i,{...a,signal:this.controller.signal});this._connected();for await(const u of l)E(this,He,"m",nr).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new Tt;return this._addRun(E(this,He,"m",ar).call(this))}static accumulateDelta(e,s){for(const[n,a]of Object.entries(s)){if(!e.hasOwnProperty(n)){e[n]=a;continue}let r=e[n];if(r==null){e[n]=a;continue}if(n==="index"||n==="type"){e[n]=a;continue}if(typeof r=="string"&&typeof a=="string")r+=a;else if(typeof r=="number"&&typeof a=="number")r+=a;else if(hc(r)&&hc(a))r=this.accumulateDelta(r,a);else if(Array.isArray(r)&&Array.isArray(a)){if(r.every(i=>typeof i=="string"||typeof i=="number")){r.push(...a);continue}for(const i of a){if(!hc(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const l=i.index;if(l==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=r[l];c==null?r.push(i):r[l]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${a}, accValue: ${r}`);e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,s,n){return await this._createThreadAssistantStream(s,e,n)}async _runAssistantStream(e,s,n,a){return await this._createAssistantStream(s,e,n,a)}async _runToolAssistantStream(e,s,n,a){return await this._createToolAssistantStream(s,e,n,a)}}rn=jr,nr=function(e){if(!this.ended)switch(Y(this,Wi,e),E(this,He,"m",jm).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":E(this,He,"m",Tm).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":E(this,He,"m",Sm).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":E(this,He,"m",wm).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ar=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");if(!E(this,ln,"f"))throw Error("Final run has not been received");return E(this,ln,"f")},wm=function(e){const[s,n]=E(this,He,"m",Em).call(this,e,E(this,Dt,"f"));Y(this,Dt,s),E(this,Fi,"f")[s.id]=s;for(const a of n){const r=s.content[a.index];(r==null?void 0:r.type)=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,s),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let r=a.text,i=s.content[a.index];if(i&&i.type=="text")this._emit("textDelta",r,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=E(this,sa,"f")){if(E(this,an,"f"))switch(E(this,an,"f").type){case"text":this._emit("textDone",E(this,an,"f").text,E(this,Dt,"f"));break;case"image_file":this._emit("imageFileDone",E(this,an,"f").image_file,E(this,Dt,"f"));break}Y(this,sa,a.index)}Y(this,an,s.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(E(this,sa,"f")!==void 0){const a=e.data.content[E(this,sa,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,E(this,Dt,"f"));break;case"text":this._emit("textDone",a.text,E(this,Dt,"f"));break}}E(this,Dt,"f")&&this._emit("messageDone",e.data),Y(this,Dt,void 0)}},Sm=function(e){const s=E(this,He,"m",Nm).call(this,e);switch(Y(this,Sr,s),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&s.step_details.type=="tool_calls")for(const r of n.step_details.tool_calls)r.index==E(this,Gl,"f")?this._emit("toolCallDelta",r,s.step_details.tool_calls[r.index]):(E(this,dt,"f")&&this._emit("toolCallDone",E(this,dt,"f")),Y(this,Gl,r.index),Y(this,dt,s.step_details.tool_calls[r.index]),E(this,dt,"f")&&this._emit("toolCallCreated",E(this,dt,"f")));this._emit("runStepDelta",e.data.delta,s);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Y(this,Sr,void 0),e.data.step_details.type=="tool_calls"&&E(this,dt,"f")&&(this._emit("toolCallDone",E(this,dt,"f")),Y(this,dt,void 0)),this._emit("runStepDone",e.data,s);break}},jm=function(e){E(this,qu,"f").push(e),this._emit("event",e)},Nm=function(e){switch(e.event){case"thread.run.step.created":return E(this,Bt,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let s=E(this,Bt,"f")[e.data.id];if(!s)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const a=rn.accumulateDelta(s,n.delta);E(this,Bt,"f")[e.data.id]=a}return E(this,Bt,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":E(this,Bt,"f")[e.data.id]=e.data;break}if(E(this,Bt,"f")[e.data.id])return E(this,Bt,"f")[e.data.id];throw new Error("No snapshot available")},Em=function(e,s){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!s)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const r of a.delta.content)if(r.index in s.content){let i=s.content[r.index];s.content[r.index]=E(this,He,"m",Am).call(this,r,i)}else s.content[r.index]=r,n.push(r);return[s,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(s)return[s,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Am=function(e,s){return rn.accumulateDelta(s,e)},Tm=function(e){switch(Y(this,el,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":Y(this,ln,e.data),E(this,dt,"f")&&(this._emit("toolCallDone",E(this,dt,"f")),Y(this,dt,void 0));break}};let Fd=class extends V{constructor(){super(...arguments),this.steps=new ny(this._client)}create(e,s,n){const{include:a,...r}=s;return this._client.post(z`/threads/${e}/runs`,{query:{include:a},body:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:s.stream??!1})}retrieve(e,s,n){const{thread_id:a}=s;return this._client.get(z`/threads/${a}/runs/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,s,n){const{thread_id:a,...r}=s;return this._client.post(z`/threads/${a}/runs/${e}`,{body:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,s={},n){return this._client.getAPIList(z`/threads/${e}/runs`,Ee,{query:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,s,n){const{thread_id:a}=s;return this._client.post(z`/threads/${a}/runs/${e}/cancel`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,s,n){const a=await this.create(e,s,n);return await this.poll(a.id,{thread_id:e},n)}createAndStream(e,s,n){return jr.createAssistantStream(e,this._client.beta.threads.runs,s,n)}async poll(e,s,n){var r;const a=H([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=n==null?void 0:n.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:i,response:l}=await this.retrieve(e,s,{...n,headers:{...n==null?void 0:n.headers,...a}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const u=l.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(c=d)}}await ii(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,s,n){return jr.createAssistantStream(e,this._client.beta.threads.runs,s,n)}submitToolOutputs(e,s,n){const{thread_id:a,...r}=s;return this._client.post(z`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:s.stream??!1})}async submitToolOutputsAndPoll(e,s,n){const a=await this.submitToolOutputs(e,s,n);return await this.poll(a.id,s,n)}submitToolOutputsStream(e,s,n){return jr.createToolAssistantStream(e,this._client.beta.threads.runs,s,n)}};Fd.Steps=ny;class _o extends V{constructor(){super(...arguments),this.runs=new Fd(this._client),this.messages=new sy(this._client)}create(e={},s){return this._client.post("/threads",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,s){return this._client.get(z`/threads/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,s,n){return this._client.post(z`/threads/${e}`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,s){return this._client.delete(z`/threads/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}createAndRun(e,s){return this._client.post("/threads/runs",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:e.stream??!1})}async createAndRunPoll(e,s){const n=await this.createAndRun(e,s);return await this.runs.poll(n.id,{thread_id:n.thread_id},s)}createAndRunStream(e,s){return jr.createThreadAssistantStream(e,this._client.beta.threads,s)}}_o.Runs=Fd;_o.Messages=sy;class ci extends V{constructor(){super(...arguments),this.realtime=new vo(this._client),this.assistants=new Wb(this._client),this.threads=new _o(this._client)}}ci.Realtime=vo;ci.Assistants=Wb;ci.Threads=_o;class ay extends V{create(e,s){return this._client.post("/completions",{body:e,...s,stream:e.stream??!1})}}class ry extends V{retrieve(e,s,n){const{container_id:a}=s;return this._client.get(z`/containers/${a}/files/${e}/content`,{...n,headers:H([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}}let Wd=class extends V{constructor(){super(...arguments),this.content=new ry(this._client)}create(e,s,n){return this._client.post(z`/containers/${e}/files`,vn({body:s,...n},this._client))}retrieve(e,s,n){const{container_id:a}=s;return this._client.get(z`/containers/${a}/files/${e}`,n)}list(e,s={},n){return this._client.getAPIList(z`/containers/${e}/files`,Ee,{query:s,...n})}delete(e,s,n){const{container_id:a}=s;return this._client.delete(z`/containers/${a}/files/${e}`,{...n,headers:H([{Accept:"*/*"},n==null?void 0:n.headers])})}};Wd.Content=ry;class ef extends V{constructor(){super(...arguments),this.files=new Wd(this._client)}create(e,s){return this._client.post("/containers",{body:e,...s})}retrieve(e,s){return this._client.get(z`/containers/${e}`,s)}list(e={},s){return this._client.getAPIList("/containers",Ee,{query:e,...s})}delete(e,s){return this._client.delete(z`/containers/${e}`,{...s,headers:H([{Accept:"*/*"},s==null?void 0:s.headers])})}}ef.Files=Wd;class iy extends V{create(e,s){const n=!!e.encoding_format;let a=n?e.encoding_format:"base64";n&&Le(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const r=this._client.post("/embeddings",{body:{...e,encoding_format:a},...s});return n?r:(Le(this._client).debug("embeddings/decoding base64 embeddings from base64"),r._thenUnwrap(i=>(i&&i.data&&i.data.forEach(l=>{const c=l.embedding;l.embedding=Vj(c)}),i)))}}class ly extends V{retrieve(e,s,n){const{eval_id:a,run_id:r}=s;return this._client.get(z`/evals/${a}/runs/${r}/output_items/${e}`,n)}list(e,s,n){const{eval_id:a,...r}=s;return this._client.getAPIList(z`/evals/${a}/runs/${e}/output_items`,Ee,{query:r,...n})}}class tf extends V{constructor(){super(...arguments),this.outputItems=new ly(this._client)}create(e,s,n){return this._client.post(z`/evals/${e}/runs`,{body:s,...n})}retrieve(e,s,n){const{eval_id:a}=s;return this._client.get(z`/evals/${a}/runs/${e}`,n)}list(e,s={},n){return this._client.getAPIList(z`/evals/${e}/runs`,Ee,{query:s,...n})}delete(e,s,n){const{eval_id:a}=s;return this._client.delete(z`/evals/${a}/runs/${e}`,n)}cancel(e,s,n){const{eval_id:a}=s;return this._client.post(z`/evals/${a}/runs/${e}`,n)}}tf.OutputItems=ly;class sf extends V{constructor(){super(...arguments),this.runs=new tf(this._client)}create(e,s){return this._client.post("/evals",{body:e,...s})}retrieve(e,s){return this._client.get(z`/evals/${e}`,s)}update(e,s,n){return this._client.post(z`/evals/${e}`,{body:s,...n})}list(e={},s){return this._client.getAPIList("/evals",Ee,{query:e,...s})}delete(e,s){return this._client.delete(z`/evals/${e}`,s)}}sf.Runs=tf;let oy=class extends V{create(e,s){return this._client.post("/files",vn({body:e,...s},this._client))}retrieve(e,s){return this._client.get(z`/files/${e}`,s)}list(e={},s){return this._client.getAPIList("/files",Ee,{query:e,...s})}delete(e,s){return this._client.delete(z`/files/${e}`,s)}content(e,s){return this._client.get(z`/files/${e}/content`,{...s,headers:H([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:s=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),r=Date.now();let i=await this.retrieve(e);for(;!i.status||!a.has(i.status);)if(await ii(s),i=await this.retrieve(e),Date.now()-r>n)throw new Xd({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}};class cy extends V{}let uy=class extends V{run(e,s){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...s})}validate(e,s){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...s})}};class nf extends V{constructor(){super(...arguments),this.graders=new uy(this._client)}}nf.Graders=uy;class dy extends V{create(e,s,n){return this._client.getAPIList(z`/fine_tuning/checkpoints/${e}/permissions`,yo,{body:s,method:"post",...n})}retrieve(e,s={},n){return this._client.get(z`/fine_tuning/checkpoints/${e}/permissions`,{query:s,...n})}delete(e,s,n){const{fine_tuned_model_checkpoint:a}=s;return this._client.delete(z`/fine_tuning/checkpoints/${a}/permissions/${e}`,n)}}let af=class extends V{constructor(){super(...arguments),this.permissions=new dy(this._client)}};af.Permissions=dy;class fy extends V{list(e,s={},n){return this._client.getAPIList(z`/fine_tuning/jobs/${e}/checkpoints`,Ee,{query:s,...n})}}class rf extends V{constructor(){super(...arguments),this.checkpoints=new fy(this._client)}create(e,s){return this._client.post("/fine_tuning/jobs",{body:e,...s})}retrieve(e,s){return this._client.get(z`/fine_tuning/jobs/${e}`,s)}list(e={},s){return this._client.getAPIList("/fine_tuning/jobs",Ee,{query:e,...s})}cancel(e,s){return this._client.post(z`/fine_tuning/jobs/${e}/cancel`,s)}listEvents(e,s={},n){return this._client.getAPIList(z`/fine_tuning/jobs/${e}/events`,Ee,{query:s,...n})}pause(e,s){return this._client.post(z`/fine_tuning/jobs/${e}/pause`,s)}resume(e,s){return this._client.post(z`/fine_tuning/jobs/${e}/resume`,s)}}rf.Checkpoints=fy;class Da extends V{constructor(){super(...arguments),this.methods=new cy(this._client),this.jobs=new rf(this._client),this.checkpoints=new af(this._client),this.alpha=new nf(this._client)}}Da.Methods=cy;Da.Jobs=rf;Da.Checkpoints=af;Da.Alpha=nf;class hy extends V{}class lf extends V{constructor(){super(...arguments),this.graderModels=new hy(this._client)}}lf.GraderModels=hy;class my extends V{createVariation(e,s){return this._client.post("/images/variations",vn({body:e,...s},this._client))}edit(e,s){return this._client.post("/images/edits",vn({body:e,...s,stream:e.stream??!1},this._client))}generate(e,s){return this._client.post("/images/generations",{body:e,...s,stream:e.stream??!1})}}class gy extends V{retrieve(e,s){return this._client.get(z`/models/${e}`,s)}list(e){return this._client.getAPIList("/models",yo,e)}delete(e,s){return this._client.delete(z`/models/${e}`,s)}}class py extends V{create(e,s){return this._client.post("/moderations",{body:e,...s})}}function Qj(t,e){return!e||!Kj(e)?{...t,output_parsed:null,output:t.output.map(s=>s.type==="function_call"?{...s,parsed_arguments:null}:s.type==="message"?{...s,content:s.content.map(n=>({...n,parsed:null}))}:s)}:by(t,e)}function by(t,e){const s=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:Wj(e,a)};if(a.type==="message"){const r=a.content.map(i=>i.type==="output_text"?{...i,parsed:Jj(e,i.text)}:i);return{...a,content:r}}return a}),n=Object.assign({},t,{output:s});return Object.getOwnPropertyDescriptor(t,"output_text")||zu(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const a of n.output)if(a.type==="message"){for(const r of a.content)if(r.type==="output_text"&&r.parsed!==null)return r.parsed}return null}}),n}function Jj(t,e){var s,n,a,r;return((n=(s=t.text)==null?void 0:s.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((a=t.text)==null?void 0:a.format)?((r=t.text)==null?void 0:r.format).$parseRaw(e):JSON.parse(e)}function Kj(t){var e;return!!Id((e=t.text)==null?void 0:e.format)}function Zj(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Fj(t,e){return t.find(s=>s.type==="function"&&s.name===e)}function Wj(t,e){const s=Fj(t.tools??[],e.name);return{...e,...e,parsed_arguments:Zj(s)?s.$parseRaw(e.arguments):s!=null&&s.strict?JSON.parse(e.arguments):null}}function zu(t){const e=[];for(const s of t.output)if(s.type==="message")for(const n of s.content)n.type==="output_text"&&e.push(n.text);t.output_text=e.join("")}var Mn,Di,xs,Mi,Om,Rm,Cm,km;class of extends Qd{constructor(e){super(),Mn.add(this),Di.set(this,void 0),xs.set(this,void 0),Mi.set(this,void 0),Y(this,Di,e)}static createResponse(e,s,n){const a=new of(s);return a._run(()=>a._createOrRetrieveResponse(e,s,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,s,n){var l;const a=n==null?void 0:n.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),E(this,Mn,"m",Om).call(this);let r,i=null;"response_id"in s?(r=await e.responses.retrieve(s.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=s.starting_after??null):r=await e.responses.create({...s,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const c of r)E(this,Mn,"m",Rm).call(this,c,i);if((l=r.controller.signal)!=null&&l.aborted)throw new Tt;return E(this,Mn,"m",Cm).call(this)}[(Di=new WeakMap,xs=new WeakMap,Mi=new WeakMap,Mn=new WeakSet,Om=function(){this.ended||Y(this,xs,void 0)},Rm=function(s,n){if(this.ended)return;const a=(i,l)=>{(n==null||l.sequence_number>n)&&this._emit(i,l)},r=E(this,Mn,"m",km).call(this,s);switch(a("event",s),s.type){case"response.output_text.delta":{const i=r.output[s.output_index];if(!i)throw new P(`missing output at index ${s.output_index}`);if(i.type==="message"){const l=i.content[s.content_index];if(!l)throw new P(`missing content at index ${s.content_index}`);if(l.type!=="output_text")throw new P(`expected content to be 'output_text', got ${l.type}`);a("response.output_text.delta",{...s,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const i=r.output[s.output_index];if(!i)throw new P(`missing output at index ${s.output_index}`);i.type==="function_call"&&a("response.function_call_arguments.delta",{...s,snapshot:i.arguments});break}default:a(s.type,s);break}},Cm=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const s=E(this,xs,"f");if(!s)throw new P("request ended without sending any events");Y(this,xs,void 0);const n=e1(s,E(this,Di,"f"));return Y(this,Mi,n),n},km=function(s){let n=E(this,xs,"f");if(!n){if(s.type!=="response.created")throw new P(`When snapshot hasn't been set yet, expected 'response.created' event, got ${s.type}`);return n=Y(this,xs,s.response),n}switch(s.type){case"response.output_item.added":{n.output.push(s.item);break}case"response.content_part.added":{const a=n.output[s.output_index];if(!a)throw new P(`missing output at index ${s.output_index}`);a.type==="message"&&a.content.push(s.part);break}case"response.output_text.delta":{const a=n.output[s.output_index];if(!a)throw new P(`missing output at index ${s.output_index}`);if(a.type==="message"){const r=a.content[s.content_index];if(!r)throw new P(`missing content at index ${s.content_index}`);if(r.type!=="output_text")throw new P(`expected content to be 'output_text', got ${r.type}`);r.text+=s.delta}break}case"response.function_call_arguments.delta":{const a=n.output[s.output_index];if(!a)throw new P(`missing output at index ${s.output_index}`);a.type==="function_call"&&(a.arguments+=s.delta);break}case"response.completed":{Y(this,xs,s.response);break}}return n},Symbol.asyncIterator)](){const e=[],s=[];let n=!1;return this.on("event",a=>{const r=s.shift();r?r.resolve(a):e.push(a)}),this.on("end",()=>{n=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),this.on("error",a=>{n=!0;for(const r of s)r.reject(a);s.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((r,i)=>s.push({resolve:r,reject:i})).then(r=>r?{value:r,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=E(this,Mi,"f");if(!e)throw new P("stream ended without producing a ChatCompletion");return e}}function e1(t,e){return Qj(t,e)}class yy extends V{list(e,s={},n){return this._client.getAPIList(z`/responses/${e}/input_items`,Ee,{query:s,...n})}}class cf extends V{constructor(){super(...arguments),this.inputItems=new yy(this._client)}create(e,s){return this._client.post("/responses",{body:e,...s,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&zu(n),n))}retrieve(e,s={},n){return this._client.get(z`/responses/${e}`,{query:s,...n,stream:(s==null?void 0:s.stream)??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&zu(a),a))}delete(e,s){return this._client.delete(z`/responses/${e}`,{...s,headers:H([{Accept:"*/*"},s==null?void 0:s.headers])})}parse(e,s){return this._client.responses.create(e,s)._thenUnwrap(n=>by(n,e))}stream(e,s){return of.createResponse(this._client,e,s)}cancel(e,s){return this._client.post(z`/responses/${e}/cancel`,s)}}cf.InputItems=yy;class vy extends V{create(e,s,n){return this._client.post(z`/uploads/${e}/parts`,vn({body:s,...n},this._client))}}class uf extends V{constructor(){super(...arguments),this.parts=new vy(this._client)}create(e,s){return this._client.post("/uploads",{body:e,...s})}cancel(e,s){return this._client.post(z`/uploads/${e}/cancel`,s)}complete(e,s,n){return this._client.post(z`/uploads/${e}/complete`,{body:s,...n})}}uf.Parts=vy;const t1=async t=>{const e=await Promise.allSettled(t),s=e.filter(a=>a.status==="rejected");if(s.length){for(const a of s)console.error(a.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const n=[];for(const a of e)a.status==="fulfilled"&&n.push(a.value);return n};class _y extends V{create(e,s,n){return this._client.post(z`/vector_stores/${e}/file_batches`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,s,n){const{vector_store_id:a}=s;return this._client.get(z`/vector_stores/${a}/file_batches/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}cancel(e,s,n){const{vector_store_id:a}=s;return this._client.post(z`/vector_stores/${a}/file_batches/${e}/cancel`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,s,n){const a=await this.create(e,s);return await this.poll(e,a.id,n)}listFiles(e,s,n){const{vector_store_id:a,...r}=s;return this._client.getAPIList(z`/vector_stores/${a}/file_batches/${e}/files`,Ee,{query:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async poll(e,s,n){var r;const a=H([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=n==null?void 0:n.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const{data:i,response:l}=await this.retrieve(s,{vector_store_id:e},{...n,headers:a}).withResponse();switch(i.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const u=l.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(c=d)}}await ii(c);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:s,fileIds:n=[]},a){if(s==null||s.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const r=(a==null?void 0:a.maxConcurrency)??5,i=Math.min(r,s.length),l=this._client,c=s.values(),u=[...n];async function d(h){for(let m of h){const x=await l.files.create({file:m,purpose:"assistants"},a);u.push(x.id)}}const f=Array(i).fill(c).map(d);return await t1(f),await this.createAndPoll(e,{file_ids:u})}}class xy extends V{create(e,s,n){return this._client.post(z`/vector_stores/${e}/files`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,s,n){const{vector_store_id:a}=s;return this._client.get(z`/vector_stores/${a}/files/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,s,n){const{vector_store_id:a,...r}=s;return this._client.post(z`/vector_stores/${a}/files/${e}`,{body:r,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e,s={},n){return this._client.getAPIList(z`/vector_stores/${e}/files`,Ee,{query:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,s,n){const{vector_store_id:a}=s;return this._client.delete(z`/vector_stores/${a}/files/${e}`,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}async createAndPoll(e,s,n){const a=await this.create(e,s,n);return await this.poll(e,a.id,n)}async poll(e,s,n){var r;const a=H([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((r=n==null?void 0:n.pollIntervalMs)==null?void 0:r.toString())??void 0}]);for(;;){const i=await this.retrieve(s,{vector_store_id:e},{...n,headers:a}).withResponse(),l=i.data;switch(l.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const d=parseInt(u);isNaN(d)||(c=d)}}await ii(c);break;case"failed":case"completed":return l}}}async upload(e,s,n){const a=await this._client.files.create({file:s,purpose:"assistants"},n);return this.create(e,{file_id:a.id},n)}async uploadAndPoll(e,s,n){const a=await this.upload(e,s,n);return await this.poll(e,a.id,n)}content(e,s,n){const{vector_store_id:a}=s;return this._client.getAPIList(z`/vector_stores/${a}/files/${e}/content`,yo,{...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class xo extends V{constructor(){super(...arguments),this.files=new xy(this._client),this.fileBatches=new _y(this._client)}create(e,s){return this._client.post("/vector_stores",{body:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,s){return this._client.get(z`/vector_stores/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,s,n){return this._client.post(z`/vector_stores/${e}`,{body:s,...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}list(e={},s){return this._client.getAPIList("/vector_stores",Ee,{query:e,...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,s){return this._client.delete(z`/vector_stores/${e}`,{...s,headers:H([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}search(e,s,n){return this._client.getAPIList(z`/vector_stores/${e}/search`,yo,{body:s,method:"post",...n,headers:H([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}xo.Files=xy;xo.FileBatches=_y;var Pn,wy,tl;class Sy extends V{constructor(){super(...arguments),Pn.add(this)}async unwrap(e,s,n=this._client.webhookSecret,a=300){return await this.verifySignature(e,s,n,a),JSON.parse(e)}async verifySignature(e,s,n=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");E(this,Pn,"m",wy).call(this,n);const r=H([s]).values,i=E(this,Pn,"m",tl).call(this,r,"webhook-signature"),l=E(this,Pn,"m",tl).call(this,r,"webhook-timestamp"),c=E(this,Pn,"m",tl).call(this,r,"webhook-id"),u=parseInt(l,10);if(isNaN(u))throw new Ka("Invalid webhook timestamp format");const d=Math.floor(Date.now()/1e3);if(d-u>a)throw new Ka("Webhook timestamp is too old");if(u>d+a)throw new Ka("Webhook timestamp is too new");const f=i.split(" ").map(w=>w.startsWith("v1,")?w.substring(3):w),h=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),m=c?`${c}.${l}.${e}`:`${l}.${e}`,x=await crypto.subtle.importKey("raw",h,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const w of f)try{const N=Buffer.from(w,"base64");if(await crypto.subtle.verify("HMAC",x,N,new TextEncoder().encode(m)))return}catch{continue}throw new Ka("The given webhook signature does not match the expected signature")}}Pn=new WeakSet,wy=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},tl=function(e,s){if(!e)throw new Error("Headers are required");const n=e.get(s);if(n==null)throw new Error(`Missing required header: ${s}`);return n};var Lu,df,sl,jy;class ee{constructor({baseURL:e=Dn("OPENAI_BASE_URL"),apiKey:s=Dn("OPENAI_API_KEY"),organization:n=Dn("OPENAI_ORG_ID")??null,project:a=Dn("OPENAI_PROJECT_ID")??null,webhookSecret:r=Dn("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(Lu.add(this),sl.set(this,void 0),this.completions=new ay(this),this.chat=new Zd(this),this.embeddings=new iy(this),this.files=new oy(this),this.images=new my(this),this.audio=new oi(this),this.moderations=new py(this),this.models=new gy(this),this.fineTuning=new Da(this),this.graders=new lf(this),this.vectorStores=new xo(this),this.webhooks=new Sy(this),this.beta=new ci(this),this.batches=new Fb(this),this.uploads=new uf(this),this.responses=new cf(this),this.evals=new sf(this),this.containers=new ef(this),s===void 0)throw new P("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:s,organization:n,project:a,webhookSecret:r,...i,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&sj())throw new P(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=l.baseURL,this.timeout=l.timeout??df.DEFAULT_TIMEOUT,this.logger=l.logger??console;const c="warn";this.logLevel=c,this.logLevel=pm(l.logLevel,"ClientOptions.logLevel",this)??pm(Dn("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??c,this.fetchOptions=l.fetchOptions,this.maxRetries=l.maxRetries??2,this.fetch=l.fetch??lj(),Y(this,sl,cj),this._options=l,this.apiKey=s,this.organization=n,this.project=a,this.webhookSecret=r}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:s}){}async authHeaders(e){return H([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return gj(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Hn}`}defaultIdempotencyKey(){return`stainless-node-retry-${tb()}`}makeStatusError(e,s,n,a){return Xe.generate(e,s,n,a)}buildURL(e,s,n){const a=!E(this,Lu,"m",jy).call(this)&&n||this.baseURL,r=KS(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return FS(i)||(s={...i,...s}),typeof s=="object"&&s&&!Array.isArray(s)&&(r.search=this.stringifyQuery(s)),r.toString()}async prepareOptions(e){}async prepareRequest(e,{url:s,options:n}){}get(e,s){return this.methodRequest("get",e,s)}post(e,s){return this.methodRequest("post",e,s)}patch(e,s){return this.methodRequest("patch",e,s)}put(e,s){return this.methodRequest("put",e,s)}delete(e,s){return this.methodRequest("delete",e,s)}methodRequest(e,s,n){return this.request(Promise.resolve(n).then(a=>({method:e,path:s,...a})))}request(e,s=null){return new bo(this,this.makeRequest(e,s,void 0))}async makeRequest(e,s,n){var y,g;const a=await e,r=a.maxRetries??this.maxRetries;s==null&&(s=r),await this.prepareOptions(a);const{req:i,url:l,timeout:c}=await this.buildRequest(a,{retryCount:r-s});await this.prepareRequest(i,{url:l,options:a});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),d=n===void 0?"":`, retryOf: ${n}`,f=Date.now();if(Le(this).debug(`[${u}] sending request`,sn({retryOfRequestLogID:n,method:a.method,url:l,options:a,headers:i.headers})),(y=a.signal)!=null&&y.aborted)throw new Tt;const h=new AbortController,m=await this.fetchWithTimeout(l,i,c,h).catch(Tu),x=Date.now();if(m instanceof Error){const p=`retrying, ${s} attempts remaining`;if((g=a.signal)!=null&&g.aborted)throw new Tt;const b=Au(m)||/timed? ?out/i.test(String(m)+("cause"in m?String(m.cause):""));if(s)return Le(this).info(`[${u}] connection ${b?"timed out":"failed"} - ${p}`),Le(this).debug(`[${u}] connection ${b?"timed out":"failed"} (${p})`,sn({retryOfRequestLogID:n,url:l,durationMs:x-f,message:m.message})),this.retryRequest(a,s,n??u);throw Le(this).info(`[${u}] connection ${b?"timed out":"failed"} - error; no more retries left`),Le(this).debug(`[${u}] connection ${b?"timed out":"failed"} (error; no more retries left)`,sn({retryOfRequestLogID:n,url:l,durationMs:x-f,message:m.message})),b?new Xd:new go({cause:m})}const w=[...m.headers.entries()].filter(([p])=>p==="x-request-id").map(([p,b])=>", "+p+": "+JSON.stringify(b)).join(""),N=`[${u}${d}${w}] ${i.method} ${l} ${m.ok?"succeeded":"failed"} with status ${m.status} in ${x-f}ms`;if(!m.ok){const p=await this.shouldRetry(m);if(s&&p){const C=`retrying, ${s} attempts remaining`;return await oj(m.body),Le(this).info(`${N} - ${C}`),Le(this).debug(`[${u}] response error (${C})`,sn({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:x-f})),this.retryRequest(a,s,n??u,m.headers)}const b=p?"error; no more retries left":"error; not retryable";Le(this).info(`${N} - ${b}`);const A=await m.text().catch(C=>Tu(C).message),O=tj(A),T=O?void 0:A;throw Le(this).debug(`[${u}] response error (${b})`,sn({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,message:T,durationMs:Date.now()-f})),this.makeStatusError(m.status,O,T,m.headers)}return Le(this).info(N),Le(this).debug(`[${u}] response start`,sn({retryOfRequestLogID:n,url:m.url,status:m.status,headers:m.headers,durationMs:x-f})),{response:m,options:a,controller:h,requestLogID:u,retryOfRequestLogID:n,startTime:f}}getAPIList(e,s,n){return this.requestAPIList(s,{method:"get",path:e,...n})}requestAPIList(e,s){const n=this.makeRequest(s,null,void 0);return new jj(this,n,e)}async fetchWithTimeout(e,s,n,a){const{signal:r,method:i,...l}=s||{};r&&r.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),n),u=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,d={signal:a.signal,...u?{duplex:"half"}:{},method:"GET",...l};i&&(d.method=i.toUpperCase());try{return await this.fetch.call(void 0,e,d)}finally{clearTimeout(c)}}async shouldRetry(e){const s=e.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,s,n,a){let r;const i=a==null?void 0:a.get("retry-after-ms");if(i){const c=parseFloat(i);Number.isNaN(c)||(r=c)}const l=a==null?void 0:a.get("retry-after");if(l&&!r){const c=parseFloat(l);Number.isNaN(c)?r=Date.parse(l)-Date.now():r=c*1e3}if(!(r&&0<=r&&r<60*1e3)){const c=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(s,c)}return await ii(r),this.makeRequest(e,s-1,n)}calculateDefaultRetryTimeoutMillis(e,s){const r=s-e,i=Math.min(.5*Math.pow(2,r),8),l=1-Math.random()*.25;return i*l*1e3}async buildRequest(e,{retryCount:s=0}={}){const n={...e},{method:a,path:r,query:i,defaultBaseURL:l}=n,c=this.buildURL(r,i,l);"timeout"in n&&ej("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const{bodyHeaders:u,body:d}=this.buildBody({options:n}),f=await this.buildHeaders({options:e,method:a,bodyHeaders:u,retryCount:s});return{req:{method:a,headers:f,...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&d instanceof globalThis.ReadableStream&&{duplex:"half"},...d&&{body:d},...this.fetchOptions??{},...n.fetchOptions??{}},url:c,timeout:n.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:n,retryCount:a}){let r={};this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const i=H([r,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...ij(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:s}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=H([s]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||e instanceof Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:hb(e)}:E(this,sl,"f").call(this,{body:e,headers:n})}}df=ee,sl=new WeakMap,Lu=new WeakSet,jy=function(){return this.baseURL!=="https://api.openai.com/v1"};ee.OpenAI=df;ee.DEFAULT_TIMEOUT=6e5;ee.OpenAIError=P;ee.APIError=Xe;ee.APIConnectionError=go;ee.APIConnectionTimeoutError=Xd;ee.APIUserAbortError=Tt;ee.NotFoundError=rb;ee.ConflictError=ib;ee.RateLimitError=ob;ee.BadRequestError=sb;ee.AuthenticationError=nb;ee.InternalServerError=cb;ee.PermissionDeniedError=ab;ee.UnprocessableEntityError=lb;ee.InvalidWebhookSignatureError=Ka;ee.toFile=Rj;ee.Completions=ay;ee.Chat=Zd;ee.Embeddings=iy;ee.Files=oy;ee.Images=my;ee.Audio=oi;ee.Moderations=py;ee.Models=gy;ee.FineTuning=Da;ee.Graders=lf;ee.VectorStores=xo;ee.Webhooks=Sy;ee.Beta=ci;ee.Batches=Fb;ee.Uploads=uf;ee.Responses=cf;ee.Evals=sf;ee.Containers=ef;async function s1(t,e,s){var a;const n=`${Date.now()}_${Math.random().toString(36).substr(2,9)}`;try{console.log(`🚀 [${n}] 個別最適化メッセージ生成開始:`,{subject:t.subject,senderType:s,studyData:{subject:t.subject,questionsTotal:t.questionsTotal,questionsCorrect:t.questionsCorrect,accuracy:Math.round(t.questionsCorrect/t.questionsTotal*100),emotion:t.emotion,date:t.date},studyHistory:{continuationDays:e.continuationDays,totalDays:e.totalDays,recentRecordsCount:e.recentRecords.length}});const r=new AbortController,i=setTimeout(()=>r.abort(),15e3),l=await fetch("/api/generate-messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studyData:t,studyHistory:e,senderType:s}),signal:r.signal});if(clearTimeout(i),!l.ok)throw console.error(`❌ [${n}] API応答エラー:`,l.status,l.statusText),new Error(`API request failed: ${l.status} ${l.statusText}`);const c=await l.json();return console.log(`✅ [${n}] 個別最適化メッセージ取得成功:`,(a=c.messages)==null?void 0:a.length,"messages",c.messages),c.messages.map(d=>({...d,source:"ai"}))}catch(r){return console.error(`❌ [${n}] 個別最適化メッセージ生成失敗:`,r),console.log(`🔄 [${n}] 個別データ反映フォールバックメッセージを使用`),n1(t,e,s).map(c=>({...c,source:"fallback"}))}}function n1(t,e,s){const a={aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"}[t.subject]||t.subject,r=Math.round(t.questionsCorrect/t.questionsTotal*100),i=t.questionsCorrect,l=t.questionsTotal,c=e.continuationDays,u=`${t.subject}_${t.date}_${t.questionsCorrect}_${t.questionsTotal}_${t.emotion}_${Date.now()}`,d=Math.abs(u.split("").reduce((f,h)=>f+h.charCodeAt(0),0))%100;if(s==="parent"){const f=[`${a}${r}%、今日もよく頑張ったね😊`,`${a}${r}%達成、素晴らしい努力だね😊`,`${a}で${r}%、本当によく頑張ってる😊`,`${a}${r}%、継続する力が立派だね😊`],h=[`${a}${l}問中${i}問正解、成長してるね🎯`,`${a}で${i}/${l}問正解、力がついてる🎯`,`${a}${i}問正解、確実に上達してるね🎯`,`${a}の${i}問正解、頑張りが実ってる🎯`],m=[`${c}日継続中、パパママも応援してるよ💝`,`${c}日も続けて、本当に頑張り屋さんだね💝`,`${c}日継続、その努力を誇らしく思うよ💝`,`${c}日間コツコツと、素晴らしい姿勢だね💝`];return[{message:f[d%f.length],emoji:"😊",type:"encouraging"},{message:h[(d+1)%h.length],emoji:"🎯",type:"specific_praise"},{message:m[(d+2)%m.length],emoji:"💝",type:"loving"}]}else{const f=[`${a}${r}%、着実に力がついています📈`,`${a}で${r}%達成、順調な成長です📈`,`${a}${r}%、確実にレベルアップしています📈`,`${a}の${r}%、基礎力が定着してきました📈`],h=[`${a}${l}問中${i}問正解、素晴らしいです🎯`,`${a}で${i}/${l}問正解、理解が深まっています🎯`,`${a}${i}問正解、学習効果が表れています🎯`,`${a}の${i}問正解、着実な進歩です🎯`],m=[`${c}日継続、この調子で次のステップへ💪`,`${c}日間の継続、継続力が素晴らしいです💪`,`${c}日続けて、学習習慣が定着していますね💪`,`${c}日継続中、この momentum を大切に💪`];return[{message:f[d%f.length],emoji:"📈",type:"encouraging"},{message:h[(d+1)%h.length],emoji:"🎯",type:"instructional"},{message:m[(d+2)%m.length],emoji:"💪",type:"motivational"}]}}function a1({recordId:t,studentId:e,studyData:s,senderType:n,onSendFeedback:a,sending:r,reactionSent:i,getStudyHistory:l}){const[c,u]=U.useState([]),[d,f]=U.useState(!1),[h,m]=U.useState(null),[x,w]=U.useState(!1);U.useEffect(()=>{N()},[t,n]);const N=async()=>{let b=null;try{f(!0),m(null),console.log("🚀 メッセージ読み込み開始 - recordId:",t,"senderType:",n);try{console.log("🔍 キャッシュチェック開始:",{recordId:t,senderType:n});const{data:O,error:T}=await je.from("generated_messages").select("*").eq("record_id",t).eq("sender_type",n).single();if(console.log("🔍 キャッシュクエリ結果:",{cachedMessage:O,cacheError:T}),O&&!T){console.log("✅ キャッシュされたメッセージを使用:",O.messages),u(O.messages),w(!0),f(!1);return}else console.log("❌ キャッシュなし、新規生成します:",{cacheError:T==null?void 0:T.message})}catch(O){console.log("⚠️ キャッシュチェックでエラー（テーブル未作成？）:",O),console.log("🔄 キャッシュを使わずに新規生成します")}console.log("🔄 新しいメッセージを生成 - recordId:",t,"studyData:",{subject:s.subject,questionsTotal:s.questionsTotal,questionsCorrect:s.questionsCorrect,accuracy:Math.round(s.questionsCorrect/s.questionsTotal*100)}),b=await l(t),console.log("📊 取得した学習履歴:",b);const A=await s1(s,b,n);console.log("✅ 生成されたメッセージ:",A),await y(t,n,A),u(A),w(!1)}catch(A){console.error("個別最適化メッセージの生成に失敗:",A),m("メッセージの生成に失敗しました");const O={recentRecords:[s],totalDays:1,continuationDays:1,subjectAccuracy:{[s.subject]:{correct:s.questionsCorrect,total:s.questionsTotal}}};console.log("🔄 直接フォールバック使用 - studyData:",s,"fallbackHistory:",O);const T=g(s,O,n);await y(t,n,T),u(T),w(!1)}finally{f(!1)}},y=async(b,A,O)=>{try{console.log("💾 メッセージをキャッシュに保存:",{recordId:b,senderType:A,messagesCount:O.length,messages:O});const T={record_id:b,student_id:e,sender_type:A,messages:O,generated_at:new Date().toISOString()};console.log("💾 Upsertデータ:",T);const{data:v,error:C}=await je.from("generated_messages").upsert(T,{onConflict:"record_id,sender_type"}).select();console.log("💾 Upsert結果:",{data:v,error:C}),C?(console.error("❌ メッセージキャッシュの保存に失敗:",C),C.message.includes("does not exist")&&console.error("🚨 generated_messagesテーブルが存在しません！create-generated-messages-table.sqlを実行してください")):console.log("✅ メッセージキャッシュ保存完了:",v)}catch(T){console.error("❌ メッセージキャッシュ保存エラー:",T)}},g=(b,A,O)=>{const v={aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"}[b.subject]||b.subject,C=Math.round(b.questionsCorrect/b.questionsTotal*100),j=b.questionsCorrect,R=b.questionsTotal,M=A.continuationDays,S=`${b.subject}_${b.date}_${b.questionsCorrect}_${b.questionsTotal}_${b.emotion}_${Date.now()}`,q=Math.abs(S.split("").reduce((G,_)=>G+_.charCodeAt(0),0))%100;if(console.log(`🎯 フォールバック生成 [${t}]:`,{recordId:t,subject:b.subject,subjectName:v,accuracy:C,correctCount:j,totalCount:R,continuationDays:M,senderType:O,uniqueSeed:S,randomIndex:q}),O==="parent"){const G=[`${v}${C}%、今日もよく頑張ったね😊`,`${v}${C}%達成、素晴らしい努力だね😊`,`${v}で${C}%、本当によく頑張ってる😊`,`${v}${C}%、継続する力が立派だね😊`],_=[`${v}${R}問中${j}問正解、成長してるね🎯`,`${v}で${j}/${R}問正解、力がついてる🎯`,`${v}${j}問正解、確実に上達してるね🎯`,`${v}の${j}問正解、頑張りが実ってる🎯`],$=[`${M}日継続中、パパママも応援してるよ💝`,`${M}日も続けて、本当に頑張り屋さんだね💝`,`${M}日継続、その努力を誇らしく思うよ💝`,`${M}日間コツコツと、素晴らしい姿勢だね💝`];return[{message:G[q%G.length],emoji:"😊",type:"encouraging"},{message:_[(q+1)%_.length],emoji:"🎯",type:"specific_praise"},{message:$[(q+2)%$.length],emoji:"💝",type:"loving"}]}else{const G=[`${v}${C}%、着実に力がついています📈`,`${v}で${C}%達成、順調な成長です📈`,`${v}${C}%、確実にレベルアップしています📈`,`${v}の${C}%、基礎力が定着してきました📈`],_=[`${v}${R}問中${j}問正解、素晴らしいです🎯`,`${v}で${j}/${R}問正解、理解が深まっています🎯`,`${v}${j}問正解、学習効果が表れています🎯`,`${v}の${j}問正解、着実な進歩です🎯`],$=[`${M}日継続、この調子で次のステップへ💪`,`${M}日間の継続、継続力が素晴らしいです💪`,`${M}日続けて、学習習慣が定着していますね💪`,`${M}日継続中、この momentum を大切に💪`];return[{message:G[q%G.length],emoji:"📈",type:"encouraging"},{message:_[(q+1)%_.length],emoji:"🎯",type:"instructional"},{message:$[(q+2)%$.length],emoji:"💪",type:"motivational"}]}},p=async b=>{await a(t,b.message,b.emoji)};return(i==null?void 0:i.recordId)===t?o.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 px-6 py-4 rounded-xl flex items-center justify-center gap-3 animate-pulse",children:[o.jsx("span",{className:"text-3xl",children:"✨"}),o.jsx("span",{className:"font-bold text-lg",children:"応援メッセージを送信しました！"})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsx("h4",{className:"text-lg font-bold mb-3",children:n==="parent"?"👨‍👩‍👧‍👦 保護者として応援する:":"👨‍🏫 指導者として応援する:"}),d&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl flex items-center gap-3",children:[o.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),o.jsx("span",{className:"text-blue-700",children:c.length>0?"応援メッセージを読み込み中...":"あなた専用の応援メッセージを生成中..."})]}),h&&o.jsxs("div",{className:"bg-red-50 p-4 rounded-xl text-red-700",children:[o.jsx("p",{children:h}),o.jsx("button",{onClick:N,className:"mt-2 text-sm underline hover:no-underline",children:"再試行"})]}),!d&&c.length>0&&o.jsxs("div",{className:"space-y-3",children:[c.map((b,A)=>o.jsx("button",{onClick:()=>p(b),disabled:r,className:"w-full p-4 bg-gradient-to-r from-blue-50 to-purple-50 hover:from-blue-100 hover:to-purple-100 border border-blue-200 rounded-xl text-left transition-all hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("span",{className:"text-2xl",children:b.emoji}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-slate-800 font-medium text-lg",children:b.message}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r1(b.type)}`,children:i1(b.type)}),o.jsxs("span",{className:"text-xs text-slate-500",children:[n==="parent"?"保護者":"指導者","向け"]}),b.source&&o.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b.source==="ai"?"bg-purple-100 text-purple-700":"bg-orange-100 text-orange-700"}`,children:b.source==="ai"?"🤖 AI生成":"📝 フォールバック"})]})]})]})},A)),o.jsxs("div",{className:"mt-4 space-y-2",children:[o.jsx("div",{className:"p-3 bg-blue-50 rounded-lg text-sm text-blue-700",children:"💡 より詳しいメッセージを送りたい場合は、下の「メッセージを送る」セクションをご利用ください"}),x&&o.jsxs("div",{className:"p-2 bg-green-50 rounded-lg text-sm text-green-700 flex items-center gap-2",children:[o.jsx("span",{children:"⚡"}),o.jsx("span",{children:"高速表示: 以前に生成されたメッセージを表示中"})]})]})]})]})}function r1(t){return{encouraging:"bg-green-100 text-green-700",specific_praise:"bg-blue-100 text-blue-700",motivational:"bg-red-100 text-red-700",loving:"bg-pink-100 text-pink-700",instructional:"bg-purple-100 text-purple-700"}[t]||"bg-gray-100 text-gray-700"}function i1(t){return{encouraging:"励まし",specific_praise:"具体的称賛",motivational:"動機付け",loving:"愛情表現",instructional:"指導的"}[t]||t}const Ny=t=>/^\d{4}-\d{2}-\d{2}$/.test(t)?new Date(t).toLocaleDateString("ja-JP",{month:"numeric",day:"numeric",timeZone:"Asia/Tokyo"}):new Date(t).toLocaleString("ja-JP",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Tokyo"});function l1({userRole:t}){const{user:e}=ka(),[s,n]=U.useState(""),[a,r]=U.useState([]),[i,l]=U.useState([]),[c,u]=U.useState(!0),[d,f]=U.useState(null),[h,m]=U.useState(""),[x,w]=U.useState(!1),[N,y]=U.useState(null);U.useEffect(()=>{e!=null&&e.id&&(n(e.id),g())},[e==null?void 0:e.id]),U.useEffect(()=>{s&&g()},[s]);const g=async()=>{if(s)try{u(!0);const _=new Date;_.setDate(_.getDate()-14);const $=_.toISOString(),{data:B,error:L}=await je.from("study_records").select("*").eq("student_id",s).gte("date",$).order("date",{ascending:!1});if(L)throw console.error("❌ 学習記録取得エラー:",L),L;const{data:D,error:X}=await je.from("feedbacks").select("*").eq("student_id",s).order("created_at",{ascending:!1});X&&console.error("❌ フィードバック取得エラー:",X);const de=await p(B||[]);r(de),l(D||[])}catch(_){console.error("❌ データ取得エラー:",_),r([]),l([])}finally{u(!1)}},p=async _=>{const $=[];for(const B of _){const L=_.filter(D=>D.study_date===B.study_date&&D.subject===B.subject&&D.content_type===B.content_type&&new Date(D.date)<=new Date(B.date)).sort((D,X)=>D.attempt_number-X.attempt_number).map(D=>({attempt:D.attempt_number,correct:D.questions_correct,total:D.questions_total,accuracy:Math.round(D.questions_correct/D.questions_total*100),record_date:D.date,emotion:D.emotion}));$.push({...B,history:L})}return $},b=async _=>{try{const{data:$,error:B}=await je.from("study_records").select("student_id").eq("id",_).single();if(B)throw B;if(!($!=null&&$.student_id))throw new Error("学生IDが見つかりません");const L=new Date;L.setDate(L.getDate()-30);const D=L.toISOString().split("T")[0],{data:X,error:de}=await je.from("study_records").select("*").eq("student_id",$.student_id).gte("date",D).order("date",{ascending:!1});if(de)throw de;const it=[...new Set((X==null?void 0:X.map(ze=>ze.date))||[])],vt=A(it),_t={};return X==null||X.forEach(ze=>{_t[ze.subject]||(_t[ze.subject]={correct:0,total:0}),_t[ze.subject].correct+=ze.questions_correct,_t[ze.subject].total+=ze.questions_total}),{recentRecords:((X==null?void 0:X.slice(0,5))||[]).map(ze=>({subject:ze.subject,questionsTotal:ze.questions_total,questionsCorrect:ze.questions_correct,emotion:ze.emotion,comment:ze.comment||void 0,date:ze.date})),totalDays:it.length,continuationDays:vt,subjectAccuracy:_t}}catch($){return console.error("学習履歴データの取得に失敗:",$),{recentRecords:[],totalDays:0,continuationDays:0,subjectAccuracy:{}}}},A=_=>{if(_.length===0)return 0;const $=_.sort((L,D)=>new Date(D).getTime()-new Date(L).getTime());let B=1;for(let L=1;L<$.length;L++){const D=new Date($[L]),X=new Date($[L-1]);if(Math.floor((X.getTime()-D.getTime())/(1e3*60*60*24))===1)B++;else break}return B},O=async(_,$,B)=>{try{w(!0);const{error:L}=await je.from("feedbacks").insert([{record_id:_,student_id:s,sender_type:t,reaction_type:null,message:$}]);if(L)throw L;w(!1),y({recordId:_,type:"personalized"}),setTimeout(()=>{y(null);const D={id:Date.now(),record_id:_,student_id:s,sender_type:t,reaction_type:void 0,message:$,created_at:new Date().toISOString()};l(X=>[D,...X])},2e3)}catch(L){console.error("❌ 個別最適化メッセージ送信エラー:",L),alert("メッセージの送信に失敗しました"),w(!1),y(null)}},T=async _=>{if(!h.trim()){alert("コメントを入力してください");return}try{w(!0);const{error:$}=await je.from("feedbacks").insert([{record_id:_,student_id:s,sender_type:t,reaction_type:null,message:h.trim()}]);if($)throw $;console.log("✅ コメント送信成功");const B=h.trim();w(!1),y({recordId:_,type:"message"}),m(""),f(null),setTimeout(()=>{y(null);const L={id:Date.now(),record_id:_,student_id:s,sender_type:t,reaction_type:void 0,message:B,created_at:new Date().toISOString()};l(D=>[L,...D])},2e3)}catch($){console.error("❌ コメント送信エラー:",$),alert("コメントの送信に失敗しました")}finally{w(!1)}},v=_=>({aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"})[_]||_,C=_=>_==="class"?"授業":"宿題",j=_=>({good:"😊 よくできた",normal:"😐 普通",hard:"😞 難しかった"})[_]||_,R=_=>_==="parent"?"👨‍👩‍👧‍👦 保護者":"👨‍🏫 指導者",M=_=>i.filter($=>$.record_id===_),S=_=>_.length<=1?"":_.map($=>`(${$.correct}/${$.total})`).join(" → "),q=_=>!_||_==="1970-01-01"?"未設定":new Date(_).toLocaleDateString("ja-JP",{year:"numeric",month:"numeric",day:"numeric"}),G=_=>Ny(_);return c?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),o.jsx("p",{className:"text-lg",children:"学習記録を読み込み中..."})]}):o.jsxs("div",{className:"p-6 max-w-5xl mx-auto space-y-8",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"harmonious-header-1",children:"💌 応援・フィードバック"}),o.jsxs("p",{className:"harmonious-text-lg",children:[R(t),"として、がんばりを応援しよう！"]})]}),e&&o.jsx("div",{className:"bg-white p-6 rounded-2xl shadow-sm border",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-2xl",children:"👧"}),o.jsxs("div",{children:[o.jsxs("h3",{className:"text-lg font-bold text-slate-700",children:[e.name,"さんの学習記録"]}),o.jsxs("p",{className:"text-sm text-slate-500",children:["ID: ",e.id]})]})]})}),o.jsx("div",{className:"space-y-6",children:e?a.length>0?a.map(_=>{const $=M(_.id),B=Math.round(_.questions_correct/_.questions_total*100);return o.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-2xl font-bold text-slate-800 mb-2",children:[v(_.subject),"（",C(_.content_type),"）"]}),o.jsxs("div",{className:"flex items-center gap-4 text-slate-600",children:[o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"学習実施日:"})," ",q(_.study_date)]}),o.jsxs("div",{children:[o.jsx("span",{className:"font-medium",children:"記録日:"})," ",G(_.date)]}),_.attempt_number>1&&o.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium",children:[_.attempt_number,"回目"]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"text-3xl font-black text-blue-600",children:[B,"%"]}),o.jsxs("div",{className:"text-sm text-slate-500",children:[_.questions_correct,"/",_.questions_total,"問正解"]})]})]}),_.history.length>1&&o.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl mb-4",children:[o.jsx("h4",{className:"font-bold text-blue-800 mb-2",children:"📈 成績の変化"}),o.jsxs("div",{className:"text-blue-700",children:[o.jsx("div",{className:"font-mono text-lg mb-2",children:S(_.history)}),o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"font-medium",children:"成長:"}),o.jsxs("span",{className:"ml-2 text-green-700 font-bold",children:["+",_.history[_.history.length-1].accuracy-_.history[0].accuracy,"%改善"]}),o.jsxs("span",{className:"ml-4 text-slate-600",children:["（",_.history.length,"回挑戦）"]})]}),o.jsx("div",{className:"text-xs text-blue-600 mt-1",children:_.history.map((L,D)=>o.jsxs("span",{className:"mr-3",children:[D+1,"回目: ",G(L.record_date)]},D))})]})]}),o.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl mb-4",children:[o.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[o.jsx("span",{className:"text-lg font-medium",children:"今回の気持ち:"}),o.jsx("span",{className:"text-xl",children:j(_.emotion)})]}),_.comment&&o.jsxs("div",{children:[o.jsx("span",{className:"text-lg font-medium",children:"コメント:"}),o.jsxs("p",{className:"text-slate-700 mt-1",children:["「",_.comment,"」"]})]})]})]}),o.jsx("div",{className:"mb-6",children:o.jsx(a1,{recordId:_.id,studentId:s,studyData:{subject:_.subject,questionsTotal:_.questions_total,questionsCorrect:_.questions_correct,emotion:_.emotion,comment:_.comment||void 0,date:_.date},senderType:t,onSendFeedback:O,sending:x,reactionSent:N,getStudyHistory:b})}),o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-lg font-bold mb-3",children:"メッセージを送る:"}),(N==null?void 0:N.recordId)===_.id&&(N==null?void 0:N.type)==="message"?o.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 px-6 py-4 rounded-xl flex items-center justify-center gap-3 animate-pulse",children:[o.jsx("span",{className:"text-3xl",children:"💬"}),o.jsx("span",{className:"font-bold text-lg",children:"メッセージを送信しました！"})]}):(d==null?void 0:d.id)===_.id?o.jsxs("div",{className:"space-y-3",children:[o.jsx("textarea",{value:h,onChange:L=>m(L.target.value),maxLength:500,className:"w-full min-h-24 p-4 border-2 border-slate-200 rounded-xl focus:border-purple-400 focus:ring-4 focus:ring-purple-100 text-lg resize-none",placeholder:"応援のメッセージを書いてください..."}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"text-sm text-slate-500",children:[h.length,"/500文字"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>{f(null),m("")},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"キャンセル"}),o.jsx("button",{onClick:()=>T(_.id),disabled:x||!h.trim(),className:"px-6 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"送信中...":"送信"})]})]})]}):o.jsx("button",{onClick:()=>f(_),className:"w-full p-4 border-2 border-dashed border-slate-300 rounded-xl text-slate-500 hover:border-purple-400 hover:text-purple-600 transition-colors",children:"💬 メッセージを書く"})]}),$.length>0&&o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-bold mb-3",children:"これまでの応援:"}),o.jsx("div",{className:"space-y-2",children:$.sort((L,D)=>new Date(D.created_at).getTime()-new Date(L.created_at).getTime()).map(L=>o.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${L.sender_type==="parent"?"bg-pink-100 text-pink-700":"bg-blue-100 text-blue-700"}`,children:R(L.sender_type)}),L.reaction_type&&o.jsxs("span",{className:"text-lg",children:[L.reaction_type==="clap"&&"👏 すごい！",L.reaction_type==="thumbs"&&"👍 いいね！",L.reaction_type==="muscle"&&"💪 頑張って！"]}),o.jsx("span",{className:"text-xs text-slate-500 ml-auto",children:(()=>{const D=new Date(L.created_at);return new Date(D.getTime()+9*60*60*1e3).toLocaleString("ja-JP",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})})()})]}),L.message&&typeof L.message=="string"&&L.message.trim()!==""&&o.jsx("p",{className:"text-slate-700 text-sm mt-1",children:L.message})]},L.id))})]})]},_.id)}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("span",{className:"text-6xl mb-4 block",children:"📝"}),o.jsx("h3",{className:"text-2xl font-bold text-slate-600 mb-2",children:"学習記録がまだありません"}),o.jsx("p",{className:"text-slate-500",children:"学習記録が投稿されると、ここに表示されます"})]}):o.jsx("div",{className:"text-center p-8 bg-blue-50 rounded-2xl border border-blue-200",children:o.jsx("p",{className:"text-blue-700 text-lg",children:"📝 ログインしてください"})})})]})}function o1(){const{user:t}=ka(),[e,s]=U.useState("study"),[n,a]=U.useState([]),[r,i]=U.useState(!0),[l,c]=U.useState(null),[u,d]=U.useState("all"),[f,h]=U.useState("date"),[m,x]=U.useState("desc");U.useEffect(()=>{t!=null&&t.id&&w()},[t==null?void 0:t.id]);const w=async()=>{if(t!=null&&t.id)try{i(!0),c(null);const{data:M,error:S}=await je.from("study_records").select("*").eq("student_id",t.id).order("study_date",{ascending:!1}).order("date",{ascending:!1});if(S)throw S;const{data:q,error:G}=await je.from("feedbacks").select("*").eq("student_id",t.id).order("created_at",{ascending:!1});if(G)throw G;const _=(M||[]).map($=>({record:$,feedbacks:(q||[]).filter(B=>B.record_id===$.id)}));a(_)}catch(M){console.error("履歴データの読み込みでエラーが発生しました:",M),c("履歴データの読み込みに失敗しました。")}finally{i(!1)}},N=M=>({aptitude:"適性検査",japanese:"国語",math:"算数",science:"理科",social:"社会"})[M]||M,y=M=>({aptitude:"🎯",japanese:"✍️",math:"🔢",science:"🧪",social:"🌍"})[M]||"📚",g=M=>M==="class"?"授業":"宿題",p=M=>({good:"😊 よくできた",normal:"😐 ふつう",hard:"😵 むずかしかった"})[M]||M,b=M=>{const S=new Date(M);return`${S.getMonth()+1}/${S.getDate()}`},A=M=>Ny(M),O=()=>{let M=n;return u!=="all"&&(M=n.filter(q=>q.record.subject===u)),[...M].sort((q,G)=>{let _=0;switch(f){case"date":_=new Date(q.record.study_date).getTime()-new Date(G.record.study_date).getTime();break;case"accuracy":const $=q.record.questions_correct/q.record.questions_total*100,B=G.record.questions_correct/G.record.questions_total*100;_=$-B;break;case"emotion":const L={hard:0,normal:1,good:2};_=L[q.record.emotion]-L[G.record.emotion];break}return m==="asc"?_:-_})},T=M=>{f===M?x(m==="asc"?"desc":"asc"):(h(M),x("desc"))},v=M=>f!==M?"↕️":m==="asc"?"↑":"↓",C=()=>{const M=O();return o.jsx("div",{className:"space-y-4",children:M.map(S=>o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-2xl",children:y(S.record.subject)}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-bold text-lg",children:[N(S.record.subject),"（",g(S.record.content_type),"）"]}),o.jsxs("div",{className:"text-sm text-slate-500",children:["📅 ",b(S.record.study_date),"実施分",S.record.attempt_number>1&&o.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs",children:[S.record.attempt_number,"回目"]})]})]})]}),o.jsxs("div",{className:"text-right text-sm text-slate-500",children:["記録日: ",A(S.record.date)]})]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[o.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"正答率"}),o.jsxs("div",{className:"text-xl font-bold text-blue-700",children:[Math.round(S.record.questions_correct/S.record.questions_total*100),"%"]})]}),o.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[o.jsx("div",{className:"text-sm text-green-600 font-medium",children:"正解数"}),o.jsxs("div",{className:"text-xl font-bold text-green-700",children:[S.record.questions_correct,"/",S.record.questions_total]})]}),o.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[o.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"感想"}),o.jsx("div",{className:"text-lg text-purple-700",children:p(S.record.emotion)})]})]}),S.record.comment&&o.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg mb-4",children:[o.jsx("div",{className:"text-sm text-slate-600 font-medium mb-1",children:"コメント"}),o.jsx("p",{className:"text-slate-700",children:S.record.comment})]}),S.feedbacks.length>0&&o.jsxs("div",{className:"border-t pt-4",children:[o.jsxs("div",{className:"text-sm text-slate-600 font-medium mb-2",children:["応援メッセージ・スタンプ (",S.feedbacks.length,"件)"]}),o.jsx("div",{className:"space-y-2",children:S.feedbacks.map(q=>o.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${q.sender_type==="parent"?"bg-pink-100 text-pink-800":"bg-blue-100 text-blue-800"}`,children:q.sender_type==="parent"?"👨‍👩‍👧‍👦":"👨‍🏫"}),q.reaction_type&&o.jsxs("span",{className:"text-lg",children:[q.reaction_type==="clap"&&"👏",q.reaction_type==="thumbs"&&"👍",q.reaction_type==="muscle"&&"💪"]}),o.jsx("span",{className:"flex-1 text-slate-700",children:q.message||(q.reaction_type==="clap"?"すごい！":q.reaction_type==="thumbs"?"いいね！":q.reaction_type==="muscle"?"頑張って！":"")}),o.jsx("span",{className:"text-xs text-slate-500",children:A(q.created_at)})]},q.id))})]})]},S.record.id))})},j=()=>{const M=n.flatMap(S=>S.feedbacks.map(q=>({feedback:q,record:S.record}))).sort((S,q)=>new Date(q.feedback.created_at).getTime()-new Date(S.feedback.created_at).getTime());return o.jsx("div",{className:"space-y-4",children:M.map(({feedback:S,record:q})=>o.jsxs("div",{className:"bg-white p-6 rounded-xl shadow border",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("span",{className:`px-3 py-1 rounded text-sm font-medium ${S.sender_type==="parent"?"bg-pink-100 text-pink-800":"bg-blue-100 text-blue-800"}`,children:S.sender_type==="parent"?"👨‍👩‍👧‍👦 保護者":"👨‍🏫 指導者"}),S.reaction_type&&o.jsxs("span",{className:"text-2xl",children:[S.reaction_type==="clap"&&"👏",S.reaction_type==="thumbs"&&"👍",S.reaction_type==="muscle"&&"💪"]}),o.jsx("span",{className:"text-sm text-slate-500 ml-auto",children:A(S.created_at)})]}),o.jsxs("div",{className:"mb-3 p-3 bg-slate-50 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-lg",children:y(q.subject)}),o.jsx("span",{className:"font-semibold",children:N(q.subject)}),o.jsx("span",{className:"text-sm px-2 py-1 bg-slate-200 text-slate-600 rounded",children:g(q.content_type)})]}),o.jsxs("div",{className:"text-sm text-slate-600",children:["📅 ",b(q.study_date),"実施分 | 🎯 ",q.questions_correct,"/",q.questions_total,"問正解 (",Math.round(q.questions_correct/q.questions_total*100),"%)"]})]}),S.message&&typeof S.message=="string"&&S.message.trim()!==""?o.jsx("p",{className:"text-slate-700 text-lg",children:S.message}):S.reaction_type&&o.jsxs("p",{className:"text-slate-600 italic",children:[S.reaction_type==="clap"&&"すごい！",S.reaction_type==="thumbs"&&"いいね！",S.reaction_type==="muscle"&&"頑張って！"]})]},S.id))})},R=()=>{const M=[...n.map(S=>({type:"study",data:S,date:S.record.date})),...n.flatMap(S=>S.feedbacks.map(q=>({type:"feedback",data:{feedback:q,record:S.record},date:q.created_at})))].sort((S,q)=>new Date(q.date).getTime()-new Date(S.date).getTime());return o.jsx("div",{className:"space-y-4",children:M.map((S,q)=>o.jsx("div",{className:"bg-white p-6 rounded-xl shadow border",children:S.type==="study"?o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded text-sm font-medium",children:"📝 学習記録"}),o.jsx("span",{className:"text-sm text-slate-500",children:A(S.data.record.date)})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-xl",children:y(S.data.record.subject)}),o.jsx("span",{className:"font-semibold",children:N(S.data.record.subject)}),o.jsx("span",{className:"text-sm px-2 py-1 bg-slate-100 text-slate-600 rounded",children:g(S.data.record.content_type)}),o.jsxs("span",{className:"text-sm text-blue-600 font-medium",children:[S.data.record.questions_correct,"/",S.data.record.questions_total,"問正解 (",Math.round(S.data.record.questions_correct/S.data.record.questions_total*100),"%)"]})]})]}):o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 rounded text-sm font-medium",children:"💌 応援"}),o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${S.data.feedback.sender_type==="parent"?"bg-pink-100 text-pink-800":"bg-blue-100 text-blue-800"}`,children:S.data.feedback.sender_type==="parent"?"👨‍👩‍👧‍👦":"👨‍🏫"}),S.data.feedback.reaction_type&&o.jsxs("span",{className:"text-lg",children:[S.data.feedback.reaction_type==="clap"&&"👏",S.data.feedback.reaction_type==="thumbs"&&"👍",S.data.feedback.reaction_type==="muscle"&&"💪"]}),o.jsx("span",{className:"text-sm text-slate-500",children:A(S.data.feedback.created_at)})]}),o.jsxs("div",{className:"text-slate-700",children:[N(S.data.record.subject),"への応援: ",S.data.feedback.message||(S.data.feedback.reaction_type==="clap"?"すごい！":S.data.feedback.reaction_type==="thumbs"?"いいね！":S.data.feedback.reaction_type==="muscle"?"頑張って！":"")]})]})},`${S.type}-${q}`))})};return r?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"animate-spin text-4xl",children:"⏳"}),o.jsx("p",{className:"mt-4 text-slate-600",children:"履歴を読み込み中..."})]}):l?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"text-4xl mb-4",children:"❌"}),o.jsx("p",{className:"text-red-600",children:l}),o.jsx("button",{onClick:w,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"再試行"})]}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("div",{className:"mb-8 text-center",children:[o.jsx("h1",{className:"harmonious-header-1",children:"📚 学習履歴"}),o.jsx("p",{className:"harmonious-text-lg",children:"これまでの学習記録と応援メッセージを確認できます"})]}),o.jsx("div",{className:"bg-white rounded-xl shadow-lg mb-6",children:o.jsxs("div",{className:"flex border-b",children:[o.jsx("button",{onClick:()=>s("study"),className:`flex-1 py-4 px-6 text-center font-medium transition-colors ${e==="study"?"bg-blue-500 text-white rounded-t-xl":"text-slate-600 hover:text-blue-500"}`,children:"📝 学習履歴"}),o.jsx("button",{onClick:()=>s("feedback"),className:`flex-1 py-4 px-6 text-center font-medium transition-colors ${e==="feedback"?"bg-blue-500 text-white rounded-t-xl":"text-slate-600 hover:text-blue-500"}`,children:"💌 応援履歴"}),o.jsx("button",{onClick:()=>s("combined"),className:`flex-1 py-4 px-6 text-center font-medium transition-colors ${e==="combined"?"bg-blue-500 text-white rounded-t-xl":"text-slate-600 hover:text-blue-500"}`,children:"📊 まとめて表示"})]})}),e==="study"&&o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[o.jsx("span",{children:"🔍"}),"絞り込み・並び替え"]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"科目で絞り込み"}),o.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-2",children:[o.jsx("button",{onClick:()=>d("all"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors min-h-[44px] ${u==="all"?"bg-blue-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"すべて"}),o.jsxs("button",{onClick:()=>d("aptitude"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${u==="aptitude"?"bg-purple-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"🎯"})," 適性"]}),o.jsxs("button",{onClick:()=>d("japanese"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${u==="japanese"?"bg-rose-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"✍️"})," 国語"]}),o.jsxs("button",{onClick:()=>d("math"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${u==="math"?"bg-blue-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"🔢"})," 算数"]}),o.jsxs("button",{onClick:()=>d("science"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${u==="science"?"bg-green-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"🧪"})," 理科"]}),o.jsxs("button",{onClick:()=>d("social"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${u==="social"?"bg-amber-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"🌍"})," 社会"]})]})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"並び替え"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2",children:[o.jsxs("button",{onClick:()=>T("date"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${f==="date"?"bg-blue-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"📅"})," 実施日 ",o.jsx("span",{className:"ml-1",children:v("date")})]}),o.jsxs("button",{onClick:()=>T("accuracy"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${f==="accuracy"?"bg-green-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"🎯"})," 正答率 ",o.jsx("span",{className:"ml-1",children:v("accuracy")})]}),o.jsxs("button",{onClick:()=>T("emotion"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 min-h-[44px] ${f==="emotion"?"bg-purple-500 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:[o.jsx("span",{className:"hidden sm:inline",children:"😊"})," 感想 ",o.jsx("span",{className:"ml-1",children:v("emotion")})]})]})]}),o.jsx("div",{className:"pt-4 border-t border-slate-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm text-slate-600",children:[o.jsxs("span",{className:"font-medium",children:["表示中: ",o.jsx("span",{className:"text-blue-600",children:u==="all"?"すべての科目":N(u)})]}),o.jsx("span",{className:"hidden sm:inline",children:"•"}),o.jsxs("span",{children:["並び順: ",o.jsx("span",{className:"font-medium",children:f==="date"?"実施日":f==="accuracy"?"正答率":"感想"}),o.jsx("span",{className:"text-slate-500",children:m==="desc"?" (高い順)":" (低い順)"})]}),o.jsx("span",{className:"hidden sm:inline",children:"•"}),o.jsxs("span",{className:"font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded",children:[O().length,"件"]})]})})]}),o.jsxs("div",{className:"mb-8",children:[e==="study"&&C(),e==="feedback"&&j(),e==="combined"&&R()]}),n.length===0&&o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:"📚"}),o.jsx("h2",{className:"text-2xl font-bold text-slate-600 mb-2",children:"履歴がありません"}),o.jsx("p",{className:"text-slate-500",children:"学習記録をつけると、ここに履歴が表示されます"})]})]})})}function c1({userRole:t}){const{user:e}=ka(),[s,n]=U.useState([]),[a,r]=U.useState(!0),[i,l]=U.useState(null),[c,u]=U.useState(!1),[d,f]=U.useState(""),[h,m]=U.useState(""),[x,w]=U.useState(""),[N,y]=U.useState(null),[g,p]=U.useState(""),[b,A]=U.useState(!1),[O,T]=U.useState(null),[v,C]=U.useState(null),[j,R]=U.useState(!1),[M,S]=U.useState(!1);U.useEffect(()=>{if(e!=null&&e.id){q();const D=new Date().toISOString().split("T")[0];f(D)}},[e==null?void 0:e.id]),U.useEffect(()=>{if(d&&s.length>0){const D=s.find(X=>X.date===d);D?(T(D),m(D.reflection_content),w(D.improvement_points||""),A(!0)):(T(null),m(""),w(""),A(!1))}},[d,s]);const q=async()=>{if(e!=null&&e.id)try{r(!0),l(null);const{data:D,error:X}=await je.from("reflections").select("*").eq("student_id",e.id).order("date",{ascending:!1});if(X)throw X;n(D||[])}catch(D){console.error("振り返りデータの読み込みでエラーが発生しました:",D),l("振り返りデータの読み込みに失敗しました。")}finally{r(!1)}},G=async D=>{if(D.preventDefault(),!d||!h.trim()){l("日付と振り返り内容は必須です。");return}try{if(u(!0),l(null),b&&O){const{error:de}=await je.from("reflections").update({reflection_content:h.trim(),improvement_points:x.trim()||null}).eq("id",O.id);if(de)throw de}else{const{error:de}=await je.from("reflections").insert({student_id:e.id,date:d,reflection_content:h.trim(),improvement_points:x.trim()||null});if(de)throw de}m(""),w(""),A(!1),T(null),await q(),C(b?"✅ 振り返りを更新しました！":"✅ 振り返りを保存しました！"),R(!0),S(!0),setTimeout(()=>S(!1),1e3),setTimeout(()=>{R(!1),setTimeout(()=>C(null),300)},3e3)}catch(X){console.error("振り返りの保存でエラーが発生しました:",X),l("振り返りの保存に失敗しました。")}finally{u(!1)}},_=()=>{m(""),w(""),A(!1),T(null);const D=new Date().toISOString().split("T")[0];f(D)},$=async D=>{if(!g.trim()){l("コメントを入力してください。");return}try{u(!0),l(null);const{error:X}=await je.from("reflections").update({teacher_comment:g.trim()}).eq("id",D);if(X)throw X;p(""),y(null),await q(),C("✅ 先生のコメントを追加しました！"),R(!0),setTimeout(()=>{R(!1),setTimeout(()=>C(null),300)},3e3)}catch(X){console.error("先生コメントの保存でエラーが発生しました:",X),l("先生コメントの保存に失敗しました。")}finally{u(!1)}},B=D=>new Date(D).toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric",weekday:"short"}),L=D=>{const X=new Date(D);return new Date(X.getTime()+9*60*60*1e3).toLocaleString("ja-JP",{month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})};return a?o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"animate-spin text-4xl",children:"⏳"}),o.jsx("p",{className:"mt-4 text-slate-600",children:"振り返りデータを読み込み中..."})]}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs("div",{className:"mb-8 text-center",children:[o.jsx("h1",{className:"harmonious-header-1",children:"🤔 振り返り"}),o.jsx("p",{className:"harmonious-text-lg",children:t==="student"?"学習を振り返って、成長につなげよう":t==="teacher"?"生徒の振り返りにコメントして、成長をサポートしよう":"生徒の振り返りを確認して、成長を見守ろう"})]}),i&&o.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:o.jsx("p",{className:"text-red-700",children:i})}),v&&o.jsx("div",{className:`mb-6 p-4 bg-green-50 border border-green-200 rounded-lg transition-all duration-300 ${j?"opacity-100 transform translate-y-0":"opacity-0 transform -translate-y-2"}`,children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl animate-bounce",children:"🎉"}),o.jsx("p",{className:"text-green-700 font-medium",children:v})]})}),t==="student"&&o.jsxs("div",{className:`bg-white rounded-xl shadow-lg p-6 mb-8 transition-all duration-1000 ${M?"ring-4 ring-green-200 shadow-green-100 shadow-2xl":""}`,children:[o.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:b?"📝":"✍️"}),b?"振り返りを編集する":"振り返りを記入する"]}),o.jsxs("form",{onSubmit:G,className:"space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["振り返り日付 ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"date",value:d,onChange:D=>f(D.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),b&&o.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"📝 既存の振り返りを編集中です。"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["今日の振り返り ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:h,onChange:D=>m(D.target.value),placeholder:"今日の学習はどうでしたか？うまくいったこと、うまくいかなかったことを書いてみましょう。",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-32 resize-none",required:!0}),o.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[h.length,"/500文字"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"明日からの改善点"}),o.jsx("textarea",{value:x,onChange:D=>w(D.target.value),placeholder:"明日からどんなことを改善したいですか？具体的な目標を書いてみましょう。",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-24 resize-none"}),o.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[x.length,"/300文字"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{type:"submit",disabled:c,className:`flex-1 py-3 text-white rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 ${c?"bg-blue-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 hover:shadow-lg transform hover:scale-105"}`,children:c?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"保存中..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-lg",children:b?"💾":"📝"}),b?"変更を保存":"振り返りを保存"]})}),b&&o.jsx("button",{type:"button",onClick:_,className:"px-6 py-3 bg-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-400 transition-colors",children:"キャンセル"})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[o.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[o.jsx("span",{className:"text-2xl",children:"📖"}),"これまでの振り返り"]}),s.length>0?o.jsx("div",{className:"space-y-6",children:s.map(D=>o.jsxs("div",{className:"border border-slate-200 rounded-lg p-6",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:B(D.date)}),o.jsxs("div",{className:"flex items-center gap-2",children:[t==="student"&&o.jsx("button",{onClick:()=>{f(D.date),m(D.reflection_content),w(D.improvement_points||""),T(D),A(!0),window.scrollTo({top:0,behavior:"smooth"})},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"✏️ 編集"}),o.jsxs("span",{className:"text-sm text-slate-500",children:["記録: ",L(D.created_at)]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"📝 振り返り内容"}),o.jsx("p",{className:"text-slate-700 whitespace-pre-wrap",children:D.reflection_content})]}),D.improvement_points&&o.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"🎯 改善点"}),o.jsx("p",{className:"text-slate-700 whitespace-pre-wrap",children:D.improvement_points})]}),D.teacher_comment?o.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-purple-800 mb-2",children:"👨‍🏫 先生からのコメント"}),o.jsx("p",{className:"text-slate-700 whitespace-pre-wrap",children:D.teacher_comment})]}):t==="teacher"?o.jsx("div",{className:"bg-slate-50 p-4 rounded-lg",children:(N==null?void 0:N.id)===D.id?o.jsxs("div",{className:"space-y-3",children:[o.jsx("h4",{className:"font-medium text-slate-800",children:"👨‍🏫 先生からのコメントを追加"}),o.jsx("textarea",{value:g,onChange:X=>p(X.target.value),placeholder:"生徒の振り返りに対してコメントを書いてください。",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 h-24 resize-none"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>$(D.id),disabled:c,className:`px-4 py-2 text-white rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${c?"bg-blue-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 hover:shadow-lg transform hover:scale-105"}`,children:c?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"保存中..."]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"💬"}),"コメント保存"]})}),o.jsx("button",{onClick:()=>{y(null),p("")},className:"px-4 py-2 bg-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-400 transition-colors",children:"キャンセル"})]})]}):o.jsx("button",{onClick:()=>y(D),className:"text-blue-600 hover:text-blue-800 font-medium",children:"💬 コメントを追加"})}):null]})]},D.id))}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-6xl mb-4",children:"📝"}),o.jsx("h2",{className:"text-2xl font-bold text-slate-600 mb-2",children:"振り返りがありません"}),o.jsx("p",{className:"text-slate-500",children:t==="student"?"上のフォームから振り返りを記入してみましょう":"生徒が振り返りを記入すると、ここに表示されます"})]})]})]})})}function u1(){const[t,e]=U.useState([]),[s,n]=U.useState(!0),[a,r]=U.useState(""),[i,l]=U.useState("date"),[c,u]=U.useState("desc"),[d,f]=U.useState(""),[h,m]=U.useState(""),[x,w]=U.useState("");U.useEffect(()=>{N()},[]);const N=async()=>{try{n(!0);const{data:j,error:R}=await je.from("study_records").select("*").order("date",{ascending:!1});if(R)throw R;const M=(j||[]).map(S=>({...S,student_name:S.student_id||"不明"}));e(M)}catch(j){console.error("記録取得エラー:",j),r("記録の取得に失敗しました")}finally{n(!1)}},y=j=>{i===j?u(c==="asc"?"desc":"asc"):(l(j),u("desc"))},g=t.filter(j=>!(d&&!j.student_name.toLowerCase().includes(d.toLowerCase())||h&&j.subject!==h||x&&!j.study_date.includes(x))).sort((j,R)=>{let M,S;return i==="accuracy"?(M=j.questions_correct/j.questions_total*100,S=R.questions_correct/R.questions_total*100):i==="date"?(M=new Date(j.date).getTime(),S=new Date(R.date).getTime()):i==="student_name"?(M=j.student_name,S=R.student_name):i==="subject"?(M=j.subject,S=R.subject):(M=0,S=0),M<S?c==="asc"?-1:1:M>S?c==="asc"?1:-1:0}),p=j=>({aptitude:"適性",japanese:"国語",math:"算数",science:"理科",social:"社会"})[j]||j,b=j=>j==="class"?"授業":"宿題",A=j=>({good:"😊",normal:"😐",hard:"😞"})[j]||j,O=j=>i!==j?"↕️":c==="asc"?"↑":"↓",T=[...new Set(t.map(j=>j.student_name))].sort(),v=[...new Set(t.map(j=>j.subject))].sort(),C=()=>{const j=["記録日時","学生名","科目","種別","学習実施日","挑戦回数","問題数","正解数","正答率","気持ち","コメント"],R=g.map(_=>[new Date(_.date).toLocaleString("ja-JP"),_.student_name,p(_.subject),b(_.content_type),new Date(_.study_date).toLocaleDateString("ja-JP"),_.attempt_number,_.questions_total,_.questions_correct,Math.round(_.questions_correct/_.questions_total*100)+"%",_.emotion==="good"?"よくできた":_.emotion==="normal"?"普通":"難しかった",_.comment||""]),M=[j,...R].map(_=>_.map($=>`"${$}"`).join(",")).join(`
`),S=new Blob([M],{type:"text/csv;charset=utf-8;"}),q=document.createElement("a"),G=URL.createObjectURL(S);q.setAttribute("href",G),q.setAttribute("download",`学習記録_${new Date().toLocaleDateString("ja-JP").replace(/\//g,"")}.csv`),q.style.visibility="hidden",document.body.appendChild(q),q.click(),document.body.removeChild(q)};return s?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-4xl mb-4",children:"📊"}),o.jsx("p",{className:"text-lg text-slate-600",children:"記録を読み込んでいます..."})]})})}):a?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"text-4xl mb-4",children:"❌"}),o.jsx("p",{className:"text-lg text-red-600",children:a}),o.jsx("button",{onClick:N,className:"mt-4 harmonious-button-primary",children:"再試行"})]})})}):o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:o.jsxs("div",{className:"max-w-7xl mx-auto",children:[o.jsxs("div",{className:"mb-8 text-center",children:[o.jsx("h1",{className:"harmonious-header-1",children:"📊 学習記録管理"}),o.jsx("p",{className:"harmonious-text-lg",children:"全学生の学習記録を一覧・管理できます"})]}),o.jsxs("div",{className:"harmonious-card mb-6",children:[o.jsx("h2",{className:"harmonious-header-3 mb-4",children:"🔍 フィルター・検索"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"学生名で検索"}),o.jsx("input",{type:"text",value:d,onChange:j=>f(j.target.value),placeholder:"学生名を入力...",className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"科目で絞り込み"}),o.jsxs("select",{value:h,onChange:j=>m(j.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"全ての科目"}),v.map(j=>o.jsx("option",{value:j,children:p(j)},j))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"日付で絞り込み"}),o.jsx("input",{type:"date",value:x,onChange:j=>w(j.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[o.jsxs("p",{className:"text-sm text-slate-600",children:[g.length," 件の記録を表示中（全 ",t.length," 件）",g.length!==t.length&&o.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs",children:"フィルター適用中"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>{f(""),m(""),w("")},className:"harmonious-button-secondary text-sm",children:"フィルターをクリア"}),o.jsx("button",{onClick:N,className:"harmonious-button-secondary text-sm",children:"🔄 更新"}),g.length>0&&o.jsx("button",{onClick:C,className:"harmonious-button-primary text-sm",children:"📊 CSV出力"})]})]})]}),o.jsxs("div",{className:"harmonious-card",children:[o.jsx("h2",{className:"harmonious-header-3 mb-4",children:"📋 学習記録一覧"}),g.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"text-4xl mb-4",children:"📝"}),o.jsx("p",{className:"text-lg text-slate-600",children:"表示する記録がありません"})]}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full border-collapse min-w-[1200px]",children:[o.jsx("thead",{className:"bg-slate-50",children:o.jsxs("tr",{className:"border-b-2 border-slate-200",children:[o.jsxs("th",{className:"text-left p-3 cursor-pointer hover:bg-slate-100 transition-colors font-semibold text-slate-700 whitespace-nowrap",onClick:()=>y("date"),children:["記録日時 ",O("date")]}),o.jsxs("th",{className:"text-left p-3 cursor-pointer hover:bg-slate-100 transition-colors font-semibold text-slate-700 whitespace-nowrap",onClick:()=>y("student_name"),children:["学生名 ",O("student_name")]}),o.jsxs("th",{className:"text-left p-3 cursor-pointer hover:bg-slate-100 transition-colors font-semibold text-slate-700 whitespace-nowrap",onClick:()=>y("subject"),children:["科目 ",O("subject")]}),o.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 whitespace-nowrap",children:"種別"}),o.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 whitespace-nowrap",children:"学習実施日"}),o.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 whitespace-nowrap",children:"挑戦回数"}),o.jsxs("th",{className:"text-left p-3 cursor-pointer hover:bg-slate-100 transition-colors font-semibold text-slate-700 whitespace-nowrap",onClick:()=>y("accuracy"),children:["成績 ",O("accuracy")]}),o.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 whitespace-nowrap",children:"気持ち"}),o.jsx("th",{className:"text-left p-3 font-semibold text-slate-700 whitespace-nowrap",children:"コメント"})]})}),o.jsx("tbody",{children:g.map(j=>o.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[o.jsx("td",{className:"p-3",children:o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:new Date(j.date).toLocaleDateString("ja-JP")}),o.jsx("div",{className:"text-slate-500",children:new Date(j.date).toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"})})]})}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:"font-medium text-blue-700",children:j.student_name})}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:p(j.subject)})}),o.jsx("td",{className:"p-3",children:o.jsx("span",{className:`px-2 py-1 rounded text-sm ${j.content_type==="class"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:b(j.content_type)})}),o.jsx("td",{className:"p-3 text-sm text-slate-600",children:new Date(j.study_date).toLocaleDateString("ja-JP")}),o.jsx("td",{className:"p-3",children:o.jsxs("span",{className:"px-2 py-1 bg-slate-100 text-slate-700 rounded text-sm",children:[j.attempt_number,"回目"]})}),o.jsx("td",{className:"p-3",children:o.jsxs("div",{className:"text-sm",children:[o.jsxs("div",{className:"font-medium",children:[j.questions_correct,"/",j.questions_total]}),o.jsxs("div",{className:`text-xs ${j.questions_correct/j.questions_total*100>=80?"text-green-600":j.questions_correct/j.questions_total*100>=60?"text-yellow-600":"text-red-600"}`,children:[Math.round(j.questions_correct/j.questions_total*100),"%"]})]})}),o.jsx("td",{className:"p-3 text-lg",children:A(j.emotion)}),o.jsx("td",{className:"p-3 max-w-xs",children:j.comment?o.jsx("div",{className:"text-sm text-slate-600 truncate",title:j.comment,children:j.comment}):o.jsx("span",{className:"text-slate-400 text-sm",children:"-"})})]},j.id))})]})})]}),g.length>0&&o.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"harmonious-metrics-card",children:[o.jsx("div",{className:"harmonious-metrics-value",children:g.length}),o.jsx("div",{className:"harmonious-metrics-label",children:"総記録数"})]}),o.jsxs("div",{className:"harmonious-metrics-card",children:[o.jsx("div",{className:"harmonious-metrics-value",children:T.length}),o.jsx("div",{className:"harmonious-metrics-label",children:"学生数"})]}),o.jsxs("div",{className:"harmonious-metrics-card",children:[o.jsxs("div",{className:"harmonious-metrics-value",children:[Math.round(g.reduce((j,R)=>j+R.questions_correct/R.questions_total*100,0)/g.length),"%"]}),o.jsx("div",{className:"harmonious-metrics-label",children:"平均正答率"})]}),o.jsxs("div",{className:"harmonious-metrics-card",children:[o.jsxs("div",{className:"harmonious-metrics-value",children:[Math.round(g.filter(j=>j.questions_correct/j.questions_total*100>=80).length/g.length*100),"%"]}),o.jsx("div",{className:"harmonious-metrics-label",children:"80%以上達成率"})]})]})]})})}const d1={68442921:{id:"68442921",name:"齋藤大洋"},68905181:{id:"68905181",name:"齋藤利嵩"},67022243:{id:"67022243",name:"笹島実弥子"},68923295:{id:"68923295",name:"杉山翔哉"},68923309:{id:"68923309",name:"杉山愛翔"},70638489:{id:"70638489",name:"德田創大"},68883679:{id:"68883679",name:"深作巴"},68895933:{id:"68895933",name:"福地美鈴"},68805713:{id:"68805713",name:"松下颯真"},11111111:{id:"11111111",name:"テスト生徒１"},22222222:{id:"22222222",name:"テスト生徒２"},33333333:{id:"33333333",name:"テスト生徒３"},44444444:{id:"44444444",name:"テスト生徒４"},55555555:{id:"55555555",name:"テスト生徒５"},66666666:{id:"66666666",name:"テスト生徒６"}},f1=t=>d1[t]||null,Ey=({children:t,onClick:e,disabled:s=!1,className:n="",variant:a="primary",type:r="button"})=>{const i="inline-flex items-center justify-center rounded-xl font-medium transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed",l={primary:"bg-blue-500 hover:bg-blue-600 text-white focus:ring-blue-500",secondary:"bg-gray-500 hover:bg-gray-600 text-white focus:ring-gray-500",outline:"border-2 border-gray-300 hover:border-gray-400 bg-white hover:bg-gray-50 text-gray-700 focus:ring-gray-500"};return o.jsx("button",{type:r,onClick:e,disabled:s,className:`${i} ${l[a]} ${n}`,children:t})},h1=({id:t,type:e="text",value:s,onChange:n,placeholder:a,className:r="",min:i,max:l,required:c=!1,disabled:u=!1})=>o.jsx("input",{id:t,type:e,value:s,onChange:n,placeholder:a,min:i,max:l,required:c,disabled:u,className:`w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-colors duration-300 ${r}`}),Ay=({children:t,className:e="",onClick:s})=>o.jsx("div",{className:`bg-white rounded-2xl shadow-lg ${e} ${s?"cursor-pointer":""}`,onClick:s,children:t}),m1=({onLogin:t})=>{const[e,s]=U.useState(""),[n,a]=U.useState(""),[r,i]=U.useState(!1),l=async c=>{c.preventDefault(),a(""),i(!0),await new Promise(d=>setTimeout(d,800));const u=f1(e);u?t(u):a("会員番号が見つかりません"),i(!1)};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 flex items-center justify-center p-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-blue-400/20 to-purple-400/20 rounded-full blur-3xl animate-float animate-morph"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-br from-pink-400/20 to-rose-400/20 rounded-full blur-3xl animate-float animation-delay-300 animate-morph"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 w-60 h-60 bg-gradient-to-br from-indigo-400/10 to-cyan-400/10 rounded-full blur-2xl animate-float animation-delay-500 animate-morph"}),o.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-400/15 to-blue-400/15 rounded-full blur-xl animate-particle"}),o.jsx("div",{className:"absolute bottom-1/4 left-1/3 w-24 h-24 bg-gradient-to-br from-purple-400/15 to-pink-400/15 rounded-full blur-xl animate-particle animation-delay-200"})]}),o.jsx("div",{className:"relative z-10 w-full max-w-md animate-scale-in",children:o.jsxs(Ay,{className:"glass-morphism shadow-3xl hover-glow transition-all-smooth p-8",children:[o.jsx("div",{className:"text-center mb-8",children:o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-3xl flex items-center justify-center shadow-glow-lg transform rotate-3 hover:rotate-0 transition-transform-smooth magnetic-hover animate-pulse-glow",children:o.jsx("span",{className:"text-2xl text-white font-bold animate-bounce-in",children:"✨"})}),o.jsx("h1",{className:"text-4xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-2 text-shimmer",children:"StudyLog"}),o.jsx("p",{className:"text-slate-500 text-lg font-medium animate-fade-in-delay animation-delay-200",children:"学習の旅を始めよう"})]})}),o.jsxs("form",{onSubmit:l,className:"space-y-6 relative",children:[o.jsxs("div",{className:"relative",children:[o.jsx("label",{htmlFor:"memberId",className:"block text-sm font-semibold text-slate-700 mb-3",children:"🎫 会員番号"}),o.jsxs("div",{className:"relative",children:[o.jsx(h1,{id:"memberId",type:"text",value:e,onChange:c=>s(c.target.value),placeholder:"会員番号を入力してください",className:"w-full pl-4 pr-12 py-4 text-lg border-2 border-slate-200 rounded-2xl focus:border-purple-400 focus:ring-4 focus:ring-purple-100 transition-all duration-300 bg-white/50 backdrop-blur-sm",required:!0,disabled:r}),o.jsx("div",{className:"absolute right-4 top-1/2 transform -translate-y-1/2",children:r?o.jsx("div",{className:"w-5 h-5 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}):o.jsx("span",{className:"text-slate-400",children:"🎫"})})]})]}),n&&o.jsxs("div",{className:"bg-red-50/80 backdrop-blur-sm border border-red-200 text-red-700 px-4 py-3 rounded-2xl text-center font-medium animate-shake",children:[o.jsx("span",{className:"inline-block mr-2",children:"⚠️"}),n]}),o.jsx(Ey,{type:"submit",disabled:r||!e.trim(),className:`w-full h-14 text-lg font-bold bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 hover:from-blue-600 hover:via-purple-600 hover:to-pink-600 text-white rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none ${r?"cursor-wait":""}`,children:r?o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),o.jsx("span",{children:"ログイン中..."})]}):o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{children:"✨"}),o.jsx("span",{children:"ログイン"}),o.jsx("span",{children:"→"})]})})]}),o.jsx("div",{className:"mt-6 p-4 bg-slate-50/50 backdrop-blur-sm rounded-2xl border border-slate-200",children:o.jsx("p",{className:"text-center text-sm text-slate-600",children:"💡 こちらに会員番号を入力してログインしてください"})})]})}),o.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-center",children:o.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"🎓 東進育英舎　日立校"})})]})},Ty=t=>{let e=0;for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);e=(e<<5)-e+n,e=e&e}return e.toString()},g1=(t,e)=>{const s=`password_${t}_${e}`;return localStorage.getItem(s)!==null},p1=(t,e,s)=>{const n=`password_${t}_${e}`,a=Ty(s);localStorage.setItem(n,a)},b1=(t,e,s)=>{const n=`password_${t}_${e}`,a=localStorage.getItem(n);if(!a)return!1;const r=Ty(s);return a===r},y1=(t,e)=>{const s=`password_${t}_${e}`;localStorage.removeItem(s)};function v1({userId:t,roleType:e,onSuccess:s,onCancel:n}){const[a,r]=U.useState(""),[i,l]=U.useState(""),[c,u]=U.useState(!1),[d,f]=U.useState(""),h=async x=>{if(x.preventDefault(),!a.trim()){f("パスワードを入力してください");return}if(a.length<4){f("パスワードは4文字以上で設定してください");return}if(a!==i){f("パスワードが一致しません");return}try{u(!0),f(""),p1(t,e,a),s()}catch(w){console.error("パスワード設定エラー:",w),f("パスワードの設定に失敗しました")}finally{u(!1)}},m=x=>x==="parent"?"保護者":"指導者";return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"🔒 パスワード設定"}),o.jsxs("p",{className:"text-slate-600",children:[m(e),"モード用のパスワードを設定してください"]})]}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"パスワード"}),o.jsx("input",{type:"password",value:a,onChange:x=>r(x.target.value),className:"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",placeholder:"4文字以上で入力してください",minLength:4,required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"パスワード確認"}),o.jsx("input",{type:"password",value:i,onChange:x=>l(x.target.value),className:"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",placeholder:"同じパスワードを再入力してください",minLength:4,required:!0})]}),d&&o.jsx("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-xl text-sm",children:d}),o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:n,className:"flex-1 py-3 px-4 border-2 border-slate-200 text-slate-600 rounded-xl hover:border-slate-300 transition-all",children:"キャンセル"}),o.jsx("button",{type:"submit",disabled:c,className:"flex-1 py-3 px-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:c?"設定中...":"設定完了"})]})]}),o.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-xl",children:o.jsxs("p",{className:"text-sm text-blue-700",children:["💡 設定したパスワードは次回以降、",m(e),"モードにアクセスする際に必要になります。"]})})]})})}function _1({userId:t,roleType:e,onSuccess:s,onCancel:n}){const[a,r]=U.useState(""),[i,l]=U.useState(!1),[c,u]=U.useState(""),[d,f]=U.useState(!1),h=async w=>{if(w.preventDefault(),!a.trim()){u("パスワードを入力してください");return}try{l(!0),u(""),b1(t,e,a)?s():u("パスワードが正しくありません")}catch(N){console.error("パスワード認証エラー:",N),u("認証に失敗しました")}finally{l(!1)}},m=()=>{y1(t,e),n()},x=w=>w==="parent"?"保護者":"指導者";return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:o.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"🔐 パスワード入力"}),o.jsxs("p",{className:"text-slate-600",children:[x(e),"モードにアクセスするためのパスワードを入力してください"]})]}),o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"パスワード"}),o.jsx("input",{type:"password",value:a,onChange:w=>r(w.target.value),className:"w-full p-3 border-2 border-slate-200 rounded-xl focus:border-blue-400 focus:ring-4 focus:ring-blue-100",placeholder:"パスワードを入力してください",autoFocus:!0,required:!0})]}),c&&o.jsx("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-xl text-sm",children:c}),o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:n,className:"flex-1 py-3 px-4 border-2 border-slate-200 text-slate-600 rounded-xl hover:border-slate-300 transition-all",children:"キャンセル"}),o.jsx("button",{type:"submit",disabled:i,className:"flex-1 py-3 px-4 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:i?"認証中...":"ログイン"})]})]}),o.jsxs("div",{className:"mt-4 p-3 bg-amber-50 border border-amber-200 rounded-xl",children:[o.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"⚠️ パスワードを忘れた場合は、下のボタンでリセットできます。"}),d?o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-sm text-red-600 font-medium",children:"本当にパスワードをリセットしますか？新しいパスワードの設定が必要になります。"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:m,className:"px-3 py-1 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-all",children:"はい、リセット"}),o.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-3 py-1 bg-slate-200 text-slate-600 text-sm rounded-lg hover:bg-slate-300 transition-all",children:"キャンセル"})]})]}):o.jsx("button",{type:"button",onClick:()=>f(!0),className:"text-sm text-amber-600 hover:text-amber-800 underline font-medium",children:"パスワードをリセットする"})]})]})})}const Dm=[{role:"student",title:"生徒モード",description:"学習記録をつけて成長しよう",icon:"📚",gradient:"from-blue-500 via-cyan-500 to-teal-500",hoverGradient:"from-blue-600 via-cyan-600 to-teal-600",features:["学習記録の作成","進捗確認","振り返り機能"]},{role:"parent",title:"保護者モード",description:"お子さんの成長を見守り応援",icon:"👨‍👩‍👧‍👦",gradient:"from-pink-500 via-rose-500 to-red-500",hoverGradient:"from-pink-600 via-rose-600 to-red-600",features:["進捗モニタリング","応援メッセージ","フィードバック"]},{role:"teacher",title:"指導者モード",description:"生徒の学習をサポートし指導",icon:"👨‍🏫",gradient:"from-purple-500 via-violet-500 to-indigo-500",hoverGradient:"from-purple-600 via-violet-600 to-indigo-600",features:["学習状況把握","指導アドバイス","成長サポート"]}],x1=({user:t,onRoleSelect:e})=>{var g;const[s,n]=U.useState(null),[a,r]=U.useState(!1),[i,l]=U.useState(null),[c,u]=U.useState(!1),[d,f]=U.useState(!1),[h,m]=U.useState(null);U.useEffect(()=>{(async()=>{try{const{data:b,error:A}=await je.from("study_records").select("id").eq("student_id",t.id).limit(1);if(A){console.error("学習記録確認エラー:",A),l(!0);return}l(!b||b.length===0)}catch(b){console.error("初回ユーザー確認エラー:",b),l(!0)}})()},[t.id]);const x=async p=>{if(p==="student"){n(p),r(!0),await new Promise(A=>setTimeout(A,1e3)),e(p);return}const b=p;m(b),g1(t.id,b)?f(!0):u(!0)},w=async()=>{u(!1),h&&(n(h),r(!0),await new Promise(p=>setTimeout(p,1e3)),e(h))},N=async()=>{f(!1),h&&(n(h),r(!0),await new Promise(p=>setTimeout(p,1e3)),e(h))},y=()=>{u(!1),f(!1),m(null)};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 flex items-center justify-center p-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-gradient-to-br from-blue-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-96 h-96 bg-gradient-to-br from-pink-400/20 to-rose-400/20 rounded-full blur-3xl animate-pulse delay-1000"}),o.jsx("div",{className:"absolute top-1/4 left-1/4 w-72 h-72 bg-gradient-to-br from-indigo-400/10 to-cyan-400/10 rounded-full blur-2xl animate-pulse delay-500"})]}),a&&o.jsx("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-sm z-50 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-16 h-16 border-4 border-purple-200 border-t-purple-500 rounded-full animate-spin mx-auto mb-4"}),o.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["✨ ",(g=Dm.find(p=>p.role===s))==null?void 0:g.title,"へようこそ！"]})]})}),o.jsxs("div",{className:"relative z-10 w-full max-w-4xl",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-full flex items-center justify-center shadow-2xl",children:o.jsx("span",{className:"text-3xl text-white font-bold",children:t.name[0]})}),o.jsx("h1",{className:"text-4xl md:text-5xl font-black bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-3",children:i===null?"...":i?"はじめまして！":"おかえりなさい！"}),o.jsxs("p",{className:"text-2xl font-bold text-slate-700 mb-2",children:[t.name,"さん"]}),o.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/60 backdrop-blur-sm border border-slate-200 rounded-full shadow-lg",children:[o.jsx("span",{className:"text-sm font-medium text-slate-600",children:"ID:"}),o.jsx("span",{className:"text-sm font-bold text-slate-800",children:t.id})]})]}),o.jsx("p",{className:"text-xl text-slate-600 font-medium",children:i===null?"":i?"StudyLogへようこそ！どのモードで使用しますか？":"どのモードで使用しますか？"})]}),o.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:Dm.map((p,b)=>o.jsx("div",{className:`transform transition-all duration-500 ${b===0?"md:translate-y-0":b===1?"md:-translate-y-4":"md:translate-y-0"}`,style:{animationDelay:`${b*150}ms`},children:o.jsx(Ay,{className:"h-full backdrop-blur-xl bg-white/70 border-white/20 shadow-2xl hover:shadow-3xl transition-all duration-500 group hover:scale-105 cursor-pointer",onClick:()=>x(p.role),children:o.jsxs("div",{className:"p-6 text-center h-full flex flex-col",children:[o.jsx("div",{className:"mb-6",children:o.jsx("div",{className:`w-20 h-20 mx-auto bg-gradient-to-br ${p.gradient} rounded-3xl flex items-center justify-center shadow-xl group-hover:shadow-2xl transition-all duration-500 group-hover:scale-110`,children:o.jsx("span",{className:"text-3xl",children:p.icon})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-2xl font-black text-slate-800 mb-3",children:p.title}),o.jsx("p",{className:"text-slate-600 font-medium mb-6 leading-relaxed",children:p.description}),o.jsx("div",{className:"space-y-2 mb-6",children:p.features.map((A,O)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[o.jsx("div",{className:`w-2 h-2 bg-gradient-to-r ${p.gradient} rounded-full`}),o.jsx("span",{children:A})]},O))})]}),o.jsx(Ey,{onClick:()=>x(p.role),disabled:a,className:`w-full h-12 font-bold bg-gradient-to-r ${p.gradient} hover:bg-gradient-to-r hover:${p.hoverGradient} text-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform group-hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed`,children:o.jsxs("div",{className:"flex items-center justify-center gap-2",children:[o.jsx("span",{children:"✨"}),o.jsx("span",{children:"選択する"}),o.jsx("span",{children:"→"})]})})]})})},p.role))}),o.jsx("div",{className:"mt-12 text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-4 px-6 py-3 bg-blue-50/80 backdrop-blur-sm border border-blue-200 rounded-full",children:[o.jsx("span",{className:"text-blue-600 font-medium",children:"🚀 生徒さんはこちらがおすすめ！"}),o.jsxs("button",{onClick:()=>x("student"),disabled:a,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-xl transition-all duration-200 transform hover:scale-105 disabled:opacity-50",children:[t.name,"さんモード"]})]})})]}),o.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-center",children:o.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"🎓 あなたにぴったりのモードで学習しよう"})}),c&&h&&o.jsx(v1,{userId:t.id,roleType:h,onSuccess:w,onCancel:y}),d&&h&&o.jsx(_1,{userId:t.id,roleType:h,onSuccess:N,onCancel:y})]})};function w1(){const[t,e]=U.useState("dashboard"),{isAuthenticated:s,user:n,role:a,login:r,selectRole:i,logout:l}=ka();return s?a?o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[o.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-slate-200/50 sticky top-0 z-10",children:o.jsx("div",{className:"max-w-6xl mx-auto px-6 py-4",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{className:"flex justify-center gap-2 flex-wrap flex-1",children:[o.jsxs("div",{className:"flex items-center gap-4 mr-4",children:[o.jsxs("span",{className:"harmonious-text-sm font-medium",children:[n.name,"さん"]}),o.jsxs("div",{className:`harmonious-badge ${a==="student"?"harmonious-badge-student":a==="parent"?"harmonious-badge-parent":"harmonious-badge-teacher"}`,children:[a==="student"?"👧 生徒":a==="parent"?"👨‍👩‍👧‍👦 保護者":"👨‍🏫 指導者","モード"]})]}),a==="student"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>e("dashboard"),className:t==="dashboard"?"harmonious-button-primary":"harmonious-button-secondary",children:"📊 ダッシュボード"}),o.jsx("button",{onClick:()=>e("form"),className:t==="form"?"harmonious-button-primary":"harmonious-button-secondary",children:"📝 学習記録"}),o.jsx("button",{onClick:()=>e("history"),className:t==="history"?"harmonious-button-primary":"harmonious-button-secondary",children:"📚 学習履歴"}),o.jsx("button",{onClick:()=>e("reflection"),className:t==="reflection"?"harmonious-button-primary":"harmonious-button-secondary",children:"🤔 振り返り"})]}),(a==="parent"||a==="teacher")&&o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>e("dashboard"),className:t==="dashboard"?"harmonious-button-primary":"harmonious-button-secondary",children:"📊 ダッシュボード"}),o.jsx("button",{onClick:()=>e("feedback"),className:t==="feedback"?"harmonious-button-primary":"harmonious-button-secondary",children:"💌 フィードバック"}),o.jsx("button",{onClick:()=>e("history"),className:t==="history"?"harmonious-button-primary":"harmonious-button-secondary",children:"📚 学習履歴"}),o.jsx("button",{onClick:()=>e("reflection"),className:t==="reflection"?"harmonious-button-primary":"harmonious-button-secondary",children:"🤔 振り返り"}),a==="teacher"&&o.jsx("button",{onClick:()=>e("teacher-records"),className:t==="teacher-records"?"harmonious-button-primary":"harmonious-button-secondary",children:"📊 記録管理"})]})]}),o.jsx("button",{onClick:l,className:"harmonious-button-secondary border border-red-200 text-red-600 hover:bg-red-50",children:"🚪 ログアウト"})]})})}),t==="dashboard"&&o.jsx(QS,{}),t==="form"&&o.jsx(VS,{}),t==="feedback"&&o.jsx(l1,{userRole:a==="parent"?"parent":"teacher"}),t==="history"&&o.jsx(o1,{}),t==="reflection"&&o.jsx(c1,{userRole:a}),t==="teacher-records"&&a==="teacher"&&o.jsx(u1,{})]}):o.jsx(x1,{user:n,onRoleSelect:i}):o.jsx(m1,{onLogin:r})}Rx.createRoot(document.getElementById("root")).render(o.jsx(Ky.StrictMode,{children:o.jsx(w1,{})}));
